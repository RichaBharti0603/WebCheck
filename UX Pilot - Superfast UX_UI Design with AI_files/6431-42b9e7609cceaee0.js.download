"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6431],{66431:function(e,t,n){n(57437),n(2265),n(26171),n(17268),n(600),n(29528),n(24033)},47635:function(e,t,n){n.d(t,{V:function(){return redirectToCheckout}});function redirectToCheckout(e,t,n){t&&t.redirectToCheckout({sessionId:e}).then(function(e){e.error&&n(e.error.message)})}},29528:function(e,t,n){n.d(t,{B:function(){return useCancelSubscription}});var r=n(45610),s=n(9),a=n(50044),u=n(2265),c=n(26171),i=n(38597);function useCancelSubscription(){var e,t=(0,c.aC)().currentUser,n=(0,s._)((0,u.useState)(null),2),o=n[0],l=n[1],f=(0,s._)((0,u.useState)(!1),2),h=f[0],p=f[1];return{cancelSubscription:(e=(0,r._)(function(){var e,n;return(0,a.Jh)(this,function(r){switch(r.label){case 0:if(!t||!t.email)return l("User not authenticated"),[2];r.label=1;case 1:return r.trys.push([1,4,,5]),p(!0),[4,fetch("".concat(i.URLS.authFuncUrl,"/cancelSubscription"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t.email})})];case 2:return[4,r.sent().json()];case 3:return"success"!==(e=r.sent()).status&&l(e.message),p(!1),[2,e];case 4:return n=r.sent(),p(!1),l(n.message),[3,5];case 5:return p(!1),[2]}})}),function(){return e.apply(this,arguments)}),error:o,cancelLoading:h}}},600:function(e,t,n){n.d(t,{Z:function(){return useSubscribeToPlan}});var r=n(45610),s=n(9),a=n(50044),u=n(2265),c=n(96974),i=n(26171),o=n(47635);n(27106);var l=n(60453),f=n(38597);function useSubscribeToPlan(){var e,t=(0,c.useStripe)(),n=(0,s._)((0,u.useState)(null),2),h=n[0],p=n[1],b=(0,s._)((0,u.useState)(!1),2),d=b[0],S=b[1],m=(0,i.aC)().currentUser;return{subscribe:(e=(0,r._)(function(e){var n,r,s,u;return(0,a.Jh)(this,function(a){switch(a.label){case 0:if(!m||!m.email)return p("User not authenticated"),[2];return S(!0),n=window.tolt_referral||"",[4,fetch("https://api.ipify.org?format=json")];case 1:case 3:return[4,a.sent().json()];case 2:return r=a.sent().ip,s=navigator.userAgent,[4,fetch("".concat(f.URLS.streamUrl,"/subscription/subscribe-to-plan"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:m.email,planId:e,toltReferral:n||"",userIpAddress:r,userAgent:s})})];case 4:return"success"===(u=a.sent()).status?(0,o.V)(u.sessionId,t,p):"error"===u.status&&"User already has an active subscription."===u.message?p("You already have an active subscription."):p(u.message),S(!1),(0,l.hb)("userInfoData"),[2]}})}),function(t){return e.apply(this,arguments)}),error:h,isSubscriptionLoading:d}}}}]);