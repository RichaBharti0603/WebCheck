"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5878],{58066:function(t,s,a){a.d(s,{ZP:function(){return sW}});var l,c="undefined"!=typeof window?window:void 0,d="undefined"!=typeof globalThis?globalThis:c,h=Array.prototype,_=h.forEach,p=h.indexOf,g=null==d?void 0:d.navigator,v=null==d?void 0:d.document,f=null==d?void 0:d.location,w=null==d?void 0:d.fetch,S=null!=d&&d.XMLHttpRequest&&"withCredentials"in new d.XMLHttpRequest?d.XMLHttpRequest:void 0,k=null==d?void 0:d.AbortController,E=null==g?void 0:g.userAgent,x=null!=c?c:{},B={DEBUG:!1,LIB_VERSION:"1.224.0"},H="$copy_autocapture",U=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"];function m(t,s){return -1!==t.indexOf(s)}(e4=l||(l={})).GZipJS="gzip-js",e4.Base64="base64";var y=function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},b=function(t){return t.replace(/^\$/,"")},J=Array.isArray,es=Object.prototype,er=es.hasOwnProperty,en=es.toString,ea=J||function(t){return"[object Array]"===en.call(t)},I=t=>"function"==typeof t,P=t=>t===Object(t)&&!ea(t),C=t=>{if(P(t)){for(var s in t)if(er.call(t,s))return!1;return!0}return!1},F=t=>void 0===t,R=t=>"[object String]"==en.call(t),T=t=>R(t)&&0===t.trim().length,$=t=>null===t,O=t=>F(t)||$(t),M=t=>"[object Number]"==en.call(t),A=t=>"[object Boolean]"===en.call(t),L=t=>t instanceof FormData,D=t=>t instanceof Error,q=t=>m(U,t),N=t=>{var s={_log:function(s){if(c&&(B.DEBUG||x.POSTHOG_DEBUG)&&!F(c.console)&&c.console){for(var a=("__rrweb_original__"in c.console[s])?c.console[s].__rrweb_original__:c.console[s],l=arguments.length,d=Array(l>1?l-1:0),h=1;h<l;h++)d[h-1]=arguments[h];a(t,...d)}},info:function(){for(var t=arguments.length,a=Array(t),l=0;l<t;l++)a[l]=arguments[l];s._log("log",...a)},warn:function(){for(var t=arguments.length,a=Array(t),l=0;l<t;l++)a[l]=arguments[l];s._log("warn",...a)},error:function(){for(var t=arguments.length,a=Array(t),l=0;l<t;l++)a[l]=arguments[l];s._log("error",...a)},critical:function(){for(var s=arguments.length,a=Array(s),l=0;l<s;l++)a[l]=arguments[l];console.error(t,...a)},uninitializedWarning:t=>{s.error("You must initialize PostHog before calling ".concat(t))},createLogger:s=>N("".concat(t," ").concat(s))};return s},el=N("[PostHog.js]"),ec=el.createLogger,eu=ec("[ExternalScriptsLoader]"),z=(t,s,a)=>{if(t.config.disable_external_dependency_loading)return eu.warn("".concat(s," was requested but loading of external scripts is disabled.")),a("Loading of external scripts is disabled");var r=()=>{if(!v)return a("document not found");var l=v.createElement("script");if(l.type="text/javascript",l.crossOrigin="anonymous",l.src=s,l.onload=t=>a(void 0,t),l.onerror=t=>a(t),t.config.prepare_external_dependency_script&&(l=t.config.prepare_external_dependency_script(l)),!l)return a("prepare_external_dependency_script returned null");var c,d=v.querySelectorAll("body > script");d.length>0?null===(c=d[0].parentNode)||void 0===c||c.insertBefore(l,d[0]):v.body.appendChild(l)};null!=v&&v.body?r():null==v||v.addEventListener("DOMContentLoaded",r)};function j(t,s){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);s&&(l=l.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),a.push.apply(a,l)}return a}function W(t){for(var s=1;s<arguments.length;s++){var a=null!=arguments[s]?arguments[s]:{};s%2?j(Object(a),!0).forEach(function(s){V(t,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(a,s))})}return t}function V(t,s,a){return s in t?Object.defineProperty(t,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[s]=a,t}function G(t,s){if(null==t)return{};var a,l,c=function(t,s){if(null==t)return{};var a,l,c={},d=Object.keys(t);for(l=0;l<d.length;l++)a=d[l],s.indexOf(a)>=0||(c[a]=t[a]);return c}(t,s);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(t);for(l=0;l<d.length;l++)a=d[l],s.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(c[a]=t[a])}return c}x.__PosthogExtensions__=x.__PosthogExtensions__||{},x.__PosthogExtensions__.loadExternalDependency=(t,s,a)=>{var l="/static/".concat(s,".js")+"?v=".concat(t.version);if("remote-config"===s&&(l="/array/".concat(t.config.token,"/config.js")),"toolbar"===s){var c=3e5*Math.floor(Date.now()/3e5);l="".concat(l,"&t=").concat(c)}var d=t.requestRouter.endpointFor("assets",l);z(t,d,a)},x.__PosthogExtensions__.loadSiteApp=(t,s,a)=>{var l=t.requestRouter.endpointFor("api",s);z(t,l,a)};var ed={};function Y(t,s,a){if(ea(t)){if(_&&t.forEach===_)t.forEach(s,a);else if("length"in t&&t.length===+t.length){for(var l=0,c=t.length;l<c;l++)if(l in t&&s.call(a,t[l],l)===ed)return}}}function K(t,s,a){if(!O(t)){if(ea(t))return Y(t,s,a);if(L(t)){for(var l of t.entries())if(s.call(a,l[1],l[0])===ed)return}else for(var c in t)if(er.call(t,c)&&s.call(a,t[c],c)===ed)return}}var X=function(t){for(var s=arguments.length,a=Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];return Y(a,function(s){for(var a in s)void 0!==s[a]&&(t[a]=s[a])}),t},Q=function(t){for(var s=arguments.length,a=Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];return Y(a,function(s){Y(s,function(s){t.push(s)})}),t};function Z(t){for(var s=Object.keys(t),a=s.length,l=Array(a);a--;)l[a]=[s[a],t[s[a]]];return l}var ee=function(t){try{return t()}catch(t){return}},te=function(t){return function(){try{for(var s=arguments.length,a=Array(s),l=0;l<s;l++)a[l]=arguments[l];return t.apply(this,a)}catch(t){el.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),el.critical(t)}}},ie=function(t){var s={};return K(t,function(t,a){R(t)&&t.length>0&&(s[a]=t)}),s},eh=["herokuapp.com","vercel.app","netlify.app"];function oe(t,s){for(var a=0;a<t.length;a++)if(s(t[a]))return t[a]}function ae(t,s,a,l){var{capture:c=!1,passive:d=!0}=null!=l?l:{};null==t||t.addEventListener(s,a,{capture:c,passive:d})}var e_="$people_distinct_id",ep="__alias",eg="__timers",ev="$autocapture_disabled_server_side",ef="$heatmaps_enabled_server_side",em="$exception_capture_enabled_server_side",ey="$web_vitals_enabled_server_side",eb="$dead_clicks_enabled_server_side",ew="$web_vitals_allowed_metrics",eS="$session_recording_enabled_server_side",ek="$console_log_recording_enabled_server_side",eE="$session_recording_network_payload_capture",eF="$session_recording_canvas_recording",ex="$replay_sample_rate",eI="$replay_minimum_duration",eP="$replay_script_config",eC="$sesid",eR="$session_is_sampled",eT="$session_recording_url_trigger_activated_session",e$="$session_recording_event_trigger_activated_session",eO="$enabled_feature_flags",eM="$early_access_features",eA="$stored_person_properties",eL="$stored_group_properties",eD="$surveys",eq="$surveys_activated",eW="$flag_call_reported",eN="$user_state",eV="$client_session_props",eB="$capture_rate_limit",eH="$initial_campaign_params",ez="$initial_referrer_info",eU="$initial_person_info",ej="$epp",eG="__POSTHOG_TOOLBAR__",eK="$posthog_cookieless",eY=[e_,ep,"__cmpns",eg,eS,ef,eC,eO,eN,eM,eL,eA,eD,eW,eV,eB,eH,ez,ej];function We(t){var s;return t instanceof Element&&(t.id===eG||!(null===(s=t.closest)||void 0===s||!s.call(t,".toolbar-global-fade-container")))}function Ve(t){return!!t&&1===t.nodeType}function Ge(t,s){return!!t&&!!t.tagName&&t.tagName.toLowerCase()===s.toLowerCase()}function Je(t){return!!t&&3===t.nodeType}function Ye(t){return!!t&&11===t.nodeType}function Ke(t){return t?y(t).split(/\s+/):[]}function Xe(t){var s=null==c?void 0:c.location.href;return!!(s&&t&&t.some(t=>s.match(t)))}function Qe(t){var s="";switch(typeof t.className){case"string":s=t.className;break;case"object":s=(t.className&&"baseVal"in t.className?t.className.baseVal:null)||t.getAttribute("class")||"";break;default:s=""}return Ke(s)}function Ze(t){return O(t)?null:y(t).split(/(\s+)/).filter(t=>_t(t)).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function et(t){var s="";return nt(t)&&!ot(t)&&t.childNodes&&t.childNodes.length&&K(t.childNodes,function(t){var a;Je(t)&&t.textContent&&(s+=null!==(a=Ze(t.textContent))&&void 0!==a?a:"")}),y(s)}function tt(t){var s;return F(t.target)?t.srcElement||null:null!==(s=t.target)&&void 0!==s&&s.shadowRoot?t.composedPath()[0]||null:t.target||null}var eJ=["a","button","form","input","select","textarea","label"];function rt(t){var s=t.parentNode;return!(!s||!Ve(s))&&s}function nt(t){for(var s=t;s.parentNode&&!Ge(s,"body");s=s.parentNode){var a=Qe(s);if(m(a,"ph-sensitive")||m(a,"ph-no-capture"))return!1}if(m(Qe(t),"ph-include"))return!0;var l=t.type||"";if(R(l))switch(l.toLowerCase()){case"hidden":case"password":return!1}var c=t.name||t.id||"";return!(R(c)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(c.replace(/[^a-zA-Z0-9]/g,"")))}function ot(t){return!!(Ge(t,"input")&&!["button","checkbox","submit","reset"].includes(t.type)||Ge(t,"select")||Ge(t,"textarea")||"true"===t.getAttribute("contenteditable"))}var eX="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",eQ=new RegExp("^(?:".concat(eX,")$")),eZ=new RegExp(eX),e0="\\d{3}-?\\d{2}-?\\d{4}",e1=new RegExp("^(".concat(e0,")$")),e2=new RegExp("(".concat(e0,")"));function _t(t){var s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!(O(t)||R(t)&&(t=y(t),(s?eQ:eZ).test((t||"").replace(/[- ]/g,""))||(s?e1:e2).test(t)))}function pt(t){var s=et(t);return _t(s="".concat(s," ").concat(function gt(t){var s="";return t&&t.childNodes&&t.childNodes.length&&K(t.childNodes,function(t){var a;if(t&&"span"===(null===(a=t.tagName)||void 0===a?void 0:a.toLowerCase()))try{var l=et(t);s="".concat(s," ").concat(l).trim(),t.childNodes&&t.childNodes.length&&(s="".concat(s," ").concat(gt(t)).trim())}catch(t){el.error("[AutoCapture]",t)}}),s}(t)).trim())?s:""}function ft(t){return t.replace(/"|\\"/g,'\\"')}let yt=class yt{constructor(){this.clicks=[]}isRageClick(t,s,a){var l=this.clicks[this.clicks.length-1];if(l&&Math.abs(t-l.x)+Math.abs(s-l.y)<30&&a-l.timestamp<1e3){if(this.clicks.push({x:t,y:s,timestamp:a}),3===this.clicks.length)return!0}else this.clicks=[{x:t,y:s,timestamp:a}];return!1}};var e3=["localhost","127.0.0.1"],wt=t=>{var s=null==v?void 0:v.createElement("a");return F(s)?null:(s.href=t,s)},St=function(t){var s,a,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"&",c=[];return K(t,function(t,l){F(t)||F(l)||"undefined"===l||(s=encodeURIComponent(t instanceof File?t.name:t.toString()),a=encodeURIComponent(l),c[c.length]=a+"="+s)}),c.join(l)},kt=function(t,s){for(var a,l=((t.split("#")[0]||"").split("?")[1]||"").split("&"),c=0;c<l.length;c++){var d=l[c].split("=");if(d[0]===s){a=d;break}}if(!ea(a)||a.length<2)return"";var h=a[1];try{h=decodeURIComponent(h)}catch(t){el.error("Skipping decoding for malformed query param: "+h)}return h.replace(/\+/g," ")},Et=function(t,s,a){if(!t||!s||!s.length)return t;for(var l=t.split("#"),c=l[0]||"",d=l[1],h=c.split("?"),_=h[1],p=h[0],g=(_||"").split("&"),v=[],f=0;f<g.length;f++){var w=g[f].split("=");ea(w)&&(s.includes(w[0])?v.push(w[0]+"="+a):v.push(g[f]))}var S=p;return null!=_&&(S+="?"+v.join("&")),null!=d&&(S+="#"+d),S},xt=function(t,s){var a=t.match(RegExp(s+"=([^&]*)"));return a?a[1]:null},e5=ec("[AutoCapture]");function Pt(t,s){return s.length>t?s.slice(0,t)+"...":s}let Tt=class Tt{constructor(t){V(this,"_initialized",!1),V(this,"_isDisabledServerSide",null),V(this,"rageclicks",new yt),V(this,"_elementsChainAsString",!1),this.instance=t,this._elementSelectors=null}get config(){var t,s,a=P(this.instance.config.autocapture)?this.instance.config.autocapture:{};return a.url_allowlist=null===(t=a.url_allowlist)||void 0===t?void 0:t.map(t=>new RegExp(t)),a.url_ignorelist=null===(s=a.url_ignorelist)||void 0===s?void 0:s.map(t=>new RegExp(t)),a}_addDomEventHandlers(){if(this.isBrowserSupported()){if(c&&v){var e=t=>{t=t||(null==c?void 0:c.event);try{this._captureEvent(t)}catch(t){e5.error("Failed to capture event",t)}};if(ae(v,"submit",e,{capture:!0}),ae(v,"change",e,{capture:!0}),ae(v,"click",e,{capture:!0}),this.config.capture_copied_text){var i=t=>{t=t||(null==c?void 0:c.event),this._captureEvent(t,H)};ae(v,"copy",i,{capture:!0}),ae(v,"cut",i,{capture:!0})}}}else e5.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this._initialized&&(this._addDomEventHandlers(),this._initialized=!0)}onRemoteConfig(t){t.elementsChainAsString&&(this._elementsChainAsString=t.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[ev]:!!t.autocapture_opt_out}),this._isDisabledServerSide=!!t.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(t){this._elementSelectors=t}getElementSelectors(t){var s,a=[];return null===(s=this._elementSelectors)||void 0===s||s.forEach(s=>{var l=null==v?void 0:v.querySelectorAll(s);null==l||l.forEach(l=>{t===l&&a.push(s)})}),a}get isEnabled(){var t,s,a=null===(t=this.instance.persistence)||void 0===t?void 0:t.props[ev];if($(this._isDisabledServerSide)&&!A(a)&&!this.instance.config.advanced_disable_decide)return!1;var l=null!==(s=this._isDisabledServerSide)&&void 0!==s?s:!!a;return!!this.instance.config.autocapture&&!l}_captureEvent(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$autocapture";if(this.isEnabled){var a,l=tt(t);Je(l)&&(l=l.parentNode||null),"$autocapture"===s&&"click"===t.type&&t instanceof MouseEvent&&this.instance.config.rageclick&&null!==(a=this.rageclicks)&&void 0!==a&&a.isRageClick(t.clientX,t.clientY,(new Date).getTime())&&this._captureEvent(t,"$rageclick");var d=s===H;if(l&&function(t,s){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,d=arguments.length>4?arguments[4]:void 0;if(!c||!t||Ge(t,"html")||!Ve(t)||null!=a&&a.url_allowlist&&!Xe(a.url_allowlist)||null!=a&&a.url_ignorelist&&Xe(a.url_ignorelist))return!1;if(null!=a&&a.dom_event_allowlist){var h=a.dom_event_allowlist;if(h&&!h.some(t=>s.type===t))return!1}for(var _=!1,p=[t],g=!0,v=t;v.parentNode&&!Ge(v,"body");)if(Ye(v.parentNode))p.push(v.parentNode.host),v=v.parentNode.host;else{if(!(g=rt(v)))break;if(l||eJ.indexOf(g.tagName.toLowerCase())>-1)_=!0;else{var f=c.getComputedStyle(g);f&&"pointer"===f.getPropertyValue("cursor")&&(_=!0)}p.push(g),v=g}if(!function(t,s){var a=null==s?void 0:s.element_allowlist;if(F(a))return!0;var r=function(t){if(a.some(s=>t.tagName.toLowerCase()===s))return{v:!0}};for(var l of t){var c=r(l);if("object"==typeof c)return c.v}return!1}(p,a)||!function(t,s){var a=null==s?void 0:s.css_selector_allowlist;if(F(a))return!0;var r=function(t){if(a.some(s=>t.matches(s)))return{v:!0}};for(var l of t){var c=r(l);if("object"==typeof c)return c.v}return!1}(p,a))return!1;var w=c.getComputedStyle(t);if(w&&"pointer"===w.getPropertyValue("cursor")&&"click"===s.type)return!0;var S=t.tagName.toLowerCase();switch(S){case"html":return!1;case"form":return(d||["submit"]).indexOf(s.type)>=0;case"input":case"select":case"textarea":return(d||["change","click"]).indexOf(s.type)>=0;default:return _?(d||["click"]).indexOf(s.type)>=0:(d||["click"]).indexOf(s.type)>=0&&(eJ.indexOf(S)>-1||"true"===t.getAttribute("contenteditable"))}}(l,t,this.config,d,d?["copy","cut"]:void 0)){var{props:h,explicitNoCapture:_}=function(t,s){for(var a,l,{e:d,maskAllElementAttributes:h,maskAllText:_,elementAttributeIgnoreList:p,elementsChainAsString:g}=s,v=[t],f=t;f.parentNode&&!Ge(f,"body");)Ye(f.parentNode)?(v.push(f.parentNode.host),f=f.parentNode.host):(v.push(f.parentNode),f=f.parentNode);var w,S=[],k={},E=!1,x=!1;if(K(v,t=>{var s=nt(t);"a"===t.tagName.toLowerCase()&&(E=t.getAttribute("href"),E=s&&E&&_t(E)&&E),m(Qe(t),"ph-no-capture")&&(x=!0),S.push(function(t,s,a,l){var c=t.tagName.toLowerCase(),d={tag_name:c};eJ.indexOf(c)>-1&&!a&&("a"===c.toLowerCase()||"button"===c.toLowerCase()?d.$el_text=Pt(1024,pt(t)):d.$el_text=Pt(1024,et(t)));var h=Qe(t);h.length>0&&(d.classes=h.filter(function(t){return""!==t})),K(t.attributes,function(a){var c;if((!ot(t)||-1!==["name","id","class","aria-label"].indexOf(a.name))&&(null==l||!l.includes(a.name))&&!s&&_t(a.value)&&(!R(c=a.name)||"_ngcontent"!==c.substring(0,10)&&"_nghost"!==c.substring(0,7))){var h=a.value;"class"===a.name&&(h=Ke(h).join(" ")),d["attr__"+a.name]=Pt(1024,h)}});for(var _=1,p=1,g=t;g=function(t){if(t.previousElementSibling)return t.previousElementSibling;var s=t;do s=s.previousSibling;while(s&&!Ve(s));return s}(g);)_++,g.tagName===t.tagName&&p++;return d.nth_child=_,d.nth_of_type=p,d}(t,h,_,p)),X(k,function(t){if(!nt(t))return{};var s={};return K(t.attributes,function(t){if(t.name&&0===t.name.indexOf("data-ph-capture-attribute")){var a=t.name.replace("data-ph-capture-attribute-",""),l=t.value;a&&l&&_t(l)&&(s[a]=l)}}),s}(t))}),x)return{props:{},explicitNoCapture:x};if(_||("a"===t.tagName.toLowerCase()||"button"===t.tagName.toLowerCase()?S[0].$el_text=pt(t):S[0].$el_text=et(t)),E){S[0].attr__href=E;var B,H,U=null===(B=wt(E))||void 0===B?void 0:B.host,J=null==c||null===(H=c.location)||void 0===H?void 0:H.host;U&&J&&U!==J&&(w=E)}return{props:X({$event_type:d.type,$ce_version:1},g?{}:{$elements:S},{$elements_chain:S.map(t=>{var s,a,l,c={text:null===(a=t.$el_text)||void 0===a?void 0:a.slice(0,400),tag_name:t.tag_name,href:null===(l=t.attr__href)||void 0===l?void 0:l.slice(0,2048),attr_class:(s=t.attr__class)?ea(s)?s:Ke(s):void 0,attr_id:t.attr__id,nth_child:t.nth_child,nth_of_type:t.nth_of_type,attributes:{}};return Z(t).filter(t=>{var[s]=t;return 0===s.indexOf("attr__")}).forEach(t=>{var[s,a]=t;return c.attributes[s]=a}),c}).map(t=>{var s,a,l="";if(t.tag_name&&(l+=t.tag_name),t.attr_class)for(var c of(t.attr_class.sort(),t.attr_class))l+=".".concat(c.replace(/"/g,""));var d=W(W(W(W({},t.text?{text:t.text}:{}),{},{"nth-child":null!==(s=t.nth_child)&&void 0!==s?s:0,"nth-of-type":null!==(a=t.nth_of_type)&&void 0!==a?a:0},t.href?{href:t.href}:{}),t.attr_id?{attr_id:t.attr_id}:{}),t.attributes),h={};return Z(d).sort((t,s)=>{var[a]=t,[l]=s;return a.localeCompare(l)}).forEach(t=>{var[s,a]=t;return h[ft(s.toString())]=ft(a.toString())}),l+=":"+Z(d).map(t=>{var[s,a]=t;return"".concat(s,'="').concat(a,'"')}).join("")}).join(";")},null!==(a=S[0])&&void 0!==a&&a.$el_text?{$el_text:null===(l=S[0])||void 0===l?void 0:l.$el_text}:{},w&&"click"===d.type?{$external_click_url:w}:{},k)}}(l,{e:t,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.config.element_attribute_ignorelist,elementsChainAsString:this._elementsChainAsString});if(_)return!1;var p=this.getElementSelectors(l);if(p&&p.length>0&&(h.$element_selectors=p),s===H){var g,v=Ze(null==c||null===(g=c.getSelection())||void 0===g?void 0:g.toString()),f=t.type||"clipboard";if(!v)return!1;h.$selected_content=v,h.$copy_type=f}return this.instance.capture(s,h),!0}}}isBrowserSupported(){return I(null==v?void 0:v.querySelectorAll)}};Math.trunc||(Math.trunc=function(t){return t<0?Math.ceil(t):Math.floor(t)}),Number.isInteger||(Number.isInteger=function(t){return M(t)&&isFinite(t)&&Math.floor(t)===t});var e6="0123456789abcdef";let Ot=class Ot{constructor(t){if(this.bytes=t,16!==t.length)throw TypeError("not 128-bit length")}static fromFieldsV7(t,s,a,l){if(!Number.isInteger(t)||!Number.isInteger(s)||!Number.isInteger(a)||!Number.isInteger(l)||t<0||s<0||a<0||l<0||t>0xffffffffffff||s>4095||a>1073741823||l>4294967295)throw RangeError("invalid field value");var c=new Uint8Array(16);return c[0]=t/1099511627776,c[1]=t/4294967296,c[2]=t/16777216,c[3]=t/65536,c[4]=t/256,c[5]=t,c[6]=112|s>>>8,c[7]=s,c[8]=128|a>>>24,c[9]=a>>>16,c[10]=a>>>8,c[11]=a,c[12]=l>>>24,c[13]=l>>>16,c[14]=l>>>8,c[15]=l,new Ot(c)}toString(){for(var t="",s=0;s<this.bytes.length;s++)t=t+e6.charAt(this.bytes[s]>>>4)+e6.charAt(15&this.bytes[s]),3!==s&&5!==s&&7!==s&&9!==s||(t+="-");if(36!==t.length)throw Error("Invalid UUIDv7 was generated");return t}clone(){return new Ot(this.bytes.slice(0))}equals(t){return 0===this.compareTo(t)}compareTo(t){for(var s=0;s<16;s++){var a=this.bytes[s]-t.bytes[s];if(0!==a)return Math.sign(a)}return 0}};let Mt=class Mt{constructor(){V(this,"timestamp",0),V(this,"counter",0),V(this,"random",new Dt)}generate(){var t=this.generateOrAbort();if(F(t)){this.timestamp=0;var s=this.generateOrAbort();if(F(s))throw Error("Could not generate UUID after timestamp reset");return s}return t}generateOrAbort(){var t=Date.now();if(t>this.timestamp)this.timestamp=t,this.resetCounter();else{if(!(t+1e4>this.timestamp))return;this.counter++,this.counter>4398046511103&&(this.timestamp++,this.resetCounter())}return Ot.fromFieldsV7(this.timestamp,Math.trunc(this.counter/1073741824),1073741823&this.counter,this.random.nextUint32())}resetCounter(){this.counter=1024*this.random.nextUint32()+(1023&this.random.nextUint32())}};var e4,e8,Lt=t=>{if("undefined"!=typeof UUIDV7_DENY_WEAK_RNG&&UUIDV7_DENY_WEAK_RNG)throw Error("no cryptographically strong RNG available");for(var s=0;s<t.length;s++)t[s]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return t};c&&!F(c.crypto)&&crypto.getRandomValues&&(Lt=t=>crypto.getRandomValues(t));let Dt=class Dt{constructor(){V(this,"buffer",new Uint32Array(8)),V(this,"cursor",1/0)}nextUint32(){return this.cursor>=this.buffer.length&&(Lt(this.buffer),this.cursor=0),this.buffer[this.cursor++]}};var e7,qt=()=>Nt().toString(),Nt=()=>(e8||(e8=new Mt)).generate(),e9="",ti=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i,ts={is_supported:()=>!!v,error:function(t){el.error("cookieStore error: "+t)},get:function(t){if(v){try{for(var s=t+"=",a=v.cookie.split(";").filter(t=>t.length),l=0;l<a.length;l++){for(var c=a[l];" "==c.charAt(0);)c=c.substring(1,c.length);if(0===c.indexOf(s))return decodeURIComponent(c.substring(s.length,c.length))}}catch(t){}return null}},parse:function(t){var s;try{s=JSON.parse(ts.get(t))||{}}catch(t){}return s},set:function(t,s,a,l,c){if(v)try{var d="",h="",_=function(t,s){if(s){var a=function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v;if(e9)return e9;if(!s||["localhost","127.0.0.1"].includes(t))return"";for(var a=t.split("."),l=Math.min(a.length,8),c="dmn_chk_"+qt(),d=RegExp("(^|;)\\s*"+c+"=1");!e9&&l--;){var h=a.slice(l).join("."),_=c+"=1;domain=."+h;s.cookie=_,d.test(s.cookie)&&(s.cookie=_+";expires=Thu, 01 Jan 1970 00:00:00 GMT",e9=h)}return e9}(t);if(!a){var l,c=(l=t.match(ti))?l[0]:"";c!==a&&el.info("Warning: cookie subdomain discovery mismatch",c,a),a=c}return a?"; domain=."+a:""}return""}(v.location.hostname,l);if(a){var p=new Date;p.setTime(p.getTime()+24*a*36e5),d="; expires="+p.toUTCString()}c&&(h="; secure");var g=t+"="+encodeURIComponent(JSON.stringify(s))+d+"; SameSite=Lax; path=/"+_+h;return g.length>3686.4&&el.warn("cookieStore warning: large cookie, len="+g.length),v.cookie=g,g}catch(t){return}},remove:function(t,s){try{ts.set(t,"",-1,s)}catch(t){return}}},tn=null,ta={is_supported:function(){if(!$(tn))return tn;var t=!0;if(F(c))t=!1;else try{var s="__mplssupport__";ta.set(s,"xyz"),'"xyz"'!==ta.get(s)&&(t=!1),ta.remove(s)}catch(s){t=!1}return t||el.error("localStorage unsupported; falling back to cookie store"),tn=t,t},error:function(t){el.error("localStorage error: "+t)},get:function(t){try{return null==c?void 0:c.localStorage.getItem(t)}catch(t){ta.error(t)}return null},parse:function(t){try{return JSON.parse(ta.get(t))||{}}catch(t){}return null},set:function(t,s){try{null==c||c.localStorage.setItem(t,JSON.stringify(s))}catch(t){ta.error(t)}},remove:function(t){try{null==c||c.localStorage.removeItem(t)}catch(t){ta.error(t)}}},tl=["distinct_id",eC,eR,ej,eU],tc=W(W({},ta),{},{parse:function(t){try{var s={};try{s=ts.parse(t)||{}}catch(t){}var a=X(s,JSON.parse(ta.get(t)||"{}"));return ta.set(t,a),a}catch(t){}return null},set:function(t,s,a,l,c,d){try{ta.set(t,s,void 0,void 0,d);var h={};tl.forEach(t=>{s[t]&&(h[t]=s[t])}),Object.keys(h).length&&ts.set(t,h,a,l,c,d)}catch(t){ta.error(t)}},remove:function(t,s){try{null==c||c.localStorage.removeItem(t),ts.remove(t,s)}catch(t){ta.error(t)}}}),tu={},td={is_supported:function(){return!0},error:function(t){el.error("memoryStorage error: "+t)},get:function(t){return tu[t]||null},parse:function(t){return tu[t]||null},set:function(t,s){tu[t]=s},remove:function(t){delete tu[t]}},th=null,t_={is_supported:function(){if(!$(th))return th;if(th=!0,F(c))th=!1;else try{var t="__support__";t_.set(t,"xyz"),'"xyz"'!==t_.get(t)&&(th=!1),t_.remove(t)}catch(t){th=!1}return th},error:function(t){el.error("sessionStorage error: ",t)},get:function(t){try{return null==c?void 0:c.sessionStorage.getItem(t)}catch(t){t_.error(t)}return null},parse:function(t){try{return JSON.parse(t_.get(t))||null}catch(t){}return null},set:function(t,s){try{null==c||c.sessionStorage.setItem(t,JSON.stringify(s))}catch(t){t_.error(t)}},remove:function(t){try{null==c||c.sessionStorage.removeItem(t)}catch(t){t_.error(t)}}};(tK=e7||(e7={}))[tK.PENDING=-1]="PENDING",tK[tK.DENIED=0]="DENIED",tK[tK.GRANTED=1]="GRANTED";let ei=class ei{constructor(t){this.instance=t}get config(){return this.instance.config}get consent(){return this.getDnt()?e7.DENIED:this.storedConsent}isOptedOut(){return this.consent===e7.DENIED||this.consent===e7.PENDING&&this.config.opt_out_capturing_by_default}isOptedIn(){return!this.isOptedOut()}optInOut(t){this.storage.set(this.storageKey,t?1:0,this.config.cookie_expiration,this.config.cross_subdomain_cookie,this.config.secure_cookie)}reset(){this.storage.remove(this.storageKey,this.config.cross_subdomain_cookie)}get storageKey(){var{token:t,opt_out_capturing_cookie_prefix:s}=this.instance.config;return(s||"__ph_opt_in_out_")+t}get storedConsent(){var t=this.storage.get(this.storageKey);return"1"===t?e7.GRANTED:"0"===t?e7.DENIED:e7.PENDING}get storage(){if(!this._storage){var t=this.config.opt_out_capturing_persistence_type;this._storage="localStorage"===t?ta:ts;var s="localStorage"===t?ts:ta;s.get(this.storageKey)&&(this._storage.get(this.storageKey)||this.optInOut("1"===s.get(this.storageKey)),s.remove(this.storageKey,this.config.cross_subdomain_cookie))}return this._storage}getDnt(){return!!this.config.respect_dnt&&!!oe([null==g?void 0:g.doNotTrack,null==g?void 0:g.msDoNotTrack,x.doNotTrack],t=>m([!0,1,"1","yes"],t))}};var tp=ec("[Dead Clicks]"),ii=()=>!0,ri=t=>{var s,a=!(null===(s=t.instance.persistence)||void 0===s||!s.get_property(eb)),l=t.instance.config.capture_dead_clicks;return A(l)?l:a};let si=class si{get lazyLoadedDeadClicksAutocapture(){return this._lazyLoadedDeadClicksAutocapture}constructor(t,s,a){this.instance=t,this.isEnabled=s,this.onCapture=a,this.startIfEnabled()}onRemoteConfig(t){this.instance.persistence&&this.instance.persistence.register({[eb]:null==t?void 0:t.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.loadScript(()=>{this.start()})}loadScript(t){var s,a,l;null!==(s=x.__PosthogExtensions__)&&void 0!==s&&s.initDeadClicksAutocapture&&t(),null===(a=x.__PosthogExtensions__)||void 0===a||null===(l=a.loadExternalDependency)||void 0===l||l.call(a,this.instance,"dead-clicks-autocapture",s=>{s?tp.error("failed to load script",s):t()})}start(){var t;if(v){if(!this._lazyLoadedDeadClicksAutocapture&&null!==(t=x.__PosthogExtensions__)&&void 0!==t&&t.initDeadClicksAutocapture){var s=P(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};s.__onCapture=this.onCapture,this._lazyLoadedDeadClicksAutocapture=x.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,s),this._lazyLoadedDeadClicksAutocapture.start(v),tp.info("starting...")}}else tp.error("`document` not found. Cannot start.")}stop(){this._lazyLoadedDeadClicksAutocapture&&(this._lazyLoadedDeadClicksAutocapture.stop(),this._lazyLoadedDeadClicksAutocapture=void 0,tp.info("stopping..."))}};var tg=ec("[ExceptionAutocapture]");let oi=class oi{constructor(t){var s;V(this,"startCapturing",()=>{var t,s,a,l;if(c&&this.isEnabled&&!this.hasHandlers){var d=null===(t=x.__PosthogExtensions__)||void 0===t||null===(s=t.errorWrappingFunctions)||void 0===s?void 0:s.wrapOnError,h=null===(a=x.__PosthogExtensions__)||void 0===a||null===(l=a.errorWrappingFunctions)||void 0===l?void 0:l.wrapUnhandledRejection;if(d&&h)try{this.unwrapOnError=d(this.captureException.bind(this)),this.unwrapUnhandledRejection=h(this.captureException.bind(this))}catch(t){tg.error("failed to start",t),this.stopCapturing()}else tg.error("failed to load error wrapping functions - cannot start")}}),this.instance=t,this.remoteEnabled=!(null===(s=this.instance.persistence)||void 0===s||!s.props[em]),this.startIfEnabled()}get isEnabled(){var t;return A(this.instance.config.capture_exceptions)?this.instance.config.capture_exceptions:null!==(t=this.remoteEnabled)&&void 0!==t&&t}get hasHandlers(){return!F(this.unwrapOnError)}startIfEnabled(){this.isEnabled&&!this.hasHandlers&&(tg.info("enabled, starting..."),this.loadScript(this.startCapturing))}loadScript(t){var s,a;this.hasHandlers&&t(),null===(s=x.__PosthogExtensions__)||void 0===s||null===(a=s.loadExternalDependency)||void 0===a||a.call(s,this.instance,"exception-autocapture",s=>{if(s)return tg.error("failed to load script",s);t()})}stopCapturing(){var t,s;null===(t=this.unwrapOnError)||void 0===t||t.call(this),this.unwrapOnError=void 0,null===(s=this.unwrapUnhandledRejection)||void 0===s||s.call(this),this.unwrapUnhandledRejection=void 0}onRemoteConfig(t){var s=t.autocaptureExceptions;this.remoteEnabled=!!s,this.instance.persistence&&this.instance.persistence.register({[em]:this.remoteEnabled}),this.startIfEnabled()}captureException(t){var s=this.instance.requestRouter.endpointFor("ui");t.$exception_personURL="".concat(s,"/project/").concat(this.instance.config.token,"/person/").concat(this.instance.get_distinct_id()),this.instance.exceptions.sendExceptionEvent(t)}};function ai(t){var s,a;return(null===(s=JSON.stringify(t,(a=[],function(t,s){if(P(s)){for(;a.length>0&&a[a.length-1]!==this;)a.pop();return a.includes(s)?"[Circular]":(a.push(s),s)}return s})))||void 0===s?void 0:s.length)||0}var tv=((tY=tv||{})[tY.DomContentLoaded=0]="DomContentLoaded",tY[tY.Load=1]="Load",tY[tY.FullSnapshot=2]="FullSnapshot",tY[tY.IncrementalSnapshot=3]="IncrementalSnapshot",tY[tY.Meta=4]="Meta",tY[tY.Custom=5]="Custom",tY[tY.Plugin=6]="Plugin",tY),tf=((tJ=tf||{})[tJ.Mutation=0]="Mutation",tJ[tJ.MouseMove=1]="MouseMove",tJ[tJ.MouseInteraction=2]="MouseInteraction",tJ[tJ.Scroll=3]="Scroll",tJ[tJ.ViewportResize=4]="ViewportResize",tJ[tJ.Input=5]="Input",tJ[tJ.TouchMove=6]="TouchMove",tJ[tJ.MediaInteraction=7]="MediaInteraction",tJ[tJ.StyleSheetRule=8]="StyleSheetRule",tJ[tJ.CanvasMutation=9]="CanvasMutation",tJ[tJ.Font=10]="Font",tJ[tJ.Log=11]="Log",tJ[tJ.Drag=12]="Drag",tJ[tJ.StyleDeclaration=13]="StyleDeclaration",tJ[tJ.Selection=14]="Selection",tJ[tJ.AdoptedStyleSheet=15]="AdoptedStyleSheet",tJ[tJ.CustomElement=16]="CustomElement",tJ),tm="[SessionRecording]",ty="redacted",tb={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:t=>t,recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6,payloadHostDenyList:[".lr-ingest.io",".ingest.sentry.io",".clarity.ms","analytics.google.com"]},tw=["authorization","x-forwarded-for","authorization","cookie","set-cookie","x-api-key","x-real-ip","remote-addr","forwarded","proxy-authorization","x-csrf-token","x-csrftoken","x-xsrf-token"],tS=["password","secret","passwd","api_key","apikey","auth","credentials","mysql_pwd","privatekey","private_key","token"],tk=["/s/","/e/","/i/"];function fi(t,s,a,l){if(O(t))return t;var c=(null==s?void 0:s["content-length"])||new Blob([t]).size;return R(c)&&(c=parseInt(c)),c>a?tm+" ".concat(l," body too large to record (").concat(c," bytes)"):t}function mi(t,s){if(O(t))return t;var a=t;return _t(a,!1)||(a=tm+" "+s+" body "+ty),K(tS,t=>{var l,c;null!==(l=a)&&void 0!==l&&l.length&&-1!==(null===(c=a)||void 0===c?void 0:c.indexOf(t))&&(a=tm+" "+s+" body "+ty+" as might contain: "+t)}),a}var yi=(t,s)=>{var a,l,c={payloadSizeLimitBytes:tb.payloadSizeLimitBytes,performanceEntryTypeToObserve:[...tb.performanceEntryTypeToObserve],payloadHostDenyList:[...s.payloadHostDenyList||[],...tb.payloadHostDenyList]},d=!1!==t.session_recording.recordHeaders&&s.recordHeaders,h=!1!==t.session_recording.recordBody&&s.recordBody,_=!1!==t.capture_performance&&s.recordPerformance,p=(l=Math.min(1e6,null!==(a=c.payloadSizeLimitBytes)&&void 0!==a?a:1e6),t=>(null!=t&&t.requestBody&&(t.requestBody=fi(t.requestBody,t.requestHeaders,l,"Request")),null!=t&&t.responseBody&&(t.responseBody=fi(t.responseBody,t.responseHeaders,l,"Response")),t)),u=s=>{var a;return p(((t,s)=>{var a,l=wt(t.name),c=0===s.indexOf("http")?null===(a=wt(s))||void 0===a?void 0:a.pathname:s;"/"===c&&(c="");var d=null==l?void 0:l.pathname.replace(c||"","");if(!(l&&d&&tk.some(t=>0===d.indexOf(t))))return t})((O(a=s.requestHeaders)||K(Object.keys(null!=a?a:{}),t=>{tw.includes(t.toLowerCase())&&(a[t]=ty)}),s),t.api_host))},g=I(t.session_recording.maskNetworkRequestFn);return g&&I(t.session_recording.maskCapturedNetworkRequestFn)&&el.warn("Both `maskNetworkRequestFn` and `maskCapturedNetworkRequestFn` are defined. `maskNetworkRequestFn` will be ignored."),g&&(t.session_recording.maskCapturedNetworkRequestFn=s=>{var a=t.session_recording.maskNetworkRequestFn({url:s.name});return W(W({},s),{},{name:null==a?void 0:a.url})}),c.maskRequestFn=I(t.session_recording.maskCapturedNetworkRequestFn)?s=>{var a,l,c,d=u(s);return d&&null!==(a=null===(l=(c=t.session_recording).maskCapturedNetworkRequestFn)||void 0===l?void 0:l.call(c,d))&&void 0!==a?a:void 0}:t=>(function(t){if(!F(t))return t.requestBody=mi(t.requestBody,"Request"),t.responseBody=mi(t.responseBody,"Response"),t})(u(t)),W(W(W({},tb),c),{},{recordHeaders:d,recordBody:h,recordPerformance:_,recordInitialRequests:_})};function bi(t,s,a,l,c){return s>a&&(el.warn("min cannot be greater than max."),s=a),M(t)?t>a?(l&&el.warn(l+" cannot be  greater than max: "+a+". Using max value instead."),a):t<s?(l&&el.warn(l+" cannot be less than min: "+s+". Using min value instead."),s):t:(l&&el.warn(l+" must be a number. using max or fallback. max: "+a+", fallback: "+c),bi(c||a,s,a,l))}let wi=class wi{constructor(t){var s,a,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};V(this,"bucketSize",100),V(this,"refillRate",10),V(this,"mutationBuckets",{}),V(this,"loggedTracker",{}),V(this,"refillBuckets",()=>{Object.keys(this.mutationBuckets).forEach(t=>{this.mutationBuckets[t]=this.mutationBuckets[t]+this.refillRate,this.mutationBuckets[t]>=this.bucketSize&&delete this.mutationBuckets[t]})}),V(this,"getNodeOrRelevantParent",t=>{var s=this.rrweb.mirror.getNode(t);if("svg"!==(null==s?void 0:s.nodeName)&&s instanceof Element){var a=s.closest("svg");if(a)return[this.rrweb.mirror.getId(a),a]}return[t,s]}),V(this,"numberOfChanges",t=>{var s,a,l,c,d,h,_,p;return(null!==(s=null===(a=t.removes)||void 0===a?void 0:a.length)&&void 0!==s?s:0)+(null!==(l=null===(c=t.attributes)||void 0===c?void 0:c.length)&&void 0!==l?l:0)+(null!==(d=null===(h=t.texts)||void 0===h?void 0:h.length)&&void 0!==d?d:0)+(null!==(_=null===(p=t.adds)||void 0===p?void 0:p.length)&&void 0!==_?_:0)}),V(this,"throttleMutations",t=>{if(3!==t.type||0!==t.data.source)return t;var s=t.data,a=this.numberOfChanges(s);s.attributes&&(s.attributes=s.attributes.filter(t=>{var s,a,l,[c,d]=this.getNodeOrRelevantParent(t.id);return 0!==this.mutationBuckets[c]&&(this.mutationBuckets[c]=null!==(s=this.mutationBuckets[c])&&void 0!==s?s:this.bucketSize,this.mutationBuckets[c]=Math.max(this.mutationBuckets[c]-1,0),0===this.mutationBuckets[c]&&(this.loggedTracker[c]||(this.loggedTracker[c]=!0,null===(a=(l=this.options).onBlockedNode)||void 0===a||a.call(l,c,d))),t)}));var l=this.numberOfChanges(s);return 0!==l||a===l?t:void 0}),this.rrweb=t,this.options=l,this.refillRate=bi(null!==(s=this.options.refillRate)&&void 0!==s?s:this.refillRate,0,100,"mutation throttling refill rate"),this.bucketSize=bi(null!==(a=this.options.bucketSize)&&void 0!==a?a:this.bucketSize,0,100,"mutation throttling bucket size"),setInterval(()=>{this.refillBuckets()},1e3)}};var tE=Uint8Array,tF=Uint16Array,tx=Uint32Array,tI=new tE([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),tP=new tE([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),tC=new tE([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ci=function(t,s){for(var a=new tF(31),l=0;l<31;++l)a[l]=s+=1<<t[l-1];var c=new tx(a[30]);for(l=1;l<30;++l)for(var d=a[l];d<a[l+1];++d)c[d]=d-a[l]<<5|l;return[a,c]},tR=Ci(tI,2),tT=tR[0],t$=tR[1];tT[28]=258,t$[258]=28;for(var tO=Ci(tP,0)[1],tM=new tF(32768),tA=0;tA<32768;++tA){var tL=(43690&tA)>>>1|(21845&tA)<<1;tL=(61680&(tL=(52428&tL)>>>2|(13107&tL)<<2))>>>4|(3855&tL)<<4,tM[tA]=((65280&tL)>>>8|(255&tL)<<8)>>>1}var Li=function(t,s,a){for(var l=t.length,c=0,d=new tF(s);c<l;++c)++d[t[c]-1];var h,_=new tF(s);for(c=0;c<s;++c)_[c]=_[c-1]+d[c-1]<<1;if(a){h=new tF(1<<s);var p=15-s;for(c=0;c<l;++c)if(t[c])for(var g=c<<4|t[c],v=s-t[c],f=_[t[c]-1]++<<v,w=f|(1<<v)-1;f<=w;++f)h[tM[f]>>>p]=g}else for(h=new tF(l),c=0;c<l;++c)h[c]=tM[_[t[c]-1]++]>>>15-t[c];return h},tD=new tE(288);for(tA=0;tA<144;++tA)tD[tA]=8;for(tA=144;tA<256;++tA)tD[tA]=9;for(tA=256;tA<280;++tA)tD[tA]=7;for(tA=280;tA<288;++tA)tD[tA]=8;var tq=new tE(32);for(tA=0;tA<32;++tA)tq[tA]=5;var tW=Li(tD,9,0),tN=Li(tq,5,0),Hi=function(t){return(t/8>>0)+(7&t&&1)},Ui=function(t,s,a){(null==a||a>t.length)&&(a=t.length);var l=new(t instanceof tF?tF:t instanceof tx?tx:tE)(a-s);return l.set(t.subarray(s,a)),l},zi=function(t,s,a){a<<=7&s;var l=s/8>>0;t[l]|=a,t[l+1]|=a>>>8},ji=function(t,s,a){a<<=7&s;var l=s/8>>0;t[l]|=a,t[l+1]|=a>>>8,t[l+2]|=a>>>16},Wi=function(t,s){for(var a=[],l=0;l<t.length;++l)t[l]&&a.push({s:l,f:t[l]});var c=a.length,d=a.slice();if(!c)return[new tE(0),0];if(1==c){var h=new tE(a[0].s+1);return h[a[0].s]=1,[h,1]}a.sort(function(t,s){return t.f-s.f}),a.push({s:-1,f:25001});var _=a[0],p=a[1],g=0,v=1,f=2;for(a[0]={s:-1,f:_.f+p.f,l:_,r:p};v!=c-1;)_=a[a[g].f<a[f].f?g++:f++],p=a[g!=v&&a[g].f<a[f].f?g++:f++],a[v++]={s:-1,f:_.f+p.f,l:_,r:p};var w=d[0].s;for(l=1;l<c;++l)d[l].s>w&&(w=d[l].s);var S=new tF(w+1),k=Vi(a[v-1],S,0);if(k>s){l=0;var E=0,x=k-s,B=1<<x;for(d.sort(function(t,s){return S[s.s]-S[t.s]||t.f-s.f});l<c;++l){var H=d[l].s;if(!(S[H]>s))break;E+=B-(1<<k-S[H]),S[H]=s}for(E>>>=x;E>0;){var U=d[l].s;S[U]<s?E-=1<<s-S[U]++-1:++l}for(;l>=0&&E;--l){var J=d[l].s;S[J]==s&&(--S[J],++E)}k=s}return[new tE(S),k]},Vi=function(t,s,a){return -1==t.s?Math.max(Vi(t.l,s,a+1),Vi(t.r,s,a+1)):s[t.s]=a},Gi=function(t){for(var s=t.length;s&&!t[--s];);for(var a=new tF(++s),l=0,c=t[0],d=1,o=function(t){a[l++]=t},h=1;h<=s;++h)if(t[h]==c&&h!=s)++d;else{if(!c&&d>2){for(;d>138;d-=138)o(32754);d>2&&(o(d>10?d-11<<5|28690:d-3<<5|12305),d=0)}else if(d>3){for(o(c),--d;d>6;d-=6)o(8304);d>2&&(o(d-3<<5|8208),d=0)}for(;d--;)o(c);d=1,c=t[h]}return[a.subarray(0,l),s]},Ji=function(t,s){for(var a=0,l=0;l<s.length;++l)a+=t[l]*s[l];return a},Yi=function(t,s,a){var l=a.length,c=Hi(s+2);t[c]=255&l,t[c+1]=l>>>8,t[c+2]=255^t[c],t[c+3]=255^t[c+1];for(var d=0;d<l;++d)t[c+d+4]=a[d];return 8*(c+4+l)},Ki=function(t,s,a,l,c,d,h,_,p,g,v){zi(s,v++,a),++c[256];for(var f=Wi(c,15),w=f[0],S=f[1],k=Wi(d,15),E=k[0],x=k[1],B=Gi(w),H=B[0],U=B[1],J=Gi(E),es=J[0],er=J[1],en=new tF(19),ea=0;ea<H.length;++ea)en[31&H[ea]]++;for(ea=0;ea<es.length;++ea)en[31&es[ea]]++;for(var el=Wi(en,7),ec=el[0],eu=el[1],ed=19;ed>4&&!ec[tC[ed-1]];--ed);var eh,e_,ep,eg,ev=g+5<<3,ef=Ji(c,tD)+Ji(d,tq)+h,em=Ji(c,w)+Ji(d,E)+h+14+3*ed+Ji(en,ec)+(2*en[16]+3*en[17]+7*en[18]);if(ev<=ef&&ev<=em)return Yi(s,v,t.subarray(p,p+g));if(zi(s,v,1+(em<ef)),v+=2,em<ef){eh=Li(w,S,0),e_=w,ep=Li(E,x,0),eg=E;var ey=Li(ec,eu,0);for(zi(s,v,U-257),zi(s,v+5,er-1),zi(s,v+10,ed-4),v+=14,ea=0;ea<ed;++ea)zi(s,v+3*ea,ec[tC[ea]]);v+=3*ed;for(var eb=[H,es],ew=0;ew<2;++ew){var eS=eb[ew];for(ea=0;ea<eS.length;++ea){var ek=31&eS[ea];zi(s,v,ey[ek]),v+=ec[ek],ek>15&&(zi(s,v,eS[ea]>>>5&127),v+=eS[ea]>>>12)}}}else eh=tW,e_=tD,ep=tN,eg=tq;for(ea=0;ea<_;++ea)if(l[ea]>255){ji(s,v,eh[(ek=l[ea]>>>18&31)+257]),v+=e_[ek+257],ek>7&&(zi(s,v,l[ea]>>>23&31),v+=tI[ek]);var eE=31&l[ea];ji(s,v,ep[eE]),v+=eg[eE],eE>3&&(ji(s,v,l[ea]>>>5&8191),v+=tP[eE])}else ji(s,v,eh[l[ea]]),v+=e_[l[ea]];return ji(s,v,eh[256]),v+e_[256]},tV=new tx([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),tB=function(){for(var t=new tx(256),s=0;s<256;++s){for(var a=s,l=9;--l;)a=(1&a&&3988292384)^a>>>1;t[s]=a}return t}(),Zi=function(){var t=4294967295;return{p:function(s){for(var a=t,l=0;l<s.length;++l)a=tB[255&a^s[l]]^a>>>8;t=a},d:function(){return 4294967295^t}}},tr=function(t,s,a){for(;a;++s)t[s]=a,a>>>=8},ir=function(t,s){var a=s.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=s.level<2?4:9==s.level?2:0,t[9]=3,0!=s.mtime&&tr(t,4,Math.floor(new Date(s.mtime||Date.now())/1e3)),a){t[3]=8;for(var l=0;l<=a.length;++l)t[l+10]=a.charCodeAt(l)}};function sr(t,s){void 0===s&&(s={});var a,l,c,d=Zi(),h=t.length;d.p(t);var _=(l=s,c=10+((a=s).filename&&a.filename.length+1||0),function(t,s,a,l,c,d){var h=t.length,_=new tE(l+h+5*(1+Math.floor(h/7e3))+c),p=_.subarray(l,_.length-c),g=0;if(!s||h<8)for(var v=0;v<=h;v+=65535){var f=v+65535;f<h?g=Yi(p,g,t.subarray(v,f)):(p[v]=d,g=Yi(p,g,t.subarray(v,h)))}else{for(var w=tV[s-1],S=w>>>13,k=8191&w,E=(1<<a)-1,x=new tF(32768),B=new tF(E+1),H=Math.ceil(a/3),U=2*H,b=function(s){return(t[s]^t[s+1]<<H^t[s+2]<<U)&E},J=new tx(25e3),es=new tF(288),er=new tF(32),en=0,ea=0,el=(v=0,0),ec=0,eu=0;v<h;++v){var ed=b(v),eh=32767&v,e_=B[ed];if(x[eh]=e_,B[ed]=eh,ec<=v){var ep=h-v;if((en>7e3||el>24576)&&ep>423){g=Ki(t,p,0,J,es,er,ea,el,eu,v-eu,g),el=en=ea=0,eu=v;for(var eg=0;eg<286;++eg)es[eg]=0;for(eg=0;eg<30;++eg)er[eg]=0}var ev=2,ef=0,em=k,ey=eh-e_&32767;if(ep>2&&ed==b(v-ey))for(var eb=Math.min(S,ep)-1,ew=Math.min(32767,v),eS=Math.min(258,ep);ey<=ew&&--em&&eh!=e_;){if(t[v+ev]==t[v+ev-ey]){for(var ek=0;ek<eS&&t[v+ek]==t[v+ek-ey];++ek);if(ek>ev){if(ev=ek,ef=ey,ek>eb)break;var eE=Math.min(ey,ek-2),eF=0;for(eg=0;eg<eE;++eg){var ex=v-ey+eg+32768&32767,eI=ex-x[ex]+32768&32767;eI>eF&&(eF=eI,e_=ex)}}}ey+=(eh=e_)-(e_=x[eh])+32768&32767}if(ef){J[el++]=268435456|t$[ev]<<18|tO[ef];var eP=31&t$[ev],eC=31&tO[ef];ea+=tI[eP]+tP[eC],++es[257+eP],++er[eC],ec=v+ev,++en}else J[el++]=t[v],++es[t[v]]}}g=Ki(t,p,d,J,es,er,ea,el,eu,v-eu,g)}return Ui(_,0,l+Hi(g)+c)}(t,null==l.level?6:l.level,null==l.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+l.mem,c,8,!0)),p=_.length;return ir(_,s),tr(_,p-8,d.d()),tr(_,p-4,h),_}function nr(t,s){var a=t.length;if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(t);for(var l=new tE(t.length+(t.length>>>1)),c=0,n=function(t){l[c++]=t},d=0;d<a;++d){if(c+5>l.length){var h=new tE(c+8+(a-d<<1));h.set(l),l=h}var _=t.charCodeAt(d);_<128||s?n(_):(_<2048?n(192|_>>>6):(_>55295&&_<57344?(n(240|(_=65536+(1047552&_)|1023&t.charCodeAt(++d))>>>18),n(128|_>>>12&63)):n(224|_>>>12),n(128|_>>>6&63)),n(128|63&_))}return Ui(l,0,c)}var tH="[SessionRecording]",tz=ec(tH),tU=[tf.MouseMove,tf.MouseInteraction,tf.Scroll,tf.ViewportResize,tf.Input,tf.TouchMove,tf.MediaInteraction,tf.Drag],dr=t=>({rrwebMethod:t,enqueuedAt:Date.now(),attempt:1});function hr(t){return function(t,s){for(var a="",l=0;l<t.length;){var c=t[l++];c<128||s?a+=String.fromCharCode(c):c<224?a+=String.fromCharCode((31&c)<<6|63&t[l++]):c<240?a+=String.fromCharCode((15&c)<<12|(63&t[l++])<<6|63&t[l++]):a+=String.fromCharCode(55296|(c=((15&c)<<18|(63&t[l++])<<12|(63&t[l++])<<6|63&t[l++])-65536)>>10,56320|1023&c)}return a}(sr(nr(JSON.stringify(t))),!0)}function _r(t){return t.type===tv.Custom&&"sessionIdle"===t.data.tag}function pr(t,s){return s.some(s=>"regex"===s.matching&&new RegExp(s.url).test(t))}let gr=class gr{get sessionIdleThresholdMilliseconds(){return this.instance.config.session_recording.session_idle_threshold_ms||3e5}get rrwebRecord(){var t,s;return null==x||null===(t=x.__PosthogExtensions__)||void 0===t||null===(s=t.rrweb)||void 0===s?void 0:s.record}get started(){return this._captureStarted}get sessionManager(){if(!this.instance.sessionManager)throw Error(tH+" must be started with a valid sessionManager.");return this.instance.sessionManager}get fullSnapshotIntervalMillis(){var t,s;return"trigger_pending"===this.triggerStatus?6e4:null!==(t=null===(s=this.instance.config.session_recording)||void 0===s?void 0:s.full_snapshot_interval_millis)&&void 0!==t?t:3e5}get isSampled(){var t=this.instance.get_property(eR);return A(t)?t:null}get sessionDuration(){var t,s,a=null===(t=this.buffer)||void 0===t?void 0:t.data[(null===(s=this.buffer)||void 0===s?void 0:s.data.length)-1],{sessionStartTimestamp:l}=this.sessionManager.checkAndGetSessionAndWindowId(!0);return a?a.timestamp-l:null}get isRecordingEnabled(){var t=!!this.instance.get_property(eS),s=!this.instance.config.disable_session_recording;return c&&t&&s}get isConsoleLogCaptureEnabled(){var t=!!this.instance.get_property(ek),s=this.instance.config.enable_recording_console_log;return null!=s?s:t}get canvasRecording(){var t,s,a,l,c,d,h=this.instance.config.session_recording.captureCanvas,_=this.instance.get_property(eF),p=null!==(t=null!==(s=null==h?void 0:h.recordCanvas)&&void 0!==s?s:null==_?void 0:_.enabled)&&void 0!==t&&t,g=null!==(a=null!==(l=null==h?void 0:h.canvasFps)&&void 0!==l?l:null==_?void 0:_.fps)&&void 0!==a?a:4,v=null!==(c=null!==(d=null==h?void 0:h.canvasQuality)&&void 0!==d?d:null==_?void 0:_.quality)&&void 0!==c?c:.4;if("string"==typeof v){var f=parseFloat(v);v=isNaN(f)?.4:f}return{enabled:p,fps:bi(g,0,12,"canvas recording fps",4),quality:bi(v,0,1,"canvas recording quality",.4)}}get networkPayloadCapture(){var t,s,a=this.instance.get_property(eE),l={recordHeaders:null===(t=this.instance.config.session_recording)||void 0===t?void 0:t.recordHeaders,recordBody:null===(s=this.instance.config.session_recording)||void 0===s?void 0:s.recordBody},c=(null==l?void 0:l.recordHeaders)||(null==a?void 0:a.recordHeaders),d=(null==l?void 0:l.recordBody)||(null==a?void 0:a.recordBody),h=P(this.instance.config.capture_performance)?this.instance.config.capture_performance.network_timing:this.instance.config.capture_performance,_=!!(A(h)?h:null==a?void 0:a.capturePerformance);return c||d||_?{recordHeaders:c,recordBody:d,recordPerformance:_}:void 0}get sampleRate(){var t=this.instance.get_property(ex);return M(t)?t:null}get minimumDuration(){var t=this.instance.get_property(eI);return M(t)?t:null}get status(){return this.receivedDecide?this.isRecordingEnabled?!1===this.isSampled?"disabled":this._urlBlocked?"paused":O(this._linkedFlag)||this._linkedFlagSeen?"trigger_pending"===this.triggerStatus?"buffering":A(this.isSampled)?this.isSampled?"sampled":"disabled":"active":"buffering":"disabled":"buffering"}get urlTriggerStatus(){var t;return 0===this._urlTriggers.length?"trigger_disabled":(null===(t=this.instance)||void 0===t?void 0:t.get_property(eT))===this.sessionId?"trigger_activated":"trigger_pending"}get eventTriggerStatus(){var t;return 0===this._eventTriggers.length?"trigger_disabled":(null===(t=this.instance)||void 0===t?void 0:t.get_property(e$))===this.sessionId?"trigger_activated":"trigger_pending"}get triggerStatus(){var t="trigger_activated"===this.eventTriggerStatus||"trigger_activated"===this.urlTriggerStatus,s="trigger_pending"===this.eventTriggerStatus||"trigger_pending"===this.urlTriggerStatus;return t?"trigger_activated":s?"trigger_pending":"trigger_disabled"}constructor(t){if(V(this,"queuedRRWebEvents",[]),V(this,"isIdle",!1),V(this,"_linkedFlagSeen",!1),V(this,"_lastActivityTimestamp",Date.now()),V(this,"_linkedFlag",null),V(this,"_removePageViewCaptureHook",void 0),V(this,"_onSessionIdListener",void 0),V(this,"_persistDecideOnSessionListener",void 0),V(this,"_samplingSessionListener",void 0),V(this,"_urlTriggers",[]),V(this,"_urlBlocklist",[]),V(this,"_urlBlocked",!1),V(this,"_eventTriggers",[]),V(this,"_removeEventTriggerCaptureHook",void 0),V(this,"_forceAllowLocalhostNetworkCapture",!1),V(this,"_onBeforeUnload",()=>{this._flushBuffer()}),V(this,"_onOffline",()=>{this._tryAddCustomEvent("browser offline",{})}),V(this,"_onOnline",()=>{this._tryAddCustomEvent("browser online",{})}),V(this,"_onVisibilityChange",()=>{if(null!=v&&v.visibilityState){var t="window "+v.visibilityState;this._tryAddCustomEvent(t,{})}}),this.instance=t,this._captureStarted=!1,this._endpoint="/s/",this.stopRrweb=void 0,this.receivedDecide=!1,!this.instance.sessionManager)throw tz.error("started without valid sessionManager"),Error(tH+" started without valid sessionManager. This is a bug.");if(this.instance.config.__preview_experimental_cookieless_mode)throw Error(tH+" cannot be used with __preview_experimental_cookieless_mode.");var{sessionId:s,windowId:a}=this.sessionManager.checkAndGetSessionAndWindowId();this.sessionId=s,this.windowId=a,this.buffer=this.clearBuffer(),this.sessionIdleThresholdMilliseconds>=this.sessionManager.sessionTimeoutMs&&tz.warn("session_idle_threshold_ms (".concat(this.sessionIdleThresholdMilliseconds,") is greater than the session timeout (").concat(this.sessionManager.sessionTimeoutMs,"). Session will never be detected as idle"))}startIfEnabledOrStop(t){this.isRecordingEnabled?(this._startCapture(t),ae(c,"beforeunload",this._onBeforeUnload),ae(c,"offline",this._onOffline),ae(c,"online",this._onOnline),ae(c,"visibilitychange",this._onVisibilityChange),this._setupSampling(),this._addEventTriggerListener(),O(this._removePageViewCaptureHook)&&(this._removePageViewCaptureHook=this.instance.on("eventCaptured",t=>{try{if("$pageview"===t.event){var s=null!=t&&t.properties.$current_url?this._maskUrl(null==t?void 0:t.properties.$current_url):"";if(!s)return;this._tryAddCustomEvent("$pageview",{href:s})}}catch(t){tz.error("Could not add $pageview to rrweb session",t)}})),this._onSessionIdListener||(this._onSessionIdListener=this.sessionManager.onSessionId((t,s,a)=>{var l,c,d,h;a&&(this._tryAddCustomEvent("$session_id_change",{sessionId:t,windowId:s,changeReason:a}),null===(l=this.instance)||void 0===l||null===(c=l.persistence)||void 0===c||c.unregister(e$),null===(d=this.instance)||void 0===d||null===(h=d.persistence)||void 0===h||h.unregister(eT))}))):this.stopRecording()}stopRecording(){var t,s,a,l;this._captureStarted&&this.stopRrweb&&(this.stopRrweb(),this.stopRrweb=void 0,this._captureStarted=!1,null==c||c.removeEventListener("beforeunload",this._onBeforeUnload),null==c||c.removeEventListener("offline",this._onOffline),null==c||c.removeEventListener("online",this._onOnline),null==c||c.removeEventListener("visibilitychange",this._onVisibilityChange),this.clearBuffer(),clearInterval(this._fullSnapshotTimer),null===(t=this._removePageViewCaptureHook)||void 0===t||t.call(this),this._removePageViewCaptureHook=void 0,null===(s=this._removeEventTriggerCaptureHook)||void 0===s||s.call(this),this._removeEventTriggerCaptureHook=void 0,null===(a=this._onSessionIdListener)||void 0===a||a.call(this),this._onSessionIdListener=void 0,null===(l=this._samplingSessionListener)||void 0===l||l.call(this),this._samplingSessionListener=void 0,tz.info("stopped"))}makeSamplingDecision(t){var s,a,l=this.sessionId!==t,c=this.sampleRate;if(M(c)){var d=this.isSampled,h=l||!A(d),_=h?function(t){for(var s=0,a=0;a<t.length;a++)s=(s<<5)-s+t.charCodeAt(a)|0;return Math.abs(s)}(t)%100<bi(100*c,0,100):d;h&&(_?this._reportStarted("sampled"):tz.warn("Sample rate (".concat(c,") has determined that this sessionId (").concat(t,") will not be sent to the server.")),this._tryAddCustomEvent("samplingDecisionMade",{sampleRate:c,isSampled:_})),null===(a=this.instance.persistence)||void 0===a||a.register({[eR]:_})}else null===(s=this.instance.persistence)||void 0===s||s.register({[eR]:null})}onRemoteConfig(t){var s,a,l,c,d,h;if(this._tryAddCustomEvent("$remote_config_received",t),this._persistRemoteConfig(t),this._linkedFlag=(null===(s=t.sessionRecording)||void 0===s?void 0:s.linkedFlag)||null,null!==(a=t.sessionRecording)&&void 0!==a&&a.endpoint&&(this._endpoint=null===(h=t.sessionRecording)||void 0===h?void 0:h.endpoint),this._setupSampling(),!O(this._linkedFlag)&&!this._linkedFlagSeen){var _=R(this._linkedFlag)?this._linkedFlag:this._linkedFlag.flag,p=R(this._linkedFlag)?null:this._linkedFlag.variant;this.instance.onFeatureFlags((t,s)=>{var a=P(s)&&_ in s,l=p?s[_]===p:a;l&&this._reportStarted("linked_flag_matched",{linkedFlag:_,linkedVariant:p}),this._linkedFlagSeen=l})}null!==(l=t.sessionRecording)&&void 0!==l&&l.urlTriggers&&(this._urlTriggers=t.sessionRecording.urlTriggers),null!==(c=t.sessionRecording)&&void 0!==c&&c.urlBlocklist&&(this._urlBlocklist=t.sessionRecording.urlBlocklist),null!==(d=t.sessionRecording)&&void 0!==d&&d.eventTriggers&&(this._eventTriggers=t.sessionRecording.eventTriggers),this.receivedDecide=!0,this.startIfEnabledOrStop()}_setupSampling(){M(this.sampleRate)&&O(this._samplingSessionListener)&&(this._samplingSessionListener=this.sessionManager.onSessionId(t=>{this.makeSamplingDecision(t)}))}_persistRemoteConfig(t){if(this.instance.persistence){var s,a=this.instance.persistence,r=()=>{var s,l,c,d,h,_,p,g,v=null===(s=t.sessionRecording)||void 0===s?void 0:s.sampleRate,f=O(v)?null:parseFloat(v),w=null===(l=t.sessionRecording)||void 0===l?void 0:l.minimumDurationMilliseconds;a.register({[eS]:!!t.sessionRecording,[ek]:null===(c=t.sessionRecording)||void 0===c?void 0:c.consoleLogRecordingEnabled,[eE]:W({capturePerformance:t.capturePerformance},null===(d=t.sessionRecording)||void 0===d?void 0:d.networkPayloadCapture),[eF]:{enabled:null===(h=t.sessionRecording)||void 0===h?void 0:h.recordCanvas,fps:null===(_=t.sessionRecording)||void 0===_?void 0:_.canvasFps,quality:null===(p=t.sessionRecording)||void 0===p?void 0:p.canvasQuality},[ex]:f,[eI]:F(w)?null:w,[eP]:null===(g=t.sessionRecording)||void 0===g?void 0:g.scriptConfig})};r(),null===(s=this._persistDecideOnSessionListener)||void 0===s||s.call(this),this._persistDecideOnSessionListener=this.sessionManager.onSessionId(r)}}log(t){var s,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"log";null===(s=this.instance.sessionRecording)||void 0===s||s.onRRwebEmit({type:6,data:{plugin:"rrweb/console@1",payload:{level:a,trace:[],payload:[JSON.stringify(t)]}},timestamp:Date.now()})}_startCapture(t){if(!F(Object.assign)&&!F(Array.from)&&!(this._captureStarted||this.instance.config.disable_session_recording||this.instance.consent.isOptedOut())){var s,a;(this._captureStarted=!0,this.sessionManager.checkAndGetSessionAndWindowId(),this.rrwebRecord)?this._onScriptLoaded():null===(s=x.__PosthogExtensions__)||void 0===s||null===(a=s.loadExternalDependency)||void 0===a||a.call(s,this.instance,this.scriptName,t=>{if(t)return tz.error("could not load recorder",t);this._onScriptLoaded()}),tz.info("starting"),"active"===this.status&&this._reportStarted(t||"recording_initialized")}}get scriptName(){var t,s,a;return(null===(t=this.instance)||void 0===t||null===(s=t.persistence)||void 0===s||null===(a=s.get_property(eP))||void 0===a?void 0:a.script)||"recorder"}isInteractiveEvent(t){var s;return 3===t.type&&-1!==tU.indexOf(null===(s=t.data)||void 0===s?void 0:s.source)}_updateWindowAndSessionIds(t){var s=this.isInteractiveEvent(t);s||this.isIdle||t.timestamp-this._lastActivityTimestamp>this.sessionIdleThresholdMilliseconds&&(this.isIdle=!0,clearInterval(this._fullSnapshotTimer),this._tryAddCustomEvent("sessionIdle",{eventTimestamp:t.timestamp,lastActivityTimestamp:this._lastActivityTimestamp,threshold:this.sessionIdleThresholdMilliseconds,bufferLength:this.buffer.data.length,bufferSize:this.buffer.size}),this._flushBuffer());var a=!1;if(s&&(this._lastActivityTimestamp=t.timestamp,this.isIdle&&(this.isIdle=!1,this._tryAddCustomEvent("sessionNoLongerIdle",{reason:"user activity",type:t.type}),a=!0)),!this.isIdle){var{windowId:l,sessionId:c}=this.sessionManager.checkAndGetSessionAndWindowId(!s,t.timestamp),d=this.sessionId!==c,h=this.windowId!==l;this.windowId=l,this.sessionId=c,d||h?(this.stopRecording(),this.startIfEnabledOrStop("session_id_changed")):a&&this._scheduleFullSnapshot()}}_tryRRWebMethod(t){try{return t.rrwebMethod(),!0}catch(s){return this.queuedRRWebEvents.length<10?this.queuedRRWebEvents.push({enqueuedAt:t.enqueuedAt||Date.now(),attempt:t.attempt++,rrwebMethod:t.rrwebMethod}):tz.warn("could not emit queued rrweb event.",s,t),!1}}_tryAddCustomEvent(t,s){return this._tryRRWebMethod(dr(()=>this.rrwebRecord.addCustomEvent(t,s)))}_tryTakeFullSnapshot(){return this._tryRRWebMethod(dr(()=>this.rrwebRecord.takeFullSnapshot()))}_onScriptLoaded(){var t,s={blockClass:"ph-no-capture",blockSelector:void 0,ignoreClass:"ph-ignore-input",maskTextClass:"ph-mask",maskTextSelector:void 0,maskTextFn:void 0,maskAllInputs:!0,maskInputOptions:{password:!0},maskInputFn:void 0,slimDOMOptions:{},collectFonts:!1,inlineStylesheet:!0,recordCrossOriginIframes:!1};for(var[a,l]of Object.entries(this.instance.config.session_recording||{}))a in s&&("maskInputOptions"===a?s.maskInputOptions=W({password:!0},l):s[a]=l);if(this.canvasRecording&&this.canvasRecording.enabled&&(s.recordCanvas=!0,s.sampling={canvas:this.canvasRecording.fps},s.dataURLOptions={type:"image/webp",quality:this.canvasRecording.quality}),this.rrwebRecord){this.mutationRateLimiter=null!==(t=this.mutationRateLimiter)&&void 0!==t?t:new wi(this.rrwebRecord,{refillRate:this.instance.config.session_recording.__mutationRateLimiterRefillRate,bucketSize:this.instance.config.session_recording.__mutationRateLimiterBucketSize,onBlockedNode:(t,s)=>{var a="Too many mutations on node '".concat(t,"'. Rate limiting. This could be due to SVG animations or something similar");tz.info(a,{node:s}),this.log(tH+" "+a,"warn")}});var c=this._gatherRRWebPlugins();this.stopRrweb=this.rrwebRecord(W({emit:t=>{this.onRRwebEmit(t)},plugins:c},s)),this._lastActivityTimestamp=Date.now(),this.isIdle=!1,this._tryAddCustomEvent("$session_options",{sessionRecordingOptions:s,activePlugins:c.map(t=>null==t?void 0:t.name)}),this._tryAddCustomEvent("$posthog_config",{config:this.instance.config})}else tz.error("onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.")}_scheduleFullSnapshot(){if(this._fullSnapshotTimer&&clearInterval(this._fullSnapshotTimer),!this.isIdle){var t=this.fullSnapshotIntervalMillis;t&&(this._fullSnapshotTimer=setInterval(()=>{this._tryTakeFullSnapshot()},t))}}_gatherRRWebPlugins(){var t,s,a,l,c=[],d=null===(t=x.__PosthogExtensions__)||void 0===t||null===(s=t.rrwebPlugins)||void 0===s?void 0:s.getRecordConsolePlugin;d&&this.isConsoleLogCaptureEnabled&&c.push(d());var h=null===(a=x.__PosthogExtensions__)||void 0===a||null===(l=a.rrwebPlugins)||void 0===l?void 0:l.getRecordNetworkPlugin;return this.networkPayloadCapture&&I(h)&&(!e3.includes(location.hostname)||this._forceAllowLocalhostNetworkCapture?c.push(h(yi(this.instance.config,this.networkPayloadCapture))):tz.info("NetworkCapture not started because we are on localhost.")),c}onRRwebEmit(t){var s;if(this._processQueuedEvents(),t&&P(t)){if(t.type===tv.Meta){var a=this._maskUrl(t.data.href);if(this._lastHref=a,!a)return;t.data.href=a}else this._pageViewFallBack();if(this._checkUrlTriggerConditions(),!this._urlBlocked||t.type===tv.Custom&&"recording paused"===t.data.tag){t.type===tv.FullSnapshot&&this._scheduleFullSnapshot(),t.type===tv.FullSnapshot&&"trigger_pending"===this.triggerStatus&&this.clearBuffer();var l=this.mutationRateLimiter?this.mutationRateLimiter.throttleMutations(t):t;if(l){var c=function(t){if(t&&P(t)&&6===t.type&&P(t.data)&&"rrweb/console@1"===t.data.plugin){t.data.payload.payload.length>10&&(t.data.payload.payload=t.data.payload.payload.slice(0,10),t.data.payload.payload.push("...[truncated]"));for(var s=[],a=0;a<t.data.payload.payload.length;a++)t.data.payload.payload[a]&&t.data.payload.payload[a].length>2e3?s.push(t.data.payload.payload[a].slice(0,2e3)+"...[truncated]"):s.push(t.data.payload.payload[a]);return t.data.payload.payload=s,t}return t}(l);if(this._updateWindowAndSessionIds(c),!this.isIdle||_r(c)){if(_r(c)){var d=c.data.payload;if(d){var h=d.lastActivityTimestamp,_=d.threshold;c.timestamp=h+_}}var p=null===(s=this.instance.config.session_recording.compress_events)||void 0===s||s?function(t){if(1024>ai(t))return t;try{if(t.type===tv.FullSnapshot)return W(W({},t),{},{data:hr(t.data),cv:"2024-10"});if(t.type===tv.IncrementalSnapshot&&t.data.source===tf.Mutation)return W(W({},t),{},{cv:"2024-10",data:W(W({},t.data),{},{texts:hr(t.data.texts),attributes:hr(t.data.attributes),removes:hr(t.data.removes),adds:hr(t.data.adds)})});if(t.type===tv.IncrementalSnapshot&&t.data.source===tf.StyleSheetRule)return W(W({},t),{},{cv:"2024-10",data:W(W({},t.data),{},{adds:t.data.adds?hr(t.data.adds):void 0,removes:t.data.removes?hr(t.data.removes):void 0})})}catch(t){tz.error("could not compress event - will use uncompressed event",t)}return t}(c):c,g={$snapshot_bytes:ai(p),$snapshot_data:p,$session_id:this.sessionId,$window_id:this.windowId};"disabled"!==this.status?this._captureSnapshotBuffered(g):this.clearBuffer()}}}}}_pageViewFallBack(){if(!this.instance.config.capture_pageview&&c){var t=this._maskUrl(c.location.href);this._lastHref!==t&&(this._tryAddCustomEvent("$url_changed",{href:t}),this._lastHref=t)}}_processQueuedEvents(){if(this.queuedRRWebEvents.length){var t=[...this.queuedRRWebEvents];this.queuedRRWebEvents=[],t.forEach(t=>{Date.now()-t.enqueuedAt<=2e3&&this._tryRRWebMethod(t)})}}_maskUrl(t){var s=this.instance.config.session_recording;if(s.maskNetworkRequestFn){var a,l={url:t};return null===(a=l=s.maskNetworkRequestFn(l))||void 0===a?void 0:a.url}return t}clearBuffer(){return this.buffer={size:0,data:[],sessionId:this.sessionId,windowId:this.windowId},this.buffer}_flushBuffer(){this.flushBufferTimer&&(clearTimeout(this.flushBufferTimer),this.flushBufferTimer=void 0);var t=this.minimumDuration,s=this.sessionDuration,a=M(s)&&s>=0,l=M(t)&&a&&s<t;return"buffering"===this.status||"paused"===this.status||"disabled"===this.status||l?(this.flushBufferTimer=setTimeout(()=>{this._flushBuffer()},2e3),this.buffer):(this.buffer.data.length>0&&(function li(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6606028.8;if(t.size>=s&&t.data.length>1){var a=Math.floor(t.data.length/2),l=t.data.slice(0,a),c=t.data.slice(a);return[li({size:ai(l),data:l,sessionId:t.sessionId,windowId:t.windowId}),li({size:ai(c),data:c,sessionId:t.sessionId,windowId:t.windowId})].flatMap(t=>t)}return[t]})(this.buffer).forEach(t=>{this._captureSnapshot({$snapshot_bytes:t.size,$snapshot_data:t.data,$session_id:t.sessionId,$window_id:t.windowId,$lib:"web",$lib_version:B.LIB_VERSION})}),this.clearBuffer())}_captureSnapshotBuffered(t){var s,a=2+((null===(s=this.buffer)||void 0===s?void 0:s.data.length)||0);!this.isIdle&&(this.buffer.size+t.$snapshot_bytes+a>943718.4||this.buffer.sessionId!==this.sessionId)&&(this.buffer=this._flushBuffer()),this.buffer.size+=t.$snapshot_bytes,this.buffer.data.push(t.$snapshot_data),this.flushBufferTimer||this.isIdle||(this.flushBufferTimer=setTimeout(()=>{this._flushBuffer()},2e3))}_captureSnapshot(t){this.instance.capture("$snapshot",t,{_url:this.instance.requestRouter.endpointFor("api",this._endpoint),_noTruncate:!0,_batchKey:"recordings",skip_client_rate_limiting:!0})}_checkUrlTriggerConditions(){if(void 0!==c&&c.location.href){var t=c.location.href,s=this._urlBlocked,a=pr(t,this._urlBlocklist);a&&!s?this._pauseRecording():!a&&s&&this._resumeRecording(),pr(t,this._urlTriggers)&&this._activateTrigger("url")}}_activateTrigger(t){var s,a;"trigger_pending"===this.triggerStatus&&(null===(s=this.instance)||void 0===s||null===(a=s.persistence)||void 0===a||a.register({["url"===t?eT:e$]:this.sessionId}),this._flushBuffer(),this._reportStarted(t+"_trigger_matched"))}_pauseRecording(){this._urlBlocked||(this._urlBlocked=!0,clearInterval(this._fullSnapshotTimer),tz.info("recording paused due to URL blocker"),this._tryAddCustomEvent("recording paused",{reason:"url blocker"}))}_resumeRecording(){this._urlBlocked&&(this._urlBlocked=!1,this._tryTakeFullSnapshot(),this._scheduleFullSnapshot(),this._tryAddCustomEvent("recording resumed",{reason:"left blocked url"}),tz.info("recording resumed"))}_addEventTriggerListener(){0!==this._eventTriggers.length&&O(this._removeEventTriggerCaptureHook)&&(this._removeEventTriggerCaptureHook=this.instance.on("eventCaptured",t=>{try{this._eventTriggers.includes(t.event)&&this._activateTrigger("event")}catch(t){tz.error("Could not activate event trigger",t)}}))}overrideLinkedFlag(){this._linkedFlagSeen=!0,this._tryTakeFullSnapshot(),this._reportStarted("linked_flag_overridden")}overrideSampling(){var t;null===(t=this.instance.persistence)||void 0===t||t.register({[eR]:!0}),this._tryTakeFullSnapshot(),this._reportStarted("sampling_overridden")}overrideTrigger(t){this._activateTrigger(t)}_reportStarted(t,s){this.instance.register_for_session({$session_recording_start_reason:t}),tz.info(t.replace("_"," "),s),m(["recording_initialized","session_id_changed"],t)||this._tryAddCustomEvent(t,s)}};var tj=ec("[SegmentIntegration]"),tG="posthog-js";function yr(t){var{organization:s,projectId:a,prefix:l,severityAllowList:c=["error"]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d=>{if(!("*"===c||c.includes(d.level))||!t.__loaded)return d;d.tags||(d.tags={});var h,_,p,g,v,f=t.requestRouter.endpointFor("ui","/project/".concat(t.config.token,"/person/").concat(t.get_distinct_id()));d.tags["PostHog Person URL"]=f,t.sessionRecordingStarted()&&(d.tags["PostHog Recording URL"]=t.get_session_replay_url({withTimestamp:!0}));var w=(null===(h=d.exception)||void 0===h?void 0:h.values)||[];w.forEach(t=>{t.stacktrace&&(t.stacktrace.type="raw",t.stacktrace.frames.forEach(t=>{t.platform="web:javascript"}))});var S={$exception_message:(null===(_=w[0])||void 0===_?void 0:_.value)||d.message,$exception_type:null===(p=w[0])||void 0===p?void 0:p.type,$exception_personURL:f,$exception_level:d.level,$exception_list:w,$sentry_event_id:d.event_id,$sentry_exception:d.exception,$sentry_exception_message:(null===(g=w[0])||void 0===g?void 0:g.value)||d.message,$sentry_exception_type:null===(v=w[0])||void 0===v?void 0:v.type,$sentry_tags:d.tags};return s&&a&&(S.$sentry_url=(l||"https://sentry.io/organizations/")+s+"/issues/?project="+a+"&query="+d.event_id),t.exceptions.sendExceptionEvent(S),d}}let br=class br{constructor(t,s,a,l,c){this.name=tG,this.setupOnce=function(d){d(yr(t,{organization:s,projectId:a,prefix:l,severityAllowList:c}))}}};var tK,tY,tJ,tX,tQ=null!=c&&c.location?xt(c.location.hash,"__posthog")||xt(location.hash,"state"):null,tZ="_postHogToolbarParams",t0=ec("[Toolbar]");(t5=tX||(tX={}))[t5.UNINITIALIZED=0]="UNINITIALIZED",t5[t5.LOADING=1]="LOADING",t5[t5.LOADED=2]="LOADED";let xr=class xr{constructor(t){this.instance=t}setToolbarState(t){x.ph_toolbar_state=t}getToolbarState(){var t;return null!==(t=x.ph_toolbar_state)&&void 0!==t?t:tX.UNINITIALIZED}maybeLoadToolbar(){var t,s,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(!c||!v)return!1;a=null!==(t=a)&&void 0!==t?t:c.location,d=null!==(s=d)&&void 0!==s?s:c.history;try{if(!l){try{c.localStorage.setItem("test","test"),c.localStorage.removeItem("test")}catch(t){return!1}l=null==c?void 0:c.localStorage}var h,_=tQ||xt(a.hash,"__posthog")||xt(a.hash,"state"),p=_?ee(()=>JSON.parse(atob(decodeURIComponent(_))))||ee(()=>JSON.parse(decodeURIComponent(_))):null;return p&&"ph_authorize"===p.action?((h=p).source="url",h&&Object.keys(h).length>0&&(p.desiredHash?a.hash=p.desiredHash:d?d.replaceState(d.state,"",a.pathname+a.search):a.hash="")):((h=JSON.parse(l.getItem(tZ)||"{}")).source="localstorage",delete h.userIntent),!(!h.token||this.instance.config.token!==h.token)&&(this.loadToolbar(h),!0)}catch(t){return!1}}_callLoadToolbar(t){var s=x.ph_load_toolbar||x.ph_load_editor;!O(s)&&I(s)?s(t,this.instance):t0.warn("No toolbar load function found")}loadToolbar(t){var s,a,l=!(null==v||!v.getElementById(eG));if(!c||l)return!1;var d="custom"===this.instance.requestRouter.region&&this.instance.config.advanced_disable_toolbar_metrics,h=W(W({token:this.instance.config.token},t),{},{apiURL:this.instance.requestRouter.endpointFor("ui")},d?{instrument:!1}:{});return(c.localStorage.setItem(tZ,JSON.stringify(W(W({},h),{},{source:void 0}))),this.getToolbarState()===tX.LOADED)?this._callLoadToolbar(h):this.getToolbarState()===tX.UNINITIALIZED&&(this.setToolbarState(tX.LOADING),null===(s=x.__PosthogExtensions__)||void 0===s||null===(a=s.loadExternalDependency)||void 0===a||a.call(s,this.instance,"toolbar",t=>{if(t)return t0.error("[Toolbar] Failed to load",t),void this.setToolbarState(tX.UNINITIALIZED);this.setToolbarState(tX.LOADED),this._callLoadToolbar(h)}),ae(c,"turbolinks:load",()=>{this.setToolbarState(tX.UNINITIALIZED),this.loadToolbar(h)})),!0}_loadEditor(t){return this.loadToolbar(t)}maybeLoadEditor(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return this.maybeLoadToolbar(t,s,a)}};var t1=ec("[TracingHeaders]");let Pr=class Pr{constructor(t){V(this,"_restoreXHRPatch",void 0),V(this,"_restoreFetchPatch",void 0),V(this,"_startCapturing",()=>{var t,s,a,l;F(this._restoreXHRPatch)&&(null===(t=x.__PosthogExtensions__)||void 0===t||null===(s=t.tracingHeadersPatchFns)||void 0===s||s._patchXHR(this.instance.sessionManager)),F(this._restoreFetchPatch)&&(null===(a=x.__PosthogExtensions__)||void 0===a||null===(l=a.tracingHeadersPatchFns)||void 0===l||l._patchFetch(this.instance.sessionManager))}),this.instance=t}_loadScript(t){var s,a,l;null!==(s=x.__PosthogExtensions__)&&void 0!==s&&s.tracingHeadersPatchFns&&t(),null===(a=x.__PosthogExtensions__)||void 0===a||null===(l=a.loadExternalDependency)||void 0===l||l.call(a,this.instance,"tracing-headers",s=>{if(s)return t1.error("failed to load script",s);t()})}startIfEnabledOrStop(){var t,s;this.instance.config.__add_tracing_headers?this._loadScript(this._startCapturing):(null===(t=this._restoreXHRPatch)||void 0===t||t.call(this),null===(s=this._restoreFetchPatch)||void 0===s||s.call(this),this._restoreXHRPatch=void 0,this._restoreFetchPatch=void 0)}};var t2=ec("[Web Vitals]");let Rr=class Rr{constructor(t){var s;V(this,"_enabledServerSide",!1),V(this,"_initialized",!1),V(this,"buffer",{url:void 0,metrics:[],firstMetricTimestamp:void 0}),V(this,"_flushToCapture",()=>{clearTimeout(this._delayedFlushTimer),0!==this.buffer.metrics.length&&(this.instance.capture("$web_vitals",this.buffer.metrics.reduce((t,s)=>W(W({},t),{},{["$web_vitals_".concat(s.name,"_event")]:W({},s),["$web_vitals_".concat(s.name,"_value")]:s.value}),{})),this.buffer={url:void 0,metrics:[],firstMetricTimestamp:void 0})}),V(this,"_addToBuffer",t=>{var s,a=null===(s=this.instance.sessionManager)||void 0===s?void 0:s.checkAndGetSessionAndWindowId(!0);if(F(a))t2.error("Could not read session ID. Dropping metrics!");else{this.buffer=this.buffer||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var l=this._currentURL();F(l)||(O(null==t?void 0:t.name)||O(null==t?void 0:t.value)?t2.error("Invalid metric received",t):this._maxAllowedValue&&t.value>=this._maxAllowedValue?t2.error("Ignoring metric with value >= "+this._maxAllowedValue,t):(this.buffer.url!==l&&(this._flushToCapture(),this._delayedFlushTimer=setTimeout(this._flushToCapture,this.flushToCaptureTimeoutMs)),F(this.buffer.url)&&(this.buffer.url=l),this.buffer.firstMetricTimestamp=F(this.buffer.firstMetricTimestamp)?Date.now():this.buffer.firstMetricTimestamp,t.attribution&&t.attribution.interactionTargetElement&&(t.attribution.interactionTargetElement=void 0),this.buffer.metrics.push(W(W({},t),{},{$current_url:l,$session_id:a.sessionId,$window_id:a.windowId,timestamp:Date.now()})),this.buffer.metrics.length===this.allowedMetrics.length&&this._flushToCapture()))}}),V(this,"_startCapturing",()=>{var t,s,a,l,c=x.__PosthogExtensions__;F(c)||F(c.postHogWebVitalsCallbacks)||({onLCP:t,onCLS:s,onFCP:a,onINP:l}=c.postHogWebVitalsCallbacks),t&&s&&a&&l?(this.allowedMetrics.indexOf("LCP")>-1&&t(this._addToBuffer.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&s(this._addToBuffer.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&a(this._addToBuffer.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&l(this._addToBuffer.bind(this)),this._initialized=!0):t2.error("web vitals callbacks not loaded - not starting")}),this.instance=t,this._enabledServerSide=!(null===(s=this.instance.persistence)||void 0===s||!s.props[ey]),this.startIfEnabled()}get allowedMetrics(){var t,s,a=P(this.instance.config.capture_performance)?null===(t=this.instance.config.capture_performance)||void 0===t?void 0:t.web_vitals_allowed_metrics:void 0;return F(a)?(null===(s=this.instance.persistence)||void 0===s?void 0:s.props[ew])||["CLS","FCP","INP","LCP"]:a}get flushToCaptureTimeoutMs(){return(P(this.instance.config.capture_performance)?this.instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get _maxAllowedValue(){var t=P(this.instance.config.capture_performance)&&M(this.instance.config.capture_performance.__web_vitals_max_value)?this.instance.config.capture_performance.__web_vitals_max_value:9e5;return 0<t&&t<=6e4?9e5:t}get isEnabled(){var t=P(this.instance.config.capture_performance)?this.instance.config.capture_performance.web_vitals:void 0;return A(t)?t:this._enabledServerSide}startIfEnabled(){this.isEnabled&&!this._initialized&&(t2.info("enabled, starting..."),this.loadScript(this._startCapturing))}onRemoteConfig(t){var s=P(t.capturePerformance)&&!!t.capturePerformance.web_vitals,a=P(t.capturePerformance)?t.capturePerformance.web_vitals_allowed_metrics:void 0;this.instance.persistence&&(this.instance.persistence.register({[ey]:s}),this.instance.persistence.register({[ew]:a})),this._enabledServerSide=s,this.startIfEnabled()}loadScript(t){var s,a,l;null!==(s=x.__PosthogExtensions__)&&void 0!==s&&s.postHogWebVitalsCallbacks&&t(),null===(a=x.__PosthogExtensions__)||void 0===a||null===(l=a.loadExternalDependency)||void 0===l||l.call(a,this.instance,"web-vitals",s=>{s?t2.error("failed to load script",s):t()})}_currentURL(){var t=c?c.location.href:void 0;return t||t2.error("Could not determine current URL"),t}};var t3=ec("[Heatmaps]");function $r(t){return P(t)&&"clientX"in t&&"clientY"in t&&M(t.clientX)&&M(t.clientY)}let Or=class Or{constructor(t){var s;V(this,"rageclicks",new yt),V(this,"_enabledServerSide",!1),V(this,"_initialized",!1),V(this,"_flushInterval",null),this.instance=t,this._enabledServerSide=!(null===(s=this.instance.persistence)||void 0===s||!s.props[ef])}get flushIntervalMilliseconds(){var t=5e3;return P(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(t=this.instance.config.capture_heatmaps.flush_interval_milliseconds),t}get isEnabled(){return F(this.instance.config.capture_heatmaps)?F(this.instance.config.enable_heatmaps)?this._enabledServerSide:this.instance.config.enable_heatmaps:!1!==this.instance.config.capture_heatmaps}startIfEnabled(){if(this.isEnabled)this._initialized||(t3.info("starting..."),this._setupListeners(),this._flushInterval=setInterval(this.flush.bind(this),this.flushIntervalMilliseconds));else{var t,s;clearInterval(null!==(t=this._flushInterval)&&void 0!==t?t:void 0),null===(s=this.deadClicksCapture)||void 0===s||s.stop(),this.getAndClearBuffer()}}onRemoteConfig(t){var s=!!t.heatmaps;this.instance.persistence&&this.instance.persistence.register({[ef]:s}),this._enabledServerSide=s,this.startIfEnabled()}getAndClearBuffer(){var t=this.buffer;return this.buffer=void 0,t}_onDeadClick(t){this._onClick(t.originalEvent,"deadclick")}_setupListeners(){c&&v&&(ae(c,"beforeunload",this.flush.bind(this)),ae(v,"click",t=>this._onClick(t||(null==c?void 0:c.event)),{capture:!0}),ae(v,"mousemove",t=>this._onMouseMove(t||(null==c?void 0:c.event)),{capture:!0}),this.deadClicksCapture=new si(this.instance,ii,this._onDeadClick.bind(this)),this.deadClicksCapture.startIfEnabled(),this._initialized=!0)}_getProperties(t,s){var a=this.instance.scrollManager.scrollY(),l=this.instance.scrollManager.scrollX(),d=this.instance.scrollManager.scrollElement(),h=function(t,s,a){for(var l=t;l&&Ve(l)&&!Ge(l,"body")&&l!==a;){if(m(s,null==c?void 0:c.getComputedStyle(l).position))return!0;l=rt(l)}return!1}(tt(t),["fixed","sticky"],d);return{x:t.clientX+(h?0:l),y:t.clientY+(h?0:a),target_fixed:h,type:s}}_onClick(t){var s,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"click";if(!We(t.target)&&$r(t)){var l=this._getProperties(t,a);null!==(s=this.rageclicks)&&void 0!==s&&s.isRageClick(t.clientX,t.clientY,(new Date).getTime())&&this._capture(W(W({},l),{},{type:"rageclick"})),this._capture(l)}}_onMouseMove(t){!We(t.target)&&$r(t)&&(clearTimeout(this._mouseMoveTimeout),this._mouseMoveTimeout=setTimeout(()=>{this._capture(this._getProperties(t,"mousemove"))},500))}_capture(t){if(c){var s=c.location.href;this.buffer=this.buffer||{},this.buffer[s]||(this.buffer[s]=[]),this.buffer[s].push(t)}}flush(){this.buffer&&!C(this.buffer)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}};let Mr=class Mr{constructor(t){this._instance=t}doPageView(t,s){var a,l=this._previousPageViewProperties(t,s);return this._currentPageview={pathname:null!==(a=null==c?void 0:c.location.pathname)&&void 0!==a?a:"",pageViewId:s,timestamp:t},this._instance.scrollManager.resetContext(),l}doPageLeave(t){var s;return this._previousPageViewProperties(t,null===(s=this._currentPageview)||void 0===s?void 0:s.pageViewId)}doEvent(){var t;return{$pageview_id:null===(t=this._currentPageview)||void 0===t?void 0:t.pageViewId}}_previousPageViewProperties(t,s){var a=this._currentPageview;if(!a)return{$pageview_id:s};var l={$pageview_id:s,$prev_pageview_id:a.pageViewId},c=this._instance.scrollManager.getContext();if(c&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:d,lastScrollY:h,maxScrollY:_,maxContentHeight:p,lastContentY:g,maxContentY:v}=c;if(!(F(d)||F(h)||F(_)||F(p)||F(g)||F(v))){d=Math.ceil(d),h=Math.ceil(h),_=Math.ceil(_),p=Math.ceil(p),g=Math.ceil(g),v=Math.ceil(v);var f=d<=1?1:bi(h/d,0,1),w=d<=1?1:bi(_/d,0,1),S=p<=1?1:bi(g/p,0,1),k=p<=1?1:bi(v/p,0,1);l=X(l,{$prev_pageview_last_scroll:h,$prev_pageview_last_scroll_percentage:f,$prev_pageview_max_scroll:_,$prev_pageview_max_scroll_percentage:w,$prev_pageview_last_content:g,$prev_pageview_last_content_percentage:S,$prev_pageview_max_content:v,$prev_pageview_max_content_percentage:k})}}return a.pathname&&(l.$prev_pageview_pathname=a.pathname),a.timestamp&&(l.$prev_pageview_duration=(t.getTime()-a.timestamp.getTime())/1e3),l}};let Ar=class Ar{constructor(t){this.instance=t}sendExceptionEvent(t){this.instance.capture("$exception",t,{_noTruncate:!0,_batchKey:"exceptionEvent"})}};var t5,t6,t4=ec("[FeatureFlags]"),t8="$active_feature_flags",t7="$override_feature_flags",t9="$feature_flag_payloads",it="$override_feature_flag_payloads",Ur=t=>{var s={};for(var[a,l]of Z(t||{}))l&&(s[a]=l);return s};(i5=t6||(t6={})).FeatureFlags="feature_flags",i5.Recordings="recordings";let zr=class zr{constructor(t){V(this,"_override_warning",!1),V(this,"_hasLoadedFlags",!1),V(this,"_requestInFlight",!1),V(this,"_reloadingDisabled",!1),V(this,"_additionalReloadRequested",!1),V(this,"_decideCalled",!1),V(this,"_flagsLoadedFromRemote",!1),this.instance=t,this.featureFlagEventHandlers=[]}decide(){if(this.instance.config.__preview_remote_config)this._decideCalled=!0;else{var t=!this._reloadDebouncer&&(this.instance.config.advanced_disable_feature_flags||this.instance.config.advanced_disable_feature_flags_on_first_load);this._callDecideEndpoint({disableFlags:t})}}get hasLoadedFlags(){return this._hasLoadedFlags}getFlags(){return Object.keys(this.getFlagVariants())}getFlagVariants(){var t=this.instance.get_property(eO),s=this.instance.get_property(t7);if(!s)return t||{};for(var a=X({},t),l=Object.keys(s),c=0;c<l.length;c++)a[l[c]]=s[l[c]];return this._override_warning||(t4.warn(" Overriding feature flags!",{enabledFlags:t,overriddenFlags:s,finalFlags:a}),this._override_warning=!0),a}getFlagPayloads(){var t=this.instance.get_property(t9),s=this.instance.get_property(it);if(!s)return t||{};for(var a=X({},t||{}),l=Object.keys(s),c=0;c<l.length;c++)a[l[c]]=s[l[c]];return this._override_warning||(t4.warn(" Overriding feature flag payloads!",{flagPayloads:t,overriddenPayloads:s,finalPayloads:a}),this._override_warning=!0),a}reloadFeatureFlags(){this._reloadingDisabled||this.instance.config.advanced_disable_feature_flags||this._reloadDebouncer||(this._reloadDebouncer=setTimeout(()=>{this._callDecideEndpoint()},5))}clearDebouncer(){clearTimeout(this._reloadDebouncer),this._reloadDebouncer=void 0}ensureFlagsLoaded(){this._hasLoadedFlags||this._requestInFlight||this._reloadDebouncer||this.reloadFeatureFlags()}setAnonymousDistinctId(t){this.$anon_distinct_id=t}setReloadingPaused(t){this._reloadingDisabled=t}_callDecideEndpoint(t){if(this.clearDebouncer(),!this.instance.config.advanced_disable_decide){if(this._requestInFlight)this._additionalReloadRequested=!0;else{var s={token:this.instance.config.token,distinct_id:this.instance.get_distinct_id(),groups:this.instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:this.instance.get_property(eA),group_properties:this.instance.get_property(eL)};(null!=t&&t.disableFlags||this.instance.config.advanced_disable_feature_flags)&&(s.disable_flags=!0),this._requestInFlight=!0,this.instance._send_request({method:"POST",url:this.instance.requestRouter.endpointFor("api","/decide/?v=3"),data:s,compression:this.instance.config.disable_compression?void 0:l.Base64,timeout:this.instance.config.feature_flag_request_timeout_ms,callback:t=>{var a,l,c,d=!0;200===t.statusCode&&(this.$anon_distinct_id=void 0,d=!1),this._requestInFlight=!1,this._decideCalled||(this._decideCalled=!0,this.instance._onRemoteConfig(null!==(c=t.json)&&void 0!==c?c:{})),s.disable_flags||(this._flagsLoadedFromRemote=!d,t.json&&null!==(a=t.json.quotaLimited)&&void 0!==a&&a.includes(t6.FeatureFlags)?t4.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more."):(this.receivedFeatureFlags(null!==(l=t.json)&&void 0!==l?l:{},d),this._additionalReloadRequested&&(this._additionalReloadRequested=!1,this._callDecideEndpoint())))}})}}}getFeatureFlag(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._hasLoadedFlags||this.getFlags()&&this.getFlags().length>0){var a,l,c,d,h,_=this.getFlagVariants()[t],p="".concat(_),g=this.instance.get_property(eW)||{};return!s.send_event&&"send_event"in s||t in g&&g[t].includes(p)||(ea(g[t])?g[t].push(p):g[t]=[p],null===(a=this.instance.persistence)||void 0===a||a.register({[eW]:g}),this.instance.capture("$feature_flag_called",{$feature_flag:t,$feature_flag_response:_,$feature_flag_payload:this.getFeatureFlagPayload(t)||null,$feature_flag_bootstrapped_response:(null===(l=this.instance.config.bootstrap)||void 0===l||null===(c=l.featureFlags)||void 0===c?void 0:c[t])||null,$feature_flag_bootstrapped_payload:(null===(d=this.instance.config.bootstrap)||void 0===d||null===(h=d.featureFlagPayloads)||void 0===h?void 0:h[t])||null,$used_bootstrap_value:!this._flagsLoadedFromRemote})),_}t4.warn('getFeatureFlag for key "'+t+"\" failed. Feature flags didn't load in time.")}getFeatureFlagPayload(t){return this.getFlagPayloads()[t]}getRemoteConfigPayload(t,s){var a=this.instance.config.token;this.instance._send_request({method:"POST",url:this.instance.requestRouter.endpointFor("api","/decide/?v=3"),data:{distinct_id:this.instance.get_distinct_id(),token:a},compression:this.instance.config.disable_compression?void 0:l.Base64,timeout:this.instance.config.feature_flag_request_timeout_ms,callback:a=>{var l,c=null===(l=a.json)||void 0===l?void 0:l.featureFlagPayloads;s((null==c?void 0:c[t])||void 0)}})}isFeatureEnabled(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._hasLoadedFlags||this.getFlags()&&this.getFlags().length>0)return!!this.getFeatureFlag(t,s);t4.warn('isFeatureEnabled for key "'+t+"\" failed. Feature flags didn't load in time.")}addFeatureFlagsHandler(t){this.featureFlagEventHandlers.push(t)}removeFeatureFlagsHandler(t){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter(s=>s!==t)}receivedFeatureFlags(t,s){if(this.instance.persistence){this._hasLoadedFlags=!0;var a=this.getFlagVariants(),l=this.getFlagPayloads();!function(t,s){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=t.featureFlags,d=t.featureFlagPayloads;if(c){if(ea(c)){var h={};if(c)for(var _=0;_<c.length;_++)h[c[_]]=!0;s&&s.register({[t8]:c,[eO]:h})}else{var p=c,g=d;t.errorsWhileComputingFlags&&(p=W(W({},a),p),g=W(W({},l),g)),s&&s.register({[t8]:Object.keys(Ur(p)),[eO]:p||{},[t9]:g||{}})}}}(t,this.instance.persistence,a,l),this._fireFeatureFlagsCallbacks(s)}}override(t){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t4.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:t,suppressWarning:s})}overrideFeatureFlags(t){if(!this.instance.__loaded||!this.instance.persistence)return t4.uninitializedWarning("posthog.feature_flags.overrideFeatureFlags");if(!1===t)return this.instance.persistence.unregister(t7),this.instance.persistence.unregister(it),void this._fireFeatureFlagsCallbacks();if(t&&"object"==typeof t&&("flags"in t||"payloads"in t)){var s;if(this._override_warning=!!(null!==(s=t.suppressWarning)&&void 0!==s&&s),"flags"in t){if(!1===t.flags)this.instance.persistence.unregister(t7);else if(t.flags){if(ea(t.flags)){for(var a={},l=0;l<t.flags.length;l++)a[t.flags[l]]=!0;this.instance.persistence.register({[t7]:a})}else this.instance.persistence.register({[t7]:t.flags})}}return"payloads"in t&&(!1===t.payloads?this.instance.persistence.unregister(it):t.payloads&&this.instance.persistence.register({[it]:t.payloads})),void this._fireFeatureFlagsCallbacks()}this._fireFeatureFlagsCallbacks()}onFeatureFlags(t){if(this.addFeatureFlagsHandler(t),this._hasLoadedFlags){var{flags:s,flagVariants:a}=this._prepareFeatureFlagsForCallbacks();t(s,a)}return()=>this.removeFeatureFlagsHandler(t)}updateEarlyAccessFeatureEnrollment(t,s){var a,l=(this.instance.get_property(eM)||[]).find(s=>s.flagKey===t),c={["$feature_enrollment/".concat(t)]:s},d={$feature_flag:t,$feature_enrollment:s,$set:c};l&&(d.$early_access_feature_name=l.name),this.instance.capture("$feature_enrollment_update",d),this.setPersonPropertiesForFlags(c,!1);var h=W(W({},this.getFlagVariants()),{},{[t]:s});null===(a=this.instance.persistence)||void 0===a||a.register({[t8]:Object.keys(Ur(h)),[eO]:h}),this._fireFeatureFlagsCallbacks()}getEarlyAccessFeatures(t){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.instance.get_property(eM);if(a&&!s)return t(a);this.instance._send_request({url:this.instance.requestRouter.endpointFor("api","/api/early_access_features/?token=".concat(this.instance.config.token)),method:"GET",callback:s=>{var a;if(s.json){var l=s.json.earlyAccessFeatures;return null===(a=this.instance.persistence)||void 0===a||a.register({[eM]:l}),t(l)}}})}_prepareFeatureFlagsForCallbacks(){var t=this.getFlags(),s=this.getFlagVariants();return{flags:t.filter(t=>s[t]),flagVariants:Object.keys(s).filter(t=>s[t]).reduce((t,a)=>(t[a]=s[a],t),{})}}_fireFeatureFlagsCallbacks(t){var{flags:s,flagVariants:a}=this._prepareFeatureFlagsForCallbacks();this.featureFlagEventHandlers.forEach(l=>l(s,a,{errorsLoading:t}))}setPersonPropertiesForFlags(t){var s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=this.instance.get_property(eA)||{};this.instance.register({[eA]:W(W({},a),t)}),s&&this.instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this.instance.unregister(eA)}setGroupPropertiesForFlags(t){var s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=this.instance.get_property(eL)||{};0!==Object.keys(a).length&&Object.keys(a).forEach(s=>{a[s]=W(W({},a[s]),t[s]),delete t[s]}),this.instance.register({[eL]:W(W({},a),t)}),s&&this.instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(t){if(t){var s=this.instance.get_property(eL)||{};this.instance.register({[eL]:W(W({},s),{},{[t]:{}})})}else this.instance.unregister(eL)}};var is="Mobile",ia="Android",il="Tablet",ic=ia+" "+il,iu="iPad",id="Apple",ih=id+" Watch",i_="Safari",ip="BlackBerry",ig="Samsung",iv=ig+"Browser",im=ig+" Internet",iy="Chrome",ib=iy+" OS",iw=iy+" iOS",iS="Internet Explorer",ik=iS+" "+is,iE="Opera",iF=iE+" Mini",ix="Edge",iI="Microsoft "+ix,iP="Firefox",iC=iP+" iOS",iR="Nintendo",iT="PlayStation",i$="Xbox",iO=ia+" "+is,iM=is+" "+i_,iA="Windows",iL=iA+" Phone",iD="Nokia",iq="Ouya",iW="Generic",iN=iW+" "+is.toLowerCase(),iV=iW+" "+il.toLowerCase(),iB="Konqueror",iH="(\\d+(\\.\\d+)?)",iz=RegExp("Version/"+iH),iU=RegExp(i$,"i"),ij=RegExp(iT+" \\w+","i"),iG=RegExp(iR+" \\w+","i"),iK=RegExp(ip+"|PlayBook|BB10","i"),iY={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},Ms=(t,s)=>s&&m(s,id)||m(t,i_)&&!m(t,iy)&&!m(t,ia),As=function(t,s){return s=s||"",m(t," OPR/")&&m(t,"Mini")?iF:m(t," OPR/")?iE:iK.test(t)?ip:m(t,"IE"+is)||m(t,"WPDesktop")?ik:m(t,iv)?im:m(t,ix)||m(t,"Edg/")?iI:m(t,"FBIOS")?"Facebook "+is:m(t,"UCWEB")||m(t,"UCBrowser")?"UC Browser":m(t,"CriOS")?iw:m(t,"CrMo")||m(t,iy)?iy:m(t,ia)&&m(t,i_)?iO:m(t,"FxiOS")?iC:m(t.toLowerCase(),iB.toLowerCase())?iB:Ms(t,s)?m(t,is)?iM:i_:m(t,iP)?iP:m(t,"MSIE")||m(t,"Trident/")?iS:m(t,"Gecko")?iP:""},iJ={[ik]:[RegExp("rv:"+iH)],[iI]:[RegExp(ix+"?\\/"+iH)],[iy]:[RegExp("("+iy+"|CrMo)\\/"+iH)],[iw]:[RegExp("CriOS\\/"+iH)],"UC Browser":[RegExp("(UCBrowser|UCWEB)\\/"+iH)],[i_]:[iz],[iM]:[iz],[iE]:[RegExp("(Opera|OPR)\\/"+iH)],[iP]:[RegExp(iP+"\\/"+iH)],[iC]:[RegExp("FxiOS\\/"+iH)],[iB]:[RegExp("Konqueror[:/]?"+iH,"i")],[ip]:[RegExp(ip+" "+iH),iz],[iO]:[RegExp("android\\s"+iH,"i")],[im]:[RegExp(iv+"\\/"+iH)],[iS]:[RegExp("(rv:|MSIE )"+iH)],Mozilla:[RegExp("rv:"+iH)]},iX=[[RegExp(i$+"; "+i$+" (.*?)[);]","i"),t=>[i$,t&&t[1]||""]],[RegExp(iR,"i"),[iR,""]],[RegExp(iT,"i"),[iT,""]],[iK,[ip,""]],[RegExp(iA,"i"),(t,s)=>{if(/Phone/.test(s)||/WPDesktop/.test(s))return[iL,""];if(new RegExp(is).test(s)&&!/IEMobile\b/.test(s))return[iA+" "+is,""];var a=/Windows NT ([0-9.]+)/i.exec(s);if(a&&a[1]){var l=iY[a[1]]||"";return/arm/i.test(s)&&(l="RT"),[iA,l]}return[iA,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,t=>t&&t[3]?["iOS",[t[3],t[4],t[5]||"0"].join(".")]:["iOS",""]],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,t=>{var s="";return t&&t.length>=3&&(s=F(t[2])?t[3]:t[2]),["watchOS",s]}],[RegExp("("+ia+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+ia+")","i"),t=>t&&t[2]?[ia,[t[2],t[3],t[4]||"0"].join(".")]:[ia,""]],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,t=>{var s=["Mac OS X",""];if(t&&t[1]){var a=[t[1],t[2],t[3]||"0"];s[1]=a.join(".")}return s}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[ib,""]],[/Linux|debian/i,["Linux",""]]],qs=function(t){return iG.test(t)?iR:ij.test(t)?iT:iU.test(t)?i$:RegExp(iq,"i").test(t)?iq:RegExp("("+iL+"|WPDesktop)","i").test(t)?iL:/iPad/.test(t)?iu:/iPod/.test(t)?"iPod Touch":/iPhone/.test(t)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(t)?ih:iK.test(t)?ip:/(kobo)\s(ereader|touch)/i.test(t)?"Kobo":RegExp(iD,"i").test(t)?iD:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(t)||/(kf[a-z]+)( bui|\)).+silk\//i.test(t)?"Kindle Fire":/(Android|ZTE)/i.test(t)?!new RegExp(is).test(t)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(t)?/pixel[\daxl ]{1,6}/i.test(t)&&!/pixel c/i.test(t)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(t)||/lmy47v/i.test(t)&&!/QTAQZ3/i.test(t)?ia:ic:ia:RegExp("(pda|"+is+")","i").test(t)?iN:RegExp(il,"i").test(t)&&!RegExp(il+" pc","i").test(t)?iV:""},iQ="https?://(.*)",iZ=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","irclid","_kx"],i0=Q(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],iZ),i1="<masked>",i2={campaignParams:function(){var{customTrackedParams:t,maskPersonalDataProperties:s,customPersonalDataProperties:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!v)return{};var l=s?Q([],iZ,a||[]):[];return this._campaignParamsFromUrl(Et(v.URL,l,i1),t)},_campaignParamsFromUrl:function(t,s){var a=i0.concat(s||[]),l={};return K(a,function(s){var a=kt(t,s);l[s]=a||null}),l},_searchEngine:function(t){return t?0===t.search(iQ+"google.([^/?]*)")?"google":0===t.search(iQ+"bing.com")?"bing":0===t.search(iQ+"yahoo.com")?"yahoo":0===t.search(iQ+"duckduckgo.com")?"duckduckgo":null:null},_searchInfoFromReferrer:function(t){var s=i2._searchEngine(t),a="yahoo"!=s?"q":"p",l={};if(!$(s)){l.$search_engine=s;var c=v?kt(v.referrer,a):"";c.length&&(l.ph_keyword=c)}return l},searchInfo:function(){var t=null==v?void 0:v.referrer;return t?this._searchInfoFromReferrer(t):{}},browser:As,browserVersion:function(t,s){var a=iJ[As(t,s)];if(F(a))return null;for(var l=0;l<a.length;l++){var c=a[l],d=t.match(c);if(d)return parseFloat(d[d.length-2])}return null},browserLanguage:function(){return navigator.language||navigator.userLanguage},browserLanguagePrefix:function(){var t=this.browserLanguage();return"string"==typeof t?t.split("-")[0]:void 0},os:function(t){for(var s=0;s<iX.length;s++){var[a,l]=iX[s],c=a.exec(t),d=c&&(I(l)?l(c,t):l);if(d)return d}return["",""]},device:qs,deviceType:function(t){var s=qs(t);return s===iu||s===ic||"Kobo"===s||"Kindle Fire"===s||s===iV?il:s===iR||s===i$||s===iT||s===iq?"Console":s===ih?"Wearable":s?is:"Desktop"},referrer:function(){return(null==v?void 0:v.referrer)||"$direct"},referringDomain:function(){var t;return null!=v&&v.referrer&&(null===(t=wt(v.referrer))||void 0===t?void 0:t.host)||"$direct"},referrerInfo:function(){return{$referrer:this.referrer(),$referring_domain:this.referringDomain()}},personInfo:function(){var{maskPersonalDataProperties:t,customPersonalDataProperties:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t?Q([],iZ,s||[]):[],l=null==f?void 0:f.href.substring(0,1e3);return{r:this.referrer().substring(0,1e3),u:l?Et(l,a,i1):void 0}},personPropsFromInfo:function(t){var s,{r:a,u:l}=t,c={$referrer:a,$referring_domain:null==a?void 0:"$direct"==a?"$direct":null===(s=wt(a))||void 0===s?void 0:s.host};if(l){c.$current_url=l;var d=wt(l);c.$host=null==d?void 0:d.host,c.$pathname=null==d?void 0:d.pathname,X(c,this._campaignParamsFromUrl(l))}return a&&X(c,this._searchInfoFromReferrer(a)),c},initialPersonPropsFromInfo:function(t){var s=this.personPropsFromInfo(t),a={};return K(s,function(t,s){a["$initial_".concat(b(s))]=t}),a},timezone:function(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(t){return}},timezoneOffset:function(){try{return(new Date).getTimezoneOffset()}catch(t){return}},properties:function(){var{maskPersonalDataProperties:t,customPersonalDataProperties:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!E)return{};var a=t?Q([],iZ,s||[]):[],[l,d]=i2.os(E);return X(ie({$os:l,$os_version:d,$browser:i2.browser(E,navigator.vendor),$device:i2.device(E),$device_type:i2.deviceType(E),$timezone:i2.timezone(),$timezone_offset:i2.timezoneOffset()}),{$current_url:Et(null==f?void 0:f.href,a,i1),$host:null==f?void 0:f.host,$pathname:null==f?void 0:f.pathname,$raw_user_agent:E.length>1e3?E.substring(0,997)+"...":E,$browser_version:i2.browserVersion(E,navigator.vendor),$browser_language:i2.browserLanguage(),$browser_language_prefix:i2.browserLanguagePrefix(),$screen_height:null==c?void 0:c.screen.height,$screen_width:null==c?void 0:c.screen.width,$viewport_height:null==c?void 0:c.innerHeight,$viewport_width:null==c?void 0:c.innerWidth,$lib:"web",$lib_version:B.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})},people_properties:function(){if(!E)return{};var[t,s]=i2.os(E);return X(ie({$os:t,$os_version:s,$browser:i2.browser(E,navigator.vendor)}),{$browser_version:i2.browserVersion(E,navigator.vendor)})}},i3=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];let Ws=class Ws{constructor(t){var s;this.config=t,this.props={},this.campaign_params_saved=!1,this.name=(s="",t.token&&(s=t.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),t.persistence_name?"ph_"+t.persistence_name:"ph_"+s+"_posthog"),this.storage=this.buildStorage(t),this.load(),t.debug&&el.info("Persistence loaded",t.persistence,W({},this.props)),this.update_config(t,t),this.save()}buildStorage(t){-1===i3.indexOf(t.persistence.toLowerCase())&&(el.critical("Unknown persistence type "+t.persistence+"; falling back to localStorage+cookie"),t.persistence="localStorage+cookie");var s=t.persistence.toLowerCase();return"localstorage"===s&&ta.is_supported()?ta:"localstorage+cookie"===s&&tc.is_supported()?tc:"sessionstorage"===s&&t_.is_supported()?t_:"memory"===s?td:"cookie"===s?ts:tc.is_supported()?tc:ts}properties(){var t={};return K(this.props,function(s,a){if(a===eO&&P(s))for(var l,c=Object.keys(s),d=0;d<c.length;d++)t["$feature/".concat(c[d])]=s[c[d]];else l=!1,($(eY)?l:p&&eY.indexOf===p?-1!=eY.indexOf(a):(K(eY,function(t){if(l||(l=t===a))return ed}),l))||(t[a]=s)}),t}load(){if(!this.disabled){var t=this.storage.parse(this.name);t&&(this.props=X({},t))}}save(){this.disabled||this.storage.set(this.name,this.props,this.expire_days,this.cross_subdomain,this.secure,this.config.debug)}remove(){this.storage.remove(this.name,!1),this.storage.remove(this.name,!0)}clear(){this.remove(),this.props={}}register_once(t,s,a){if(P(t)){F(s)&&(s="None"),this.expire_days=F(a)?this.default_expiry:a;var l=!1;if(K(t,(t,a)=>{this.props.hasOwnProperty(a)&&this.props[a]!==s||(this.props[a]=t,l=!0)}),l)return this.save(),!0}return!1}register(t,s){if(P(t)){this.expire_days=F(s)?this.default_expiry:s;var a=!1;if(K(t,(s,l)=>{t.hasOwnProperty(l)&&this.props[l]!==s&&(this.props[l]=s,a=!0)}),a)return this.save(),!0}return!1}unregister(t){t in this.props&&(delete this.props[t],this.save())}update_campaign_params(){if(!this.campaign_params_saved){var t=i2.campaignParams({customTrackedParams:this.config.custom_campaign_params,maskPersonalDataProperties:this.config.mask_personal_data_properties,customPersonalDataProperties:this.config.custom_personal_data_properties});C(ie(t))||this.register(t),this.campaign_params_saved=!0}}update_search_keyword(){this.register(i2.searchInfo())}update_referrer_info(){this.register_once(i2.referrerInfo(),void 0)}set_initial_person_info(){this.props[eH]||this.props[ez]||this.register_once({[eU]:i2.personInfo({maskPersonalDataProperties:this.config.mask_personal_data_properties,customPersonalDataProperties:this.config.custom_personal_data_properties})},void 0)}get_referrer_info(){return ie({$referrer:this.props.$referrer,$referring_domain:this.props.$referring_domain})}get_initial_props(){var t={};K([ez,eH],s=>{var a=this.props[s];a&&K(a,function(s,a){t["$initial_"+b(a)]=s})});var s=this.props[eU];return s&&X(t,i2.initialPersonPropsFromInfo(s)),t}safe_merge(t){return K(this.props,function(s,a){a in t||(t[a]=s)}),t}update_config(t,s){if(this.default_expiry=this.expire_days=t.cookie_expiration,this.set_disabled(t.disable_persistence),this.set_cross_subdomain(t.cross_subdomain_cookie),this.set_secure(t.secure_cookie),t.persistence!==s.persistence){var a=this.buildStorage(t),l=this.props;this.clear(),this.storage=a,this.props=l,this.save()}}set_disabled(t){this.disabled=t,this.disabled?this.remove():this.save()}set_cross_subdomain(t){t!==this.cross_subdomain&&(this.cross_subdomain=t,this.remove(),this.save())}get_cross_subdomain(){return!!this.cross_subdomain}set_secure(t){t!==this.secure&&(this.secure=t,this.remove(),this.save())}set_event_timer(t,s){var a=this.props[eg]||{};a[t]=s,this.props[eg]=a,this.save()}remove_event_timer(t){var s=(this.props[eg]||{})[t];return F(s)||(delete this.props[eg][t],this.save()),s}get_property(t){return this.props[t]}set_property(t,s){this.props[t]=s,this.save()}};var i5,i6,i4,i8,i7,i9,se,st,ss,sn,so,sa,sl,sc={},su=[],sd=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,sh=Array.isArray;function cn(t,s){for(var a in s)t[a]=s[a];return t}function un(t){var s=t.parentNode;s&&s.removeChild(t)}function dn(t,s,a,l,c){var d={type:t,props:s,key:a,ref:l,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:null==c?++i8:c,__i:-1,__u:0};return null==c&&null!=i4.vnode&&i4.vnode(d),d}function hn(t){return t.children}function _n(t,s){this.props=t,this.context=s}function pn(t,s){if(null==s)return t.__?pn(t.__,t.__i+1):null;for(var a;s<t.__k.length;s++)if(null!=(a=t.__k[s])&&null!=a.__e)return a.__e;return"function"==typeof t.type?pn(t):null}function vn(t){(!t.__d&&(t.__d=!0)&&i7.push(t)&&!fn.__r++||i9!==i4.debounceRendering)&&((i9=i4.debounceRendering)||se)(fn)}function fn(){var t,s,a,l,c,d,h,_,p;for(i7.sort(st);t=i7.shift();)t.__d&&(s=i7.length,l=void 0,d=(c=(a=t).__v).__e,_=[],p=[],(h=a.__P)&&((l=cn({},c)).__v=c.__v+1,i4.vnode&&i4.vnode(l),In(h,l,c,a.__n,void 0!==h.ownerSVGElement,32&c.__u?[d]:null,_,null==d?pn(c):d,!!(32&c.__u),p),l.__.__k[l.__i]=l,function(t,s,a){s.__d=void 0;for(var l=0;l<a.length;l++)Fn(a[l],a[++l],a[++l]);i4.__c&&i4.__c(s,t),t.some(function(s){try{t=s.__h,s.__h=[],t.some(function(t){t.call(s)})}catch(t){i4.__e(t,s.__v)}})}(_,l,p),l.__e!=d&&function gn(t){var s,a;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,s=0;s<t.__k.length;s++)if(null!=(a=t.__k[s])&&null!=a.__e){t.__e=t.__c.base=a.__e;break}return gn(t)}}(l)),i7.length>s&&i7.sort(st));fn.__r=0}function mn(t,s,a,l,c,d,h,_,p,g,v){var f,w,S,k,E,x=l&&l.__k||su,B=s.length;for(a.__d=p,function(t,s,a){var l,c,d,h,_,p=s.length,g=a.length,v=g,f=0;for(t.__k=[],l=0;l<p;l++)null!=(c=t.__k[l]=null==(c=s[l])||"boolean"==typeof c||"function"==typeof c?null:"string"==typeof c||"number"==typeof c||"bigint"==typeof c||c.constructor==String?dn(null,c,null,null,c):sh(c)?dn(hn,{children:c},null,null,null):void 0===c.constructor&&c.__b>0?dn(c.type,c.props,c.key,c.ref?c.ref:null,c.__v):c)?(c.__=t,c.__b=t.__b+1,_=function(t,s,a,l){var c=t.key,d=t.type,h=a-1,_=a+1,p=s[a];if(null===p||p&&c==p.key&&d===p.type)return a;if(l>(null!=p&&0==(131072&p.__u)?1:0))for(;h>=0||_<s.length;){if(h>=0){if((p=s[h])&&0==(131072&p.__u)&&c==p.key&&d===p.type)return h;h--}if(_<s.length){if((p=s[_])&&0==(131072&p.__u)&&c==p.key&&d===p.type)return _;_++}}return -1}(c,a,h=l+f,v),c.__i=_,d=null,-1!==_&&(v--,(d=a[_])&&(d.__u|=131072)),null==d||null===d.__v?(-1==_&&f--,"function"!=typeof c.type&&(c.__u|=65536)):_!==h&&(_===h+1?f++:_>h?v>p-h?f+=_-h:f--:f=_<h&&_==h-1?_-h:0,_!==l+f&&(c.__u|=65536))):(d=a[l])&&null==d.key&&d.__e&&(d.__e==t.__d&&(t.__d=pn(d)),Rn(d,d,!1),a[l]=null,v--);if(v)for(l=0;l<g;l++)null!=(d=a[l])&&0==(131072&d.__u)&&(d.__e==t.__d&&(t.__d=pn(d)),Rn(d,d))}(a,s,x),p=a.__d,f=0;f<B;f++)null!=(S=a.__k[f])&&"boolean"!=typeof S&&"function"!=typeof S&&(w=-1===S.__i?sc:x[S.__i]||sc,S.__i=f,In(t,S,w,c,d,h,_,p,g,v),k=S.__e,S.ref&&w.ref!=S.ref&&(w.ref&&Fn(w.ref,null,S),v.push(S.ref,S.__c||k,S)),null==E&&null!=k&&(E=k),65536&S.__u||w.__k===S.__k?p=function bn(t,s,a){var l,c;if("function"==typeof t.type){for(l=t.__k,c=0;l&&c<l.length;c++)l[c]&&(l[c].__=t,s=bn(l[c],s,a));return s}return t.__e!=s&&(a.insertBefore(t.__e,s||null),s=t.__e),s&&s.nextSibling}(S,p,t):"function"==typeof S.type&&void 0!==S.__d?p=S.__d:k&&(p=k.nextSibling),S.__d=void 0,S.__u&=-196609);a.__d=p,a.__e=E}function Sn(t,s,a){"-"===s[0]?t.setProperty(s,null==a?"":a):t[s]=null==a?"":"number"!=typeof a||sd.test(s)?a:a+"px"}function kn(t,s,a,l,c){var d;e:if("style"===s){if("string"==typeof a)t.style.cssText=a;else{if("string"==typeof l&&(t.style.cssText=l=""),l)for(s in l)a&&s in a||Sn(t.style,s,"");if(a)for(s in a)l&&a[s]===l[s]||Sn(t.style,s,a[s])}}else if("o"===s[0]&&"n"===s[1])d=s!==(s=s.replace(/(PointerCapture)$|Capture$/,"$1")),s=s.toLowerCase() in t?s.toLowerCase().slice(2):s.slice(2),t.l||(t.l={}),t.l[s+d]=a,a?l?a.u=l.u:(a.u=Date.now(),t.addEventListener(s,d?xn:En,d)):t.removeEventListener(s,d?xn:En,d);else{if(c)s=s.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==s&&"height"!==s&&"href"!==s&&"list"!==s&&"form"!==s&&"tabIndex"!==s&&"download"!==s&&"rowSpan"!==s&&"colSpan"!==s&&"role"!==s&&s in t)try{t[s]=null==a?"":a;break e}catch(t){}"function"==typeof a||(null==a||!1===a&&"-"!==s[4]?t.removeAttribute(s):t.setAttribute(s,a))}}function En(t){var s=this.l[t.type+!1];if(t.t){if(t.t<=s.u)return}else t.t=Date.now();return s(i4.event?i4.event(t):t)}function xn(t){return this.l[t.type+!0](i4.event?i4.event(t):t)}function In(t,s,a,l,c,d,h,_,p,g){var v,f,w,S,k,E,x,B,H,U,J,es,er,en,ea,el=s.type;if(void 0!==s.constructor)return null;128&a.__u&&(p=!!(32&a.__u),d=[_=s.__e=a.__e]),(v=i4.__b)&&v(s);e:if("function"==typeof el)try{if(B=s.props,H=(v=el.contextType)&&l[v.__c],U=v?H?H.props.value:v.__:l,a.__c?x=(f=s.__c=a.__c).__=f.__E:("prototype"in el&&el.prototype.render?s.__c=f=new el(B,U):(s.__c=f=new _n(B,U),f.constructor=el,f.render=Tn),H&&H.sub(f),f.props=B,f.state||(f.state={}),f.context=U,f.__n=l,w=f.__d=!0,f.__h=[],f._sb=[]),null==f.__s&&(f.__s=f.state),null!=el.getDerivedStateFromProps&&(f.__s==f.state&&(f.__s=cn({},f.__s)),cn(f.__s,el.getDerivedStateFromProps(B,f.__s))),S=f.props,k=f.state,f.__v=s,w)null==el.getDerivedStateFromProps&&null!=f.componentWillMount&&f.componentWillMount(),null!=f.componentDidMount&&f.__h.push(f.componentDidMount);else{if(null==el.getDerivedStateFromProps&&B!==S&&null!=f.componentWillReceiveProps&&f.componentWillReceiveProps(B,U),!f.__e&&(null!=f.shouldComponentUpdate&&!1===f.shouldComponentUpdate(B,f.__s,U)||s.__v===a.__v)){for(s.__v!==a.__v&&(f.props=B,f.state=f.__s,f.__d=!1),s.__e=a.__e,s.__k=a.__k,s.__k.forEach(function(t){t&&(t.__=s)}),J=0;J<f._sb.length;J++)f.__h.push(f._sb[J]);f._sb=[],f.__h.length&&h.push(f);break e}null!=f.componentWillUpdate&&f.componentWillUpdate(B,f.__s,U),null!=f.componentDidUpdate&&f.__h.push(function(){f.componentDidUpdate(S,k,E)})}if(f.context=U,f.props=B,f.__P=t,f.__e=!1,es=i4.__r,er=0,"prototype"in el&&el.prototype.render){for(f.state=f.__s,f.__d=!1,es&&es(s),v=f.render(f.props,f.state,f.context),en=0;en<f._sb.length;en++)f.__h.push(f._sb[en]);f._sb=[]}else do f.__d=!1,es&&es(s),v=f.render(f.props,f.state,f.context),f.state=f.__s;while(f.__d&&++er<25);f.state=f.__s,null!=f.getChildContext&&(l=cn(cn({},l),f.getChildContext())),w||null==f.getSnapshotBeforeUpdate||(E=f.getSnapshotBeforeUpdate(S,k)),mn(t,sh(ea=null!=v&&v.type===hn&&null==v.key?v.props.children:v)?ea:[ea],s,a,l,c,d,h,_,p,g),f.base=s.__e,s.__u&=-161,f.__h.length&&h.push(f),x&&(f.__E=f.__=null)}catch(t){s.__v=null,p||null!=d?(s.__e=_,s.__u|=p?160:32,d[d.indexOf(_)]=null):(s.__e=a.__e,s.__k=a.__k),i4.__e(t,s,a)}else null==d&&s.__v===a.__v?(s.__k=a.__k,s.__e=a.__e):s.__e=function(t,s,a,l,c,d,h,_,p){var g,v,f,w,S,k,E,x=a.props,B=s.props,H=s.type;if("svg"===H&&(c=!0),null!=d){for(g=0;g<d.length;g++)if((S=d[g])&&"setAttribute"in S==!!H&&(H?S.localName===H:3===S.nodeType)){t=S,d[g]=null;break}}if(null==t){if(null===H)return document.createTextNode(B);t=c?document.createElementNS("http://www.w3.org/2000/svg",H):document.createElement(H,B.is&&B),d=null,_=!1}if(null===H)x===B||_&&t.data===B||(t.data=B);else{if(d=d&&i6.call(t.childNodes),x=a.props||sc,!_&&null!=d)for(x={},g=0;g<t.attributes.length;g++)x[(S=t.attributes[g]).name]=S.value;for(g in x)S=x[g],"children"==g||("dangerouslySetInnerHTML"==g?f=S:"key"===g||g in B||kn(t,g,null,S,c));for(g in B)S=B[g],"children"==g?w=S:"dangerouslySetInnerHTML"==g?v=S:"value"==g?k=S:"checked"==g?E=S:"key"===g||_&&"function"!=typeof S||x[g]===S||kn(t,g,S,x[g],c);if(v)_||f&&(v.__html===f.__html||v.__html===t.innerHTML)||(t.innerHTML=v.__html),s.__k=[];else if(f&&(t.innerHTML=""),mn(t,sh(w)?w:[w],s,a,l,c&&"foreignObject"!==H,d,h,d?d[0]:a.__k&&pn(a,0),_,p),null!=d)for(g=d.length;g--;)null!=d[g]&&un(d[g]);_||(g="value",void 0===k||k===t[g]&&("progress"!==H||k)&&("option"!==H||k===x[g])||kn(t,g,k,x[g],!1),g="checked",void 0!==E&&E!==t[g]&&kn(t,g,E,x[g],!1))}return t}(a.__e,s,a,l,c,d,h,p,g);(v=i4.diffed)&&v(s)}function Fn(t,s,a){try{"function"==typeof t?t(s):t.current=s}catch(t){i4.__e(t,a)}}function Rn(t,s,a){var l,c;if(i4.unmount&&i4.unmount(t),(l=t.ref)&&(l.current&&l.current!==t.__e||Fn(l,null,s)),null!=(l=t.__c)){if(l.componentWillUnmount)try{l.componentWillUnmount()}catch(t){i4.__e(t,s)}l.base=l.__P=null,t.__c=void 0}if(l=t.__k)for(c=0;c<l.length;c++)l[c]&&Rn(l[c],s,a||"function"!=typeof t.type);a||null==t.__e||un(t.__e),t.__=t.__e=t.__d=void 0}function Tn(t,s,a){return this.constructor(t,a)}i6=su.slice,i4={__e:function(t,s,a,l){for(var c,d,h;s=s.__;)if((c=s.__c)&&!c.__)try{if((d=c.constructor)&&null!=d.getDerivedStateFromError&&(c.setState(d.getDerivedStateFromError(t)),h=c.__d),null!=c.componentDidCatch&&(c.componentDidCatch(t,l||{}),h=c.__d),h)return c.__E=c}catch(s){t=s}throw t}},i8=0,_n.prototype.setState=function(t,s){var a;a=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=cn({},this.state),"function"==typeof t&&(t=t(cn({},a),this.props)),t&&cn(a,t),null!=t&&this.__v&&(s&&this._sb.push(s),vn(this))},_n.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),vn(this))},_n.prototype.render=hn,i7=[],se="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,st=function(t,s){return t.__v.__b-s.__v.__b},fn.__r=0,ss=0,(sE=sn||(sn={})).Popover="popover",sE.API="api",sE.Widget="widget",(sF=so||(so={})).Open="open",sF.MultipleChoice="multiple_choice",sF.SingleChoice="single_choice",sF.Rating="rating",sF.Link="link",(sx=sa||(sa={})).NextQuestion="next_question",sx.End="end",sx.ResponseBased="response_based",sx.SpecificQuestion="specific_question",(sI=sl||(sl={})).Once="once",sI.Recurring="recurring",sI.Always="always",(sC={__c:sP="__cC"+ss++,__:{isPreviewMode:!1,previewPageIndex:0,handleCloseSurveyPopup:()=>{},isPopup:!0,onPreviewSubmit:()=>{}},Consumer:function(t,s){return t.children(s)},Provider:function(t){var s,a;return this.getChildContext||(s=[],(a={})[sP]=this,this.getChildContext=function(){return a},this.shouldComponentUpdate=function(t){this.props.value!==t.value&&s.some(function(t){t.__e=!0,vn(t)})},this.sub=function(t){s.push(t);var a=t.componentWillUnmount;t.componentWillUnmount=function(){s.splice(s.indexOf(t),1),a&&a.call(t)}}),t.children}}).Provider.__=sC.Consumer.contextType=sC;var $n=function(t,s){if(!function(t){try{new RegExp(t)}catch(t){return!1}return!0}(s))return!1;try{return new RegExp(s).test(t)}catch(t){return!1}};let On=class On{constructor(){V(this,"events",{}),this.events={}}on(t,s){return this.events[t]||(this.events[t]=[]),this.events[t].push(s),()=>{this.events[t]=this.events[t].filter(t=>t!==s)}}emit(t,s){for(var a of this.events[t]||[])a(s);for(var l of this.events["*"]||[])l(t,s)}};let Mn=class Mn{constructor(t){V(this,"_debugEventEmitter",new On),V(this,"checkStep",(t,s)=>this.checkStepEvent(t,s)&&this.checkStepUrl(t,s)&&this.checkStepElement(t,s)),V(this,"checkStepEvent",(t,s)=>null==s||!s.event||(null==t?void 0:t.event)===(null==s?void 0:s.event)),this.instance=t,this.actionEvents=new Set,this.actionRegistry=new Set}init(){var t,s;F(null===(t=this.instance)||void 0===t?void 0:t._addCaptureHook)||null===(s=this.instance)||void 0===s||s._addCaptureHook((t,s)=>{this.on(t,s)})}register(t){var s,a;if(!F(null===(s=this.instance)||void 0===s?void 0:s._addCaptureHook)&&(t.forEach(t=>{var s,a;null===(s=this.actionRegistry)||void 0===s||s.add(t),null===(a=t.steps)||void 0===a||a.forEach(t=>{var s;null===(s=this.actionEvents)||void 0===s||s.add((null==t?void 0:t.event)||"")})}),null!==(a=this.instance)&&void 0!==a&&a.autocapture)){var l,c=new Set;t.forEach(t=>{var s;null===(s=t.steps)||void 0===s||s.forEach(t=>{null!=t&&t.selector&&c.add(null==t?void 0:t.selector)})}),null===(l=this.instance)||void 0===l||l.autocapture.setElementSelectors(c)}}on(t,s){var a;null!=s&&0!=t.length&&(this.actionEvents.has(t)||this.actionEvents.has(null==s?void 0:s.event))&&this.actionRegistry&&(null===(a=this.actionRegistry)||void 0===a?void 0:a.size)>0&&this.actionRegistry.forEach(t=>{this.checkAction(s,t)&&this._debugEventEmitter.emit("actionCaptured",t.name)})}_addActionHook(t){this.onAction("actionCaptured",s=>t(s))}checkAction(t,s){if(null==(null==s?void 0:s.steps))return!1;for(var a of s.steps)if(this.checkStep(t,a))return!0;return!1}onAction(t,s){return this._debugEventEmitter.on(t,s)}checkStepUrl(t,s){if(null!=s&&s.url){var a,l=null==t||null===(a=t.properties)||void 0===a?void 0:a.$current_url;if(!l||"string"!=typeof l||!Mn.matchString(l,null==s?void 0:s.url,(null==s?void 0:s.url_matching)||"contains"))return!1}return!0}static matchString(t,s,a){switch(a){case"regex":return!!c&&$n(t,s);case"exact":return s===t;case"contains":return $n(t,Mn.escapeStringRegexp(s).replace(/_/g,".").replace(/%/g,".*"));default:return!1}}static escapeStringRegexp(t){return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}checkStepElement(t,s){if((null!=s&&s.href||null!=s&&s.tag_name||null!=s&&s.text)&&!this.getElementsList(t).some(t=>!(null!=s&&s.href&&!Mn.matchString(t.href||"",null==s?void 0:s.href,(null==s?void 0:s.href_matching)||"exact"))&&(null==s||!s.tag_name||t.tag_name===(null==s?void 0:s.tag_name))&&!(null!=s&&s.text&&!Mn.matchString(t.text||"",null==s?void 0:s.text,(null==s?void 0:s.text_matching)||"exact")&&!Mn.matchString(t.$el_text||"",null==s?void 0:s.text,(null==s?void 0:s.text_matching)||"exact"))))return!1;if(null!=s&&s.selector){var a,l=null==t||null===(a=t.properties)||void 0===a?void 0:a.$element_selectors;if(!l||!l.includes(null==s?void 0:s.selector))return!1}return!0}getElementsList(t){return null==(null==t?void 0:t.properties.$elements)?[]:null==t?void 0:t.properties.$elements}};let An=class An{constructor(t){this.instance=t,this.eventToSurveys=new Map,this.actionToSurveys=new Map}register(t){var s;F(null===(s=this.instance)||void 0===s?void 0:s._addCaptureHook)||(this.setupEventBasedSurveys(t),this.setupActionBasedSurveys(t))}setupActionBasedSurveys(t){var s=t.filter(t=>{var s,a,l,c;return(null===(s=t.conditions)||void 0===s?void 0:s.actions)&&(null===(a=t.conditions)||void 0===a||null===(l=a.actions)||void 0===l||null===(c=l.values)||void 0===c?void 0:c.length)>0});0!==s.length&&(null==this.actionMatcher&&(this.actionMatcher=new Mn(this.instance),this.actionMatcher.init(),this.actionMatcher._addActionHook(t=>{this.onAction(t)})),s.forEach(t=>{var s,a,l,c,d,h,_,p,g,v;t.conditions&&null!==(s=t.conditions)&&void 0!==s&&s.actions&&null!==(a=t.conditions)&&void 0!==a&&null!==(l=a.actions)&&void 0!==l&&l.values&&(null===(c=t.conditions)||void 0===c||null===(d=c.actions)||void 0===d||null===(h=d.values)||void 0===h?void 0:h.length)>0&&(null===(_=this.actionMatcher)||void 0===_||_.register(t.conditions.actions.values),null===(p=t.conditions)||void 0===p||null===(g=p.actions)||void 0===g||null===(v=g.values)||void 0===v||v.forEach(s=>{if(s&&s.name){var a=this.actionToSurveys.get(s.name);a&&a.push(t.id),this.actionToSurveys.set(s.name,a||[t.id])}}))}))}setupEventBasedSurveys(t){var s;0!==t.filter(t=>{var s,a,l,c;return(null===(s=t.conditions)||void 0===s?void 0:s.events)&&(null===(a=t.conditions)||void 0===a||null===(l=a.events)||void 0===l||null===(c=l.values)||void 0===c?void 0:c.length)>0}).length&&(null===(s=this.instance)||void 0===s||s._addCaptureHook((t,s)=>{this.onEvent(t,s)}),t.forEach(t=>{var s,a,l;null===(s=t.conditions)||void 0===s||null===(a=s.events)||void 0===a||null===(l=a.values)||void 0===l||l.forEach(s=>{if(s&&s.name){var a=this.eventToSurveys.get(s.name);a&&a.push(t.id),this.eventToSurveys.set(s.name,a||[t.id])}})}))}onEvent(t,s){var a,l,c=(null===(a=this.instance)||void 0===a||null===(l=a.persistence)||void 0===l?void 0:l.props[eq])||[];if(An.SURVEY_SHOWN_EVENT_NAME==t&&s&&c.length>0){var d,h=null==s||null===(d=s.properties)||void 0===d?void 0:d.$survey_id;if(h){var _=c.indexOf(h);_>=0&&(c.splice(_,1),this._updateActivatedSurveys(c))}}else this.eventToSurveys.has(t)&&this._updateActivatedSurveys(c.concat(this.eventToSurveys.get(t)||[]))}onAction(t){var s,a,l=(null===(s=this.instance)||void 0===s||null===(a=s.persistence)||void 0===a?void 0:a.props[eq])||[];this.actionToSurveys.has(t)&&this._updateActivatedSurveys(l.concat(this.actionToSurveys.get(t)||[]))}_updateActivatedSurveys(t){var s,a;null===(s=this.instance)||void 0===s||null===(a=s.persistence)||void 0===a||a.register({[eq]:[...new Set(t)]})}getSurveys(){var t,s;return(null===(t=this.instance)||void 0===t||null===(s=t.persistence)||void 0===s?void 0:s.props[eq])||[]}getEventToSurveys(){return this.eventToSurveys}_getActionMatcher(){return this.actionMatcher}};V(An,"SURVEY_SHOWN_EVENT_NAME","survey shown");var s_=ec("[Surveys]"),sp={icontains:(t,s)=>t.some(t=>s.toLowerCase().includes(t.toLowerCase())),not_icontains:(t,s)=>t.every(t=>!s.toLowerCase().includes(t.toLowerCase())),regex:(t,s)=>t.some(t=>$n(s,t)),not_regex:(t,s)=>t.every(t=>!$n(s,t)),exact:(t,s)=>t.some(t=>s===t),is_not:(t,s)=>t.every(t=>s!==t)};function qn(t){return null!=t?t:"icontains"}let Nn=class Nn{constructor(t){V(this,"_isFetchingSurveys",!1),V(this,"_isInitializingSurveys",!1),this.instance=t,this._surveyEventReceiver=null}onRemoteConfig(t){this._decideServerResponse=!!t.surveys,s_.info("decideServerResponse set to ".concat(this._decideServerResponse)),this.loadIfEnabled()}reset(){localStorage.removeItem("lastSeenSurveyDate"),(()=>{for(var t=[],s=0;s<localStorage.length;s++){var a=localStorage.key(s);null!=a&&a.startsWith("seenSurvey_")&&t.push(a)}return t})().forEach(t=>localStorage.removeItem(t))}loadIfEnabled(){if(!this._surveyManager){if(this._isInitializingSurveys)s_.info("Already initializing surveys, skipping...");else if(this.instance.config.disable_surveys)s_.info("Disabled. Not loading surveys.");else{var t=null==x?void 0:x.__PosthogExtensions__;if(t){if(this._decideServerResponse){this._isInitializingSurveys=!0;try{var s=t.generateSurveys;if(s)this._surveyManager=s(this.instance),this._isInitializingSurveys=!1,this._surveyEventReceiver=new An(this.instance),s_.info("Surveys loaded successfully");else{var a=t.loadExternalDependency;a?a(this.instance,"surveys",s=>{if(s||!t.generateSurveys)return s_.error("Could not load surveys script",s),void(this._isInitializingSurveys=!1);this._surveyManager=t.generateSurveys(this.instance),this._isInitializingSurveys=!1,this._surveyEventReceiver=new An(this.instance),s_.info("Surveys loaded successfully")}):(s_.error("PostHog loadExternalDependency extension not found. Cannot load remote config."),this._isInitializingSurveys=!1)}}catch(t){throw s_.error("Error initializing surveys",t),this._isInitializingSurveys=!1,t}}else s_.warn("Decide not loaded yet. Not loading surveys.")}else s_.error("PostHog Extensions not found.")}}}getSurveys(t){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.instance.config.disable_surveys)return s_.info("Disabled. Not loading surveys."),t([]);var a=this.instance.get_property(eD);if(a&&!s)return t(a);if(this._isFetchingSurveys)return t([]);try{this._isFetchingSurveys=!0,this.instance._send_request({url:this.instance.requestRouter.endpointFor("api","/api/surveys/?token=".concat(this.instance.config.token)),method:"GET",timeout:this.instance.config.surveys_request_timeout_ms,callback:s=>{this._isFetchingSurveys=!1;var a=s.statusCode;if(200!==a||!s.json)return s_.error("Surveys API could not be loaded, status: ".concat(a)),t([]);var l,c,d=s.json.surveys||[],h=d.filter(t=>{var s,a,l,c,d,h,_,p,g,v,f,w;return(null===(s=t.conditions)||void 0===s?void 0:s.events)&&(null===(a=t.conditions)||void 0===a||null===(l=a.events)||void 0===l?void 0:l.values)&&(null===(c=t.conditions)||void 0===c||null===(d=c.events)||void 0===d||null===(h=d.values)||void 0===h?void 0:h.length)>0||(null===(_=t.conditions)||void 0===_?void 0:_.actions)&&(null===(p=t.conditions)||void 0===p||null===(g=p.actions)||void 0===g?void 0:g.values)&&(null===(v=t.conditions)||void 0===v||null===(f=v.actions)||void 0===f||null===(w=f.values)||void 0===w?void 0:w.length)>0});return h.length>0&&(null===(c=this._surveyEventReceiver)||void 0===c||c.register(h)),null===(l=this.instance.persistence)||void 0===l||l.register({[eD]:d}),t(d)}})}catch(t){throw this._isFetchingSurveys=!1,t}}isSurveyFeatureFlagEnabled(t){return!t||this.instance.featureFlags.isFeatureEnabled(t)}getActiveMatchingSurveys(t){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.getSurveys(s=>{var a,l=s.filter(t=>!(!t.start_date||t.end_date)).filter(t=>{if(!t.conditions)return!0;var s,a=function(t){if(null===(s=t.conditions)||void 0===s||!s.url)return!0;var s,a,l,d=null==c||null===(a=c.location)||void 0===a?void 0:a.href;if(!d)return!1;var h=[t.conditions.url];return sp[qn(null===(l=t.conditions)||void 0===l?void 0:l.urlMatchType)](h,d)}(t),l=null===(s=t.conditions)||void 0===s||!s.selector||(null==v?void 0:v.querySelector(t.conditions.selector)),d=function(t){if(null===(s=t.conditions)||void 0===s||!s.deviceTypes||0===(null===(a=t.conditions)||void 0===a?void 0:a.deviceTypes.length))return!0;if(!E)return!1;var s,a,l,c=i2.deviceType(E);return sp[qn(null===(l=t.conditions)||void 0===l?void 0:l.deviceTypesMatchType)](t.conditions.deviceTypes,c)}(t);return a&&l&&d}),d=null===(a=this._surveyEventReceiver)||void 0===a?void 0:a.getSurveys();return t(l.filter(t=>{if(!(t.linked_flag_key||t.targeting_flag_key||t.internal_targeting_flag_key||null!==(s=t.feature_flag_keys)&&void 0!==s&&s.length))return!0;var s,a,l,c,h,_,p,g,v,f=this.isSurveyFeatureFlagEnabled(t.linked_flag_key),w=this.isSurveyFeatureFlagEnabled(t.targeting_flag_key),S=(null!==(a=null===(l=t.conditions)||void 0===l||null===(c=l.events)||void 0===c||null===(h=c.values)||void 0===h?void 0:h.length)&&void 0!==a?a:0)>0,k=(null!==(_=null===(p=t.conditions)||void 0===p||null===(g=p.actions)||void 0===g||null===(v=g.values)||void 0===v?void 0:v.length)&&void 0!==_?_:0)>0,E=!S&&!k||(null==d?void 0:d.includes(t.id)),x=this._canActivateRepeatedly(t)||this.isSurveyFeatureFlagEnabled(t.internal_targeting_flag_key),B=this.checkFlags(t);return f&&w&&x&&E&&B}))},s)}checkFlags(t){var s;return null===(s=t.feature_flag_keys)||void 0===s||!s.length||t.feature_flag_keys.every(t=>{var{key:s,value:a}=t;return!s||!a||this.instance.featureFlags.isFeatureEnabled(a)})}_canActivateRepeatedly(t){var s;return O(null===(s=x.__PosthogExtensions__)||void 0===s?void 0:s.canActivateRepeatedly)?(s_.warn("init was not called"),!1):x.__PosthogExtensions__.canActivateRepeatedly(t)}canRenderSurvey(t){O(this._surveyManager)?s_.warn("init was not called"):this.getSurveys(s=>{var a=s.filter(s=>s.id===t)[0];this._surveyManager.canRenderSurvey(a)})}renderSurvey(t,s){O(this._surveyManager)?s_.warn("init was not called"):this.getSurveys(a=>{var l=a.filter(s=>s.id===t)[0];this._surveyManager.renderSurvey(l,null==v?void 0:v.querySelector(s))})}};var sg=ec("[RateLimiter]");let Hn=class Hn{constructor(t){var s,a;V(this,"serverLimits",{}),V(this,"lastEventRateLimited",!1),V(this,"checkForLimiting",t=>{var s=t.text;if(s&&s.length)try{(JSON.parse(s).quota_limited||[]).forEach(t=>{sg.info("".concat(t||"events"," is quota limited.")),this.serverLimits[t]=(new Date).getTime()+6e4})}catch(t){return void sg.warn('could not rate limit - continuing. Error: "'.concat(null==t?void 0:t.message,'"'),{text:s})}}),this.instance=t,this.captureEventsPerSecond=(null===(s=t.config.rate_limiting)||void 0===s?void 0:s.events_per_second)||10,this.captureEventsBurstLimit=Math.max((null===(a=t.config.rate_limiting)||void 0===a?void 0:a.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}clientRateLimitContext(){var t,s,a,l=arguments.length>0&&void 0!==arguments[0]&&arguments[0],c=(new Date).getTime(),d=null!==(t=null===(s=this.instance.persistence)||void 0===s?void 0:s.get_property(eB))&&void 0!==t?t:{tokens:this.captureEventsBurstLimit,last:c};d.tokens+=(c-d.last)/1e3*this.captureEventsPerSecond,d.last=c,d.tokens>this.captureEventsBurstLimit&&(d.tokens=this.captureEventsBurstLimit);var h=d.tokens<1;return h||l||(d.tokens=Math.max(0,d.tokens-1)),!h||this.lastEventRateLimited||l||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to ".concat(this.captureEventsPerSecond," events per second and ").concat(this.captureEventsBurstLimit," events burst limit.")},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=h,null===(a=this.instance.persistence)||void 0===a||a.set_property(eB,d),{isRateLimited:h,remainingTokens:d.tokens}}isServerRateLimited(t){var s=this.serverLimits[t||"events"]||!1;return!1!==s&&(new Date).getTime()<s}};var sv=ec("[RemoteConfig]");let zn=class zn{constructor(t){this.instance=t}get remoteConfig(){var t,s;return null===(t=x._POSTHOG_REMOTE_CONFIG)||void 0===t||null===(s=t[this.instance.config.token])||void 0===s?void 0:s.config}_loadRemoteConfigJs(t){var s,a,l;null!==(s=x.__PosthogExtensions__)&&void 0!==s&&s.loadExternalDependency?null===(a=x.__PosthogExtensions__)||void 0===a||null===(l=a.loadExternalDependency)||void 0===l||l.call(a,this.instance,"remote-config",()=>t(this.remoteConfig)):(sv.error("PostHog Extensions not found. Cannot load remote config."),t())}_loadRemoteConfigJSON(t){this.instance._send_request({method:"GET",url:this.instance.requestRouter.endpointFor("assets","/array/".concat(this.instance.config.token,"/config")),callback:s=>{t(s.json)}})}load(){try{if(this.remoteConfig)return sv.info("Using preloaded remote config",this.remoteConfig),void this.onRemoteConfig(this.remoteConfig);if(this.instance.config.advanced_disable_decide)return void sv.warn("Remote config is disabled. Falling back to local config.");this._loadRemoteConfigJs(t=>{if(!t)return sv.info("No config found after loading remote JS config. Falling back to JSON."),void this._loadRemoteConfigJSON(t=>{this.onRemoteConfig(t)});this.onRemoteConfig(t)})}catch(t){sv.error("Error loading remote config",t)}}onRemoteConfig(t){t?this.instance.config.__preview_remote_config?(this.instance._onRemoteConfig(t),!1!==t.hasFeatureFlags&&this.instance.featureFlags.ensureFlagsLoaded()):sv.info("__preview_remote_config is disabled. Logging config instead",t):sv.error("Failed to fetch remote config from PostHog.")}};var jn=function(t){var s,a,l,c,d="";for(s=a=0,l=(t=(t+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,c=0;c<l;c++){var h=t.charCodeAt(c),_=null;h<128?a++:_=h>127&&h<2048?String.fromCharCode(h>>6|192,63&h|128):String.fromCharCode(h>>12|224,h>>6&63|128,63&h|128),$(_)||(a>s&&(d+=t.substring(s,a)),d+=_,s=a=c+1)}return a>s&&(d+=t.substring(s,t.length)),d},sf=!!S||!!w,sm="text/plain",Gn=(t,s)=>{var[a,l]=t.split("?"),c=W({},s);null==l||l.split("&").forEach(t=>{var[s]=t.split("=");delete c[s]});var d=St(c);return d=d?(l?l+"&":"")+d:l,"".concat(a,"?").concat(d)},Jn=(t,s)=>JSON.stringify(t,(t,s)=>"bigint"==typeof s?s.toString():s,s),Yn=t=>{var{data:s,compression:a}=t;if(s){if(a===l.GZipJS){var c=sr(nr(Jn(s)),{mtime:0}),d=new Blob([c],{type:sm});return{contentType:sm,body:d,estimatedSize:d.size}}if(a===l.Base64){var h,_="data="+encodeURIComponent("string"==typeof(h=function(t){var s,a,l,c,d,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_=0,p=0,g="",v=[];if(!t)return t;t=jn(t);do s=(d=t.charCodeAt(_++)<<16|t.charCodeAt(_++)<<8|t.charCodeAt(_++))>>18&63,a=d>>12&63,l=d>>6&63,c=63&d,v[p++]=h.charAt(s)+h.charAt(a)+h.charAt(l)+h.charAt(c);while(_<t.length);switch(g=v.join(""),t.length%3){case 1:g=g.slice(0,-2)+"==";break;case 2:g=g.slice(0,-1)+"="}return g}(Jn(s)))?h:Jn(h));return{contentType:"application/x-www-form-urlencoded",body:_,estimatedSize:new Blob([_]).size}}var p=Jn(s);return{contentType:"application/json",body:p,estimatedSize:new Blob([p]).size}}},sy=[];w&&sy.push({transport:"fetch",method:t=>{var s,a,{contentType:l,body:c,estimatedSize:d}=null!==(s=Yn(t))&&void 0!==s?s:{},h=new Headers;K(t.headers,function(t,s){h.append(s,t)}),l&&h.append("Content-Type",l);var _=t.url,p=null;if(k){var g=new k;p={signal:g.signal,timeout:setTimeout(()=>g.abort(),t.timeout)}}w(_,W({method:(null==t?void 0:t.method)||"GET",headers:h,keepalive:"POST"===t.method&&52428.8>(d||0),body:c,signal:null===(a=p)||void 0===a?void 0:a.signal},t.fetchOptions)).then(s=>s.text().then(a=>{var l,c={statusCode:s.status,text:a};if(200===s.status)try{c.json=JSON.parse(a)}catch(t){el.error(t)}null===(l=t.callback)||void 0===l||l.call(t,c)})).catch(s=>{var a;el.error(s),null===(a=t.callback)||void 0===a||a.call(t,{statusCode:0,text:s})}).finally(()=>p?clearTimeout(p.timeout):null)}}),S&&sy.push({transport:"XHR",method:t=>{var s,a=new S;a.open(t.method||"GET",t.url,!0);var{contentType:l,body:c}=null!==(s=Yn(t))&&void 0!==s?s:{};K(t.headers,function(t,s){a.setRequestHeader(s,t)}),l&&a.setRequestHeader("Content-Type",l),t.timeout&&(a.timeout=t.timeout),a.withCredentials=!0,a.onreadystatechange=()=>{if(4===a.readyState){var s,l={statusCode:a.status,text:a.responseText};if(200===a.status)try{l.json=JSON.parse(a.responseText)}catch(t){}null===(s=t.callback)||void 0===s||s.call(t,l)}},a.send(c)}}),null!=g&&g.sendBeacon&&sy.push({transport:"sendBeacon",method:t=>{var s=Gn(t.url,{beacon:"1"});try{var a,{contentType:l,body:c}=null!==(a=Yn(t))&&void 0!==a?a:{},d="string"==typeof c?new Blob([c],{type:l}):c;g.sendBeacon(s,d)}catch(t){}}});let Qn=class Qn{constructor(t,s){V(this,"isPaused",!0),V(this,"queue",[]),this.flushTimeoutMs=bi((null==s?void 0:s.flush_interval_ms)||3e3,250,5e3,"flush interval",3e3),this.sendRequest=t}enqueue(t){this.queue.push(t),this.flushTimeout||this.setFlushTimeout()}unload(){this.clearFlushTimeout();var t=Object.values(this.queue.length>0?this.formatQueue():{});[...t.filter(t=>0===t.url.indexOf("/e")),...t.filter(t=>0!==t.url.indexOf("/e"))].map(t=>{this.sendRequest(W(W({},t),{},{transport:"sendBeacon"}))})}enable(){this.isPaused=!1,this.setFlushTimeout()}setFlushTimeout(){var t=this;this.isPaused||(this.flushTimeout=setTimeout(()=>{if(this.clearFlushTimeout(),this.queue.length>0){var s=this.formatQueue();for(var a in s)!function(a){var l=s[a],c=(new Date).getTime();l.data&&ea(l.data)&&K(l.data,t=>{t.offset=Math.abs(t.timestamp-c),delete t.timestamp}),t.sendRequest(l)}(a)}},this.flushTimeoutMs))}clearFlushTimeout(){clearTimeout(this.flushTimeout),this.flushTimeout=void 0}formatQueue(){var t={};return K(this.queue,s=>{var a,l=(s?s.batchKey:null)||s.url;F(t[l])&&(t[l]=W(W({},s),{},{data:[]})),null===(a=t[l].data)||void 0===a||a.push(s.data)}),this.queue=[],t}};var sb=["retriesPerformedSoFar"];let eo=class eo{constructor(t){V(this,"isPolling",!1),V(this,"pollIntervalMs",3e3),V(this,"queue",[]),this.instance=t,this.queue=[],this.areWeOnline=!0,!F(c)&&"onLine"in c.navigator&&(this.areWeOnline=c.navigator.onLine,ae(c,"online",()=>{this.areWeOnline=!0,this.flush()}),ae(c,"offline",()=>{this.areWeOnline=!1}))}retriableRequest(t){var{retriesPerformedSoFar:s}=t,a=G(t,sb);M(s)&&s>0&&(a.url=Gn(a.url,{retry_count:s})),this.instance._send_request(W(W({},a),{},{callback:t=>{var l;200!==t.statusCode&&(t.statusCode<400||t.statusCode>=500)&&(null!=s?s:0)<10?this.enqueue(W({retriesPerformedSoFar:s},a)):null===(l=a.callback)||void 0===l||l.call(a,t)}}))}enqueue(t){var s,a,l,c=t.retriesPerformedSoFar||0;t.retriesPerformedSoFar=c+1;var d=(l=(Math.random()-.5)*((a=Math.min(18e5,s=3e3*Math.pow(2,c)))-s/2),Math.ceil(a+l)),h=Date.now()+d;this.queue.push({retryAt:h,requestOptions:t});var _="Enqueued failed request for retry in ".concat(d);navigator.onLine||(_+=" (Browser is offline)"),el.warn(_),this.isPolling||(this.isPolling=!0,this.poll())}poll(){this.poller&&clearTimeout(this.poller),this.poller=setTimeout(()=>{this.areWeOnline&&this.queue.length>0&&this.flush(),this.poll()},this.pollIntervalMs)}flush(){var t=Date.now(),s=[],a=this.queue.filter(a=>a.retryAt<t||(s.push(a),!1));if(this.queue=s,a.length>0)for(var{requestOptions:l}of a)this.retriableRequest(l)}unload(){for(var{requestOptions:t}of(this.poller&&(clearTimeout(this.poller),this.poller=void 0),this.queue))try{this.instance._send_request(W(W({},t),{},{transport:"sendBeacon"}))}catch(t){el.error(t)}this.queue=[]}};let to=class to{constructor(t){V(this,"_updateScrollData",()=>{this.context||(this.context={});var t,s,a,l,c=this.scrollElement(),d=this.scrollY(),h=c?Math.max(0,c.scrollHeight-c.clientHeight):0,_=d+((null==c?void 0:c.clientHeight)||0),p=(null==c?void 0:c.scrollHeight)||0;this.context.lastScrollY=Math.ceil(d),this.context.maxScrollY=Math.max(d,null!==(t=this.context.maxScrollY)&&void 0!==t?t:0),this.context.maxScrollHeight=Math.max(h,null!==(s=this.context.maxScrollHeight)&&void 0!==s?s:0),this.context.lastContentY=_,this.context.maxContentY=Math.max(_,null!==(a=this.context.maxContentY)&&void 0!==a?a:0),this.context.maxContentHeight=Math.max(p,null!==(l=this.context.maxContentHeight)&&void 0!==l?l:0)}),this.instance=t}getContext(){return this.context}resetContext(){var t=this.context;return setTimeout(this._updateScrollData,0),t}startMeasuringScrollPosition(){ae(c,"scroll",this._updateScrollData,{capture:!0}),ae(c,"scrollend",this._updateScrollData,{capture:!0}),ae(c,"resize",this._updateScrollData)}scrollElement(){if(!this.instance.config.scroll_root_selector)return null==c?void 0:c.document.documentElement;for(var t of ea(this.instance.config.scroll_root_selector)?this.instance.config.scroll_root_selector:[this.instance.config.scroll_root_selector]){var s=null==c?void 0:c.document.querySelector(t);if(s)return s}}scrollY(){if(this.instance.config.scroll_root_selector){var t=this.scrollElement();return t&&t.scrollTop||0}return c&&(c.scrollY||c.pageYOffset||c.document.documentElement.scrollTop)||0}scrollX(){if(this.instance.config.scroll_root_selector){var t=this.scrollElement();return t&&t.scrollLeft||0}return c&&(c.scrollX||c.pageXOffset||c.document.documentElement.scrollLeft)||0}};var io=t=>i2.personInfo({maskPersonalDataProperties:null==t?void 0:t.config.mask_personal_data_properties,customPersonalDataProperties:null==t?void 0:t.config.custom_personal_data_properties});let ro=class ro{constructor(t,s,a,l){V(this,"_onSessionIdCallback",t=>{var s=this._getStored();if(!s||s.sessionId!==t){var a={sessionId:t,props:this._sessionSourceParamGenerator(this.instance)};this._persistence.register({[eV]:a})}}),this.instance=t,this._sessionIdManager=s,this._persistence=a,this._sessionSourceParamGenerator=l||io,this._sessionIdManager.onSessionId(this._onSessionIdCallback)}_getStored(){return this._persistence.props[eV]}getSetOnceInitialSessionPropsProps(){var t,s=null===(t=this._getStored())||void 0===t?void 0:t.props;return s?"r"in s?i2.personPropsFromInfo(s):{$referring_domain:s.referringDomain,$pathname:s.initialPathName,utm_source:s.utm_source,utm_campaign:s.utm_campaign,utm_medium:s.utm_medium,utm_content:s.utm_content,utm_term:s.utm_term}:{}}};var sw=ec("[SessionId]");let no=class no{constructor(t,s,a){if(V(this,"_sessionIdChangedHandlers",[]),!t.persistence)throw Error("SessionIdManager requires a PostHogPersistence instance");if(t.config.__preview_experimental_cookieless_mode)throw Error("SessionIdManager cannot be used with __preview_experimental_cookieless_mode");this.config=t.config,this.persistence=t.persistence,this._windowId=void 0,this._sessionId=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this._sessionIdGenerator=s||qt,this._windowIdGenerator=a||qt;var l,c=this.config.persistence_name||this.config.token,d=this.config.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*bi(d,60,36e3,"session_idle_timeout_seconds",1800),t.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.resetIdleTimer(),this._window_id_storage_key="ph_"+c+"_window_id",this._primary_window_exists_storage_key="ph_"+c+"_primary_window_exists",this._canUseSessionStorage()){var h=t_.parse(this._window_id_storage_key),_=t_.parse(this._primary_window_exists_storage_key);h&&!_?this._windowId=h:t_.remove(this._window_id_storage_key),t_.set(this._primary_window_exists_storage_key,!0)}if(null!==(l=this.config.bootstrap)&&void 0!==l&&l.sessionID)try{var p=(t=>{var s=t.replace(/-/g,"");if(32!==s.length)throw Error("Not a valid UUID");if("7"!==s[12])throw Error("Not a UUIDv7");return parseInt(s.substring(0,12),16)})(this.config.bootstrap.sessionID);this._setSessionId(this.config.bootstrap.sessionID,(new Date).getTime(),p)}catch(t){sw.error("Invalid sessionID in bootstrap",t)}this._listenToReloadWindow()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(t){return F(this._sessionIdChangedHandlers)&&(this._sessionIdChangedHandlers=[]),this._sessionIdChangedHandlers.push(t),this._sessionId&&t(this._sessionId,this._windowId),()=>{this._sessionIdChangedHandlers=this._sessionIdChangedHandlers.filter(s=>s!==t)}}_canUseSessionStorage(){return"memory"!==this.config.persistence&&!this.persistence.disabled&&t_.is_supported()}_setWindowId(t){t!==this._windowId&&(this._windowId=t,this._canUseSessionStorage()&&t_.set(this._window_id_storage_key,t))}_getWindowId(){return this._windowId?this._windowId:this._canUseSessionStorage()?t_.parse(this._window_id_storage_key):null}_setSessionId(t,s,a){t===this._sessionId&&s===this._sessionActivityTimestamp&&a===this._sessionStartTimestamp||(this._sessionStartTimestamp=a,this._sessionActivityTimestamp=s,this._sessionId=t,this.persistence.register({[eC]:[s,t,a]}))}_getSessionId(){if(this._sessionId&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this._sessionId,this._sessionStartTimestamp];var t=this.persistence.props[eC];return ea(t)&&2===t.length&&t.push(t[0]),t||[0,null,0]}resetSessionId(){this._setSessionId(null,null,null)}_listenToReloadWindow(){ae(c,"beforeunload",()=>{this._canUseSessionStorage()&&t_.remove(this._primary_window_exists_storage_key)},{capture:!1})}checkAndGetSessionAndWindowId(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.config.__preview_experimental_cookieless_mode)throw Error("checkAndGetSessionAndWindowId should not be called in __preview_experimental_cookieless_mode");var a=s||(new Date).getTime(),[l,c,d]=this._getSessionId(),h=this._getWindowId(),_=M(d)&&d>0&&Math.abs(a-d)>864e5,p=!1,g=!c,v=!t&&Math.abs(a-l)>this.sessionTimeoutMs;g||v||_?(c=this._sessionIdGenerator(),h=this._windowIdGenerator(),sw.info("new session ID generated",{sessionId:c,windowId:h,changeReason:{noSessionId:g,activityTimeout:v,sessionPastMaximumLength:_}}),d=a,p=!0):h||(h=this._windowIdGenerator(),p=!0);var f=0===l||!t||_?a:l,w=0===d?(new Date).getTime():d;return this._setWindowId(h),this._setSessionId(c,f,w),t||this.resetIdleTimer(),p&&this._sessionIdChangedHandlers.forEach(t=>t(c,h,p?{noSessionId:g,activityTimeout:v,sessionPastMaximumLength:_}:void 0)),{sessionId:c,windowId:h,sessionStartTimestamp:w,changeReason:p?{noSessionId:g,activityTimeout:v,sessionPastMaximumLength:_}:void 0,lastActivityTimestamp:l}}resetIdleTimer(){clearTimeout(this._enforceIdleTimeout),this._enforceIdleTimeout=setTimeout(()=>{this.resetSessionId()},1.1*this.sessionTimeoutMs)}};var sS=["$set_once","$set"],sk=ec("[SiteApps]");let lo=class lo{constructor(t){this.instance=t,this.bufferedInvocations=[],this.apps={}}get isEnabled(){return!!this.instance.config.opt_in_site_apps}eventCollector(t,s){if(s){var a=this.globalsForEvent(s);this.bufferedInvocations.push(a),this.bufferedInvocations.length>1e3&&(this.bufferedInvocations=this.bufferedInvocations.slice(10))}}get siteAppLoaders(){var t,s;return null===(t=x._POSTHOG_REMOTE_CONFIG)||void 0===t||null===(s=t[this.instance.config.token])||void 0===s?void 0:s.siteApps}init(){if(this.isEnabled){var t=this.instance._addCaptureHook(this.eventCollector.bind(this));this.stopBuffering=()=>{t(),this.bufferedInvocations=[],this.stopBuffering=void 0}}}globalsForEvent(t){if(!t)throw Error("Event payload is required");var s,a,l,c,d,h,_,p={},g=this.instance.get_property("$groups")||[];for(var[v,f]of Object.entries(this.instance.get_property("$stored_group_properties")||{}))p[v]={id:g[v],type:v,properties:f};var{$set_once:w,$set:S}=t;return{event:W(W({},G(t,sS)),{},{properties:W(W(W({},t.properties),S?{$set:W(W({},null!==(s=null===(a=t.properties)||void 0===a?void 0:a.$set)&&void 0!==s?s:{}),S)}:{}),w?{$set_once:W(W({},null!==(l=null===(c=t.properties)||void 0===c?void 0:c.$set_once)&&void 0!==l?l:{}),w)}:{}),elements_chain:null!==(d=null===(h=t.properties)||void 0===h?void 0:h.$elements_chain)&&void 0!==d?d:"",distinct_id:null===(_=t.properties)||void 0===_?void 0:_.distinct_id}),person:{properties:this.instance.get_property("$stored_person_properties")},groups:p}}setupSiteApp(t){var s={id:t.id,loaded:!1,errored:!1};this.apps[t.id]=s;var i=a=>{var l;for(var c of(this.apps[t.id].errored=!a,this.apps[t.id].loaded=!0,sk.info("Site app with id ".concat(t.id," ").concat(a?"loaded":"errored")),a&&this.bufferedInvocations.length&&(sk.info("Processing ".concat(this.bufferedInvocations.length," events for site app with id ").concat(t.id)),this.bufferedInvocations.forEach(t=>{var a;return null===(a=s.processEvent)||void 0===a?void 0:a.call(s,t)})),Object.values(this.apps)))if(!c.loaded)return;null===(l=this.stopBuffering)||void 0===l||l.call(this)};try{var{processEvent:a}=t.init({posthog:this.instance,callback:t=>{i(t)}});a&&(s.processEvent=a)}catch(s){sk.error("Error while initializing PostHog app with config id ".concat(t.id),s),i(!1)}}onCapturedEvent(t){if(0!==Object.keys(this.apps).length){var s,a=this.globalsForEvent(t);for(var l of Object.values(this.apps))try{null===(s=l.processEvent)||void 0===s||s.call(l,a)}catch(s){sk.error("Error while processing event ".concat(t.event," for site app ").concat(l.id),s)}}}onRemoteConfig(t){var s,a,l,c=this;if(null!==(s=this.siteAppLoaders)&&void 0!==s&&s.length){if(!this.isEnabled)return void sk.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');for(var d of this.siteAppLoaders)this.setupSiteApp(d);this.instance.on("eventCaptured",t=>this.onCapturedEvent(t))}else if(null===(a=this.stopBuffering)||void 0===a||a.call(this),null!==(l=t.siteApps)&&void 0!==l&&l.length){if(this.isEnabled){var o=function(t,s){var a,l;x["__$$ph_site_app_".concat(t)]=c.instance,null===(a=x.__PosthogExtensions__)||void 0===a||null===(l=a.loadSiteApp)||void 0===l||l.call(a,c.instance,s,s=>{if(s)return sk.error("Error while initializing PostHog app with config id ".concat(t),s)})};for(var{id:h,url:_}of t.siteApps)o(h,_)}else sk.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}};var sE,sF,sx,sI,sP,sC,sR,sT=["ahrefsbot","ahrefssiteaudit","applebot","baiduspider","better uptime bot","bingbot","bingpreview","bot.htm","bot.php","chrome-lighthouse","crawler","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","linkedinbot","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","semrushbot","sitebulb","slurp","turnitin","twitterbot","vercelbot","yahoo! slurp","yandexbot","gptbot","oai-searchbot","chatgpt-user","headlesschrome","cypress","Google-HotelAdsVerifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleweblight","mediapartners-google","storebot-google","Bytespider;"],ho=function(t,s){if(!t)return!1;var a=t.toLowerCase();return sT.concat(s||[]).some(t=>{var s=t.toLowerCase();return -1!==a.indexOf(s)})},_o=function(t,s){if(!t)return!1;var a=t.userAgent;if(a&&ho(a,s))return!0;try{var l=null==t?void 0:t.userAgentData;if(null!=l&&l.brands&&l.brands.some(t=>ho(null==t?void 0:t.brand,s)))return!0}catch(t){}return!!t.webdriver};function po(t,s,a){return Jn({distinct_id:t,userPropertiesToSet:s,userPropertiesToSetOnce:a})}(sD=sR||(sR={})).US="us",sD.EU="eu",sD.CUSTOM="custom";var s$="i.posthog.com";let vo=class vo{constructor(t){V(this,"_regionCache",{}),this.instance=t}get apiHost(){var t=this.instance.config.api_host.trim().replace(/\/$/,"");return"https://app.posthog.com"===t?"https://us.i.posthog.com":t}get uiHost(){var t,s=null===(t=this.instance.config.ui_host)||void 0===t?void 0:t.replace(/\/$/,"");return s||(s=this.apiHost.replace(".".concat(s$),".posthog.com")),"https://app.posthog.com"===s?"https://us.posthog.com":s}get region(){return this._regionCache[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this._regionCache[this.apiHost]=sR.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this._regionCache[this.apiHost]=sR.EU:this._regionCache[this.apiHost]=sR.CUSTOM),this._regionCache[this.apiHost]}endpointFor(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(s&&(s="/"===s[0]?s:"/".concat(s)),"ui"===t)return this.uiHost+s;if(this.region===sR.CUSTOM)return this.apiHost+s;var a=s$+s;switch(t){case"assets":return"https://".concat(this.region,"-assets.").concat(a);case"api":return"https://".concat(this.region,".").concat(a)}}};var sO={icontains:(t,s)=>!!c&&s.href.toLowerCase().indexOf(t.toLowerCase())>-1,not_icontains:(t,s)=>!!c&&-1===s.href.toLowerCase().indexOf(t.toLowerCase()),regex:(t,s)=>!!c&&$n(s.href,t),not_regex:(t,s)=>!!c&&!$n(s.href,t),exact:(t,s)=>s.href===t,is_not:(t,s)=>s.href!==t};let mo=class mo{constructor(t){var s=this;V(this,"getWebExperimentsAndEvaluateDisplayLogic",function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];s.getWebExperiments(t=>{mo.logInfo("retrieved web experiments from the server"),s._flagToExperiments=new Map,t.forEach(t=>{if(t.feature_flag_key){s._flagToExperiments&&(mo.logInfo("setting flag key ",t.feature_flag_key," to web experiment ",t),null===(a=s._flagToExperiments)||void 0===a||a.set(t.feature_flag_key,t));var a,l=s.instance.getFeatureFlag(t.feature_flag_key);R(l)&&t.variants[l]&&s.applyTransforms(t.name,l,t.variants[l].transforms)}else if(t.variants)for(var c in t.variants){var d=t.variants[c];mo.matchesTestVariant(d)&&s.applyTransforms(t.name,c,d.transforms)}})},t)}),this.instance=t,this.instance.onFeatureFlags(t=>{this.onFeatureFlags(t)})}onFeatureFlags(t){if(this._is_bot())mo.logInfo("Refusing to render web experiment since the viewer is a likely bot");else if(!this.instance.config.disable_web_experiments){if(O(this._flagToExperiments))return this._flagToExperiments=new Map,this.loadIfEnabled(),void this.previewWebExperiment();mo.logInfo("applying feature flags",t),t.forEach(t=>{var s;if(this._flagToExperiments&&null!==(s=this._flagToExperiments)&&void 0!==s&&s.has(t)){var a,l=this.instance.getFeatureFlag(t),c=null===(a=this._flagToExperiments)||void 0===a?void 0:a.get(t);l&&null!=c&&c.variants[l]&&this.applyTransforms(c.name,l,c.variants[l].transforms)}})}}previewWebExperiment(){var t=mo.getWindowLocation();if(null!=t&&t.search){var s=kt(null==t?void 0:t.search,"__experiment_id"),a=kt(null==t?void 0:t.search,"__experiment_variant");s&&a&&(mo.logInfo("previewing web experiments ".concat(s," && ").concat(a)),this.getWebExperiments(t=>{this.showPreviewWebExperiment(parseInt(s),a,t)},!1,!0))}}loadIfEnabled(){this.instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(t,s,a){if(this.instance.config.disable_web_experiments&&!a)return t([]);var l=this.instance.get_property("$web_experiments");if(l&&!s)return t(l);this.instance._send_request({url:this.instance.requestRouter.endpointFor("api","/api/web_experiments/?token=".concat(this.instance.config.token)),method:"GET",callback:s=>200===s.statusCode&&s.json?t(s.json.experiments||[]):t([])})}showPreviewWebExperiment(t,s,a){var l=a.filter(s=>s.id===t);l&&l.length>0&&(mo.logInfo("Previewing web experiment [".concat(l[0].name,"] with variant [").concat(s,"]")),this.applyTransforms(l[0].name,s,l[0].variants[s].transforms))}static matchesTestVariant(t){return!O(t.conditions)&&mo.matchUrlConditions(t)&&mo.matchUTMConditions(t)}static matchUrlConditions(t){if(O(t.conditions)||O(null===(s=t.conditions)||void 0===s?void 0:s.url))return!0;var s,a,l,c,d=mo.getWindowLocation();return!!d&&(null===(a=t.conditions)||void 0===a||!a.url||sO[null!==(l=null===(c=t.conditions)||void 0===c?void 0:c.urlMatchType)&&void 0!==l?l:"icontains"](t.conditions.url,d))}static getWindowLocation(){return null==c?void 0:c.location}static matchUTMConditions(t){if(O(t.conditions)||O(null===(a=t.conditions)||void 0===a?void 0:a.utm))return!0;var s=i2.campaignParams();if(s.utm_source){var a,l,c,d,h,_,p,g,v,f,w,S,k,E,x,B,H,U=null===(l=t.conditions)||void 0===l||null===(c=l.utm)||void 0===c||!c.utm_campaign||(null===(d=t.conditions)||void 0===d||null===(h=d.utm)||void 0===h?void 0:h.utm_campaign)==s.utm_campaign,J=null===(_=t.conditions)||void 0===_||null===(p=_.utm)||void 0===p||!p.utm_source||(null===(g=t.conditions)||void 0===g||null===(v=g.utm)||void 0===v?void 0:v.utm_source)==s.utm_source,es=null===(f=t.conditions)||void 0===f||null===(w=f.utm)||void 0===w||!w.utm_medium||(null===(S=t.conditions)||void 0===S||null===(k=S.utm)||void 0===k?void 0:k.utm_medium)==s.utm_medium,er=null===(E=t.conditions)||void 0===E||null===(x=E.utm)||void 0===x||!x.utm_term||(null===(B=t.conditions)||void 0===B||null===(H=B.utm)||void 0===H?void 0:H.utm_term)==s.utm_term;return U&&es&&er&&J}return!1}static logInfo(t){for(var s=arguments.length,a=Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];el.info("[WebExperiments] ".concat(t),a)}applyTransforms(t,s,a){this._is_bot()?mo.logInfo("Refusing to render web experiment since the viewer is a likely bot"):"control"!==s?a.forEach(a=>{if(a.selector){mo.logInfo("applying transform of variant ".concat(s," for experiment ").concat(t," "),a);var l,c=null===(l=document)||void 0===l?void 0:l.querySelectorAll(a.selector);null==c||c.forEach(t=>{a.html&&(t.innerHTML=a.html),a.css&&t.setAttribute("style",a.css)})}}):mo.logInfo("Control variants leave the page unmodified.")}_is_bot(){return g&&this.instance?_o(g,this.instance.config.custom_blocked_useragents):void 0}};var sM={},bo=()=>{},sA="posthog",sL=!sf&&-1===(null==E?void 0:E.indexOf("MSIE"))&&-1===(null==E?void 0:E.indexOf("Mozilla")),ko=()=>{var t;return{api_host:"https://us.i.posthog.com",ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:function(t){var s=null==t?void 0:t.hostname;if(!R(s))return!1;var a=s.split(".").slice(-2).join(".");for(var l of eh)if(a===l)return!1;return!0}(null==v?void 0:v.location),persistence:"localStorage+cookie",persistence_name:"",loaded:bo,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageview:!0,capture_pageleave:"if_capture_pageview",debug:f&&R(null==f?void 0:f.search)&&-1!==f.search.indexOf("__posthog_debug=true")||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:"https:"===(null==c||null===(t=c.location)||void 0===t?void 0:t.protocol),ip:!0,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,session_recording:{},mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:t=>{var s="Bad HTTP status: "+t.statusCode+" "+t.text;el.error(s)},get_device_id:t=>t,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:3e3},_onCapture:bo}},Eo=t=>{var s={};F(t.process_person)||(s.person_profiles=t.process_person),F(t.xhr_headers)||(s.request_headers=t.xhr_headers),F(t.cookie_name)||(s.persistence_name=t.cookie_name),F(t.disable_cookie)||(s.disable_persistence=t.disable_cookie),F(t.store_google)||(s.save_campaign_params=t.store_google),F(t.verbose)||(s.debug=t.verbose);var a=X({},s,t);return ea(t.property_blacklist)&&(F(t.property_denylist)?a.property_denylist=t.property_blacklist:ea(t.property_denylist)?a.property_denylist=[...t.property_blacklist,...t.property_denylist]:el.error("Invalid value for property_denylist config: "+t.property_denylist)),a};let xo=class xo{constructor(){V(this,"__forceAllowLocalhost",!1)}get _forceAllowLocalhost(){return this.__forceAllowLocalhost}set _forceAllowLocalhost(t){el.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=t}};let Io=class Io{get decideEndpointWasHit(){var t,s;return null!==(t=null===(s=this.featureFlags)||void 0===s?void 0:s.hasLoadedFlags)&&void 0!==t&&t}constructor(){V(this,"webPerformance",new xo),V(this,"_personProcessingSetOncePropertiesSent",!1),V(this,"version",B.LIB_VERSION),V(this,"_internalEventEmitter",new On),this.config=ko(),this.SentryIntegration=br,this.sentryIntegration=t=>{var s;return s=yr(this,t),{name:tG,processEvent:t=>s(t)}},this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this._initialPageviewCaptured=!1,this._initialPersonProfilesConfig=null,this._cachedIdentify=null,this.featureFlags=new zr(this),this.toolbar=new xr(this),this.scrollManager=new to(this),this.pageViewManager=new Mr(this),this.surveys=new Nn(this),this.experiments=new mo(this),this.exceptions=new Ar(this),this.rateLimiter=new Hn(this),this.requestRouter=new vo(this),this.consent=new ei(this),this.people={set:(t,s,a)=>{var l=R(t)?{[t]:s}:t;this.setPersonProperties(l),null==a||a({})},set_once:(t,s,a)=>{var l=R(t)?{[t]:s}:t;this.setPersonProperties(void 0,l),null==a||a({})}},this.on("eventCaptured",t=>el.info('send "'.concat(null==t?void 0:t.event,'"'),t))}init(t,s,a){if(a&&a!==sA){var l,c=null!==(l=sM[a])&&void 0!==l?l:new Io;return c._init(t,s,a),sM[a]=c,sM[sA][a]=c,c}return this._init(t,s,a)}_init(t){var s,a,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},h=arguments.length>2?arguments[2]:void 0;if(F(t)||T(t))return el.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return el.warn("You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},this._triggered_notifs=[],d.person_profiles&&(this._initialPersonProfilesConfig=d.person_profiles),this.set_config(X({},ko(),Eo(d),{name:h,token:t})),this.config.on_xhr_error&&el.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=d.disable_compression?void 0:l.GZipJS,this.persistence=new Ws(this.config),this.sessionPersistence="sessionStorage"===this.config.persistence||"memory"===this.config.persistence?this.persistence:new Ws(W(W({},this.config),{},{persistence:"sessionStorage"}));var _=W({},this.persistence.props),p=W({},this.sessionPersistence.props);if(this._requestQueue=new Qn(t=>this._send_retriable_request(t),this.config.request_queue_config),this._retryQueue=new eo(this),this.__request_queue=[],this.config.__preview_experimental_cookieless_mode||(this.sessionManager=new no(this),this.sessionPropsManager=new ro(this,this.sessionManager,this.persistence)),new Pr(this).startIfEnabledOrStop(),this.siteApps=new lo(this),null===(s=this.siteApps)||void 0===s||s.init(),this.config.__preview_experimental_cookieless_mode||(this.sessionRecording=new gr(this),this.sessionRecording.startIfEnabledOrStop()),this.config.disable_scroll_properties||this.scrollManager.startMeasuringScrollPosition(),this.autocapture=new Tt(this),this.autocapture.startIfEnabled(),this.surveys.loadIfEnabled(),this.heatmaps=new Or(this),this.heatmaps.startIfEnabled(),this.webVitalsAutocapture=new Rr(this),this.exceptionObserver=new oi(this),this.exceptionObserver.startIfEnabled(),this.deadClicksAutocapture=new si(this,ri),this.deadClicksAutocapture.startIfEnabled(),B.DEBUG=B.DEBUG||this.config.debug,B.DEBUG&&el.info("Starting in debug mode",{this:this,config:d,thisC:W({},this.config),p:_,s:p}),this._sync_opt_out_with_persistence(),void 0!==(null===(a=d.bootstrap)||void 0===a?void 0:a.distinctID)){var g,v,f=this.config.get_device_id(qt()),w=null!==(g=d.bootstrap)&&void 0!==g&&g.isIdentifiedID?f:d.bootstrap.distinctID;this.persistence.set_property(eN,null!==(v=d.bootstrap)&&void 0!==v&&v.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:d.bootstrap.distinctID,$device_id:w})}if(this._hasBootstrappedFeatureFlags()){var S,k,E=Object.keys((null===(S=d.bootstrap)||void 0===S?void 0:S.featureFlags)||{}).filter(t=>{var s,a;return!(null===(s=d.bootstrap)||void 0===s||null===(a=s.featureFlags)||void 0===a||!a[t])}).reduce((t,s)=>{var a,l;return t[s]=(null===(a=d.bootstrap)||void 0===a||null===(l=a.featureFlags)||void 0===l?void 0:l[s])||!1,t},{}),x=Object.keys((null===(k=d.bootstrap)||void 0===k?void 0:k.featureFlagPayloads)||{}).filter(t=>E[t]).reduce((t,s)=>{var a,l,c,h;return null!==(a=d.bootstrap)&&void 0!==a&&null!==(l=a.featureFlagPayloads)&&void 0!==l&&l[s]&&(t[s]=null===(c=d.bootstrap)||void 0===c||null===(h=c.featureFlagPayloads)||void 0===h?void 0:h[s]),t},{});this.featureFlags.receivedFeatureFlags({featureFlags:E,featureFlagPayloads:x})}if(this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:eK,$device_id:null},"");else if(!this.get_distinct_id()){var H=this.config.get_device_id(qt());this.register_once({distinct_id:H,$device_id:H},""),this.persistence.set_property(eN,"anonymous")}return ae(c,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),d.segment?function(t,s){var a=t.config.segment;if(!a)return s();!function(t,s){var a=t.config.segment;if(!a)return s();var r=a=>{var r=()=>a.anonymousId()||qt();t.config.get_device_id=r,a.id()&&(t.register({distinct_id:a.id(),$device_id:r()}),t.persistence.set_property(eN,"identified")),s()},l=a.user();"then"in l&&I(l.then)?l.then(t=>r(t)):r(l)}(t,()=>{var l;a.register((Promise&&Promise.resolve||tj.warn("This browser does not have Promise support, and can not use the segment integration"),l=(s,a)=>{if(!a)return s;s.event.userId||s.event.anonymousId===t.get_distinct_id()||(tj.info("No userId set, resetting PostHog"),t.reset()),s.event.userId&&s.event.userId!==t.get_distinct_id()&&(tj.info("UserId set, identifying with PostHog"),t.identify(s.event.userId));var l,c=t._calculate_event_properties(a,null!==(l=s.event.properties)&&void 0!==l?l:{},new Date);return s.event.properties=Object.assign({},c,s.event.properties),s},{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:t=>l(t,t.event.event),page:t=>l(t,"$pageview"),identify:t=>l(t,"$identify"),screen:t=>l(t,"$screen")})).then(()=>{s()})})}(this,()=>this._loaded()):this._loaded(),I(this.config._onCapture)&&this.config._onCapture!==bo&&(el.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",t=>this.config._onCapture(t.event,t))),this}_onRemoteConfig(t){var s,a,c,d,h,_,p,g;if(!v||!v.body)return el.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout(()=>{this._onRemoteConfig(t)},500);this.compression=void 0,t.supportedCompression&&!this.config.disable_compression&&(this.compression=m(t.supportedCompression,l.GZipJS)?l.GZipJS:m(t.supportedCompression,l.Base64)?l.Base64:void 0),null!==(s=t.analytics)&&void 0!==s&&s.endpoint&&(this.analyticsDefaultEndpoint=t.analytics.endpoint),this.set_config({person_profiles:this._initialPersonProfilesConfig?this._initialPersonProfilesConfig:"identified_only"}),null===(a=this.siteApps)||void 0===a||a.onRemoteConfig(t),null===(c=this.sessionRecording)||void 0===c||c.onRemoteConfig(t),null===(d=this.autocapture)||void 0===d||d.onRemoteConfig(t),null===(h=this.heatmaps)||void 0===h||h.onRemoteConfig(t),this.surveys.onRemoteConfig(t),null===(_=this.webVitalsAutocapture)||void 0===_||_.onRemoteConfig(t),null===(p=this.exceptionObserver)||void 0===p||p.onRemoteConfig(t),null===(g=this.deadClicksAutocapture)||void 0===g||g.onRemoteConfig(t)}_loaded(){try{this.config.loaded(this)}catch(t){el.critical("`loaded` function failed",t)}this._start_queue_if_opted_in(),this.config.capture_pageview&&setTimeout(()=>{this.consent.isOptedIn()&&this._captureInitialPageview()},1),new zn(this).load(),this.featureFlags.decide()}_start_queue_if_opted_in(){var t;this.has_opted_out_capturing()||this.config.request_batching&&(null===(t=this._requestQueue)||void 0===t||t.enable())}_dom_loaded(){this.has_opted_out_capturing()||Y(this.__request_queue,t=>this._send_retriable_request(t)),this.__request_queue=[],this._start_queue_if_opted_in()}_handle_unload(){var t,s;this.config.request_batching?(this._shouldCapturePageleave()&&this.capture("$pageleave"),null===(t=this._requestQueue)||void 0===t||t.unload(),null===(s=this._retryQueue)||void 0===s||s.unload()):this._shouldCapturePageleave()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}_send_request(t){this.__loaded&&(sL?this.__request_queue.push(t):this.rateLimiter.isServerRateLimited(t.batchKey)||(t.transport=t.transport||this.config.api_transport,t.url=Gn(t.url,{ip:this.config.ip?1:0}),t.headers=W({},this.config.request_headers),t.compression="best-available"===t.compression?this.compression:t.compression,t.fetchOptions=t.fetchOptions||this.config.fetch_options,(t=>{var s,a,l,c=W({},t);c.timeout=c.timeout||6e4,c.url=Gn(c.url,{_:(new Date).getTime().toString(),ver:B.LIB_VERSION,compression:c.compression});var d=null!==(s=c.transport)&&void 0!==s?s:"fetch",h=null!==(a=null===(l=oe(sy,t=>t.transport===d))||void 0===l?void 0:l.method)&&void 0!==a?a:sy[0].method;if(!h)throw Error("No available transport method");h(c)})(W(W({},t),{},{callback:s=>{var a,l,c;this.rateLimiter.checkForLimiting(s),s.statusCode>=400&&(null===(l=(c=this.config).on_request_error)||void 0===l||l.call(c,s)),null===(a=t.callback)||void 0===a||a.call(t,s)}}))))}_send_retriable_request(t){this._retryQueue?this._retryQueue.retriableRequest(t):this._send_request(t)}_execute_array(t){var s,a=[],l=[],c=[];Y(t,t=>{t&&(ea(s=t[0])?c.push(t):I(t)?t.call(this):ea(t)&&"alias"===s?a.push(t):ea(t)&&-1!==s.indexOf("capture")&&I(this[s])?c.push(t):l.push(t))});var n=function(t,s){Y(t,function(t){if(ea(t[0])){var a=s;K(t,function(t){a=a[t[0]].apply(a,t.slice(1))})}else this[t[0]].apply(this,t.slice(1))},s)};n(a,this),n(l,this),n(c,this)}_hasBootstrappedFeatureFlags(){var t,s;return(null===(t=this.config.bootstrap)||void 0===t?void 0:t.featureFlags)&&Object.keys(null===(s=this.config.bootstrap)||void 0===s?void 0:s.featureFlags).length>0||!1}push(t){this._execute_array([t])}capture(t,s,a){var l;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this._requestQueue){if(!this.consent.isOptedOut()){if(!F(t)&&R(t)){if(this.config.opt_out_useragent_filter||!this._is_bot()){var c=null!=a&&a.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(null==c||!c.isRateLimited){this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var d,h,_,p,g=new Date,v=(null==a?void 0:a.timestamp)||g,f=qt(),w={uuid:f,event:t,properties:this._calculate_event_properties(t,s||{},v,f)};c&&(w.properties.$lib_rate_limit_remaining_tokens=c.remainingTokens),(null==a?void 0:a.$set)&&(w.$set=null==a?void 0:a.$set);var S=this._calculate_set_once_properties(null==a?void 0:a.$set_once);S&&(w.$set_once=S),(d=w,h=null!=a&&a._noTruncate?null:this.config.properties_string_max_length,_=t=>R(t)&&!$(h)?t.slice(0,h):t,p=new Set,w=function e(t,s){var a;return t!==Object(t)?_?_(t,s):t:p.has(t)?void 0:(p.add(t),ea(t)?(a=[],Y(t,t=>{a.push(e(t))})):(a={},K(t,(t,s)=>{p.has(t)||(a[s]=e(t,s))})),a)}(d)).timestamp=v,F(null==a?void 0:a.timestamp)||(w.properties.$event_time_override_provided=!0,w.properties.$event_time_override_system_time=g);var k=W(W({},w.properties.$set),w.$set);if(C(k)||this.setPersonPropertiesForFlags(k),!O(this.config.before_send)){var E=this._runBeforeSend(w);if(!E)return;w=E}this._internalEventEmitter.emit("eventCaptured",w);var x={method:"POST",url:null!==(l=null==a?void 0:a._url)&&void 0!==l?l:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:w,compression:"best-available",batchKey:null==a?void 0:a._batchKey};return!this.config.request_batching||a&&(null==a||!a._batchKey)||null!=a&&a.send_instantly?this._send_retriable_request(x):this._requestQueue.enqueue(x),w}el.critical("This capture call is ignored due to client rate limiting.")}}else el.error("No event name provided to posthog.capture")}}else el.uninitializedWarning("posthog.capture")}_addCaptureHook(t){return this.on("eventCaptured",s=>t(s.event,s))}_calculate_event_properties(t,s,a,l){if(a=a||new Date,!this.persistence||!this.sessionPersistence)return s;var c,d,h=this.persistence.remove_event_timer(t),_=W({},s);if(_.token=this.config.token,this.config.__preview_experimental_cookieless_mode&&(_.$cookieless_mode=!0),"$snapshot"===t){var p=W(W({},this.persistence.properties()),this.sessionPersistence.properties());return _.distinct_id=p.distinct_id,(!R(_.distinct_id)&&!M(_.distinct_id)||T(_.distinct_id))&&el.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),_}var g,f=i2.properties({maskPersonalDataProperties:this.config.mask_personal_data_properties,customPersonalDataProperties:this.config.custom_personal_data_properties});if(this.sessionManager){var{sessionId:w,windowId:S}=this.sessionManager.checkAndGetSessionAndWindowId();_.$session_id=w,_.$window_id=S}try{this.sessionRecording&&(_.$recording_status=this.sessionRecording.status,_.$sdk_debug_replay_internal_buffer_length=this.sessionRecording.buffer.data.length,_.$sdk_debug_replay_internal_buffer_size=this.sessionRecording.buffer.size),_.$sdk_debug_retry_queue_size=null===(c=this._retryQueue)||void 0===c||null===(d=c.queue)||void 0===d?void 0:d.length}catch(t){_.$sdk_debug_error_capturing_properties=String(t)}if(this.requestRouter.region===sR.CUSTOM&&(_.$lib_custom_api_host=this.config.api_host),g="$pageview"===t?this.pageViewManager.doPageView(a,l):"$pageleave"===t?this.pageViewManager.doPageLeave(a):this.pageViewManager.doEvent(),_=X(_,g),"$pageview"===t&&v&&(_.title=v.title),!F(h)){var k=a.getTime()-h;_.$duration=parseFloat((k/1e3).toFixed(3))}E&&this.config.opt_out_useragent_filter&&(_.$browser_type=this._is_bot()?"bot":"browser"),(_=X({},f,this.persistence.properties(),this.sessionPersistence.properties(),_)).$is_identified=this._isIdentified(),ea(this.config.property_denylist)?K(this.config.property_denylist,function(t){delete _[t]}):el.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var x=this.config.sanitize_properties;x&&(el.error("sanitize_properties is deprecated. Use before_send instead"),_=x(_,t));var B=this._hasPersonProcessing();return _.$process_person_profile=B,B&&this._requirePersonProcessing("_calculate_event_properties"),_}_calculate_set_once_properties(t){if(!this.persistence||!this._hasPersonProcessing()||this._personProcessingSetOncePropertiesSent)return t;var s,a=X({},this.persistence.get_initial_props(),(null===(s=this.sessionPropsManager)||void 0===s?void 0:s.getSetOnceInitialSessionPropsProps())||{},t||{}),l=this.config.sanitize_properties;return l&&(el.error("sanitize_properties is deprecated. Use before_send instead"),a=l(a,"$set_once")),this._personProcessingSetOncePropertiesSent=!0,C(a)?void 0:a}register(t,s){var a;null===(a=this.persistence)||void 0===a||a.register(t,s)}register_once(t,s,a){var l;null===(l=this.persistence)||void 0===l||l.register_once(t,s,a)}register_for_session(t){var s;null===(s=this.sessionPersistence)||void 0===s||s.register(t)}unregister(t){var s;null===(s=this.persistence)||void 0===s||s.unregister(t)}unregister_for_session(t){var s;null===(s=this.sessionPersistence)||void 0===s||s.unregister(t)}_register_single(t,s){this.register({[t]:s})}getFeatureFlag(t,s){return this.featureFlags.getFeatureFlag(t,s)}getFeatureFlagPayload(t){var s=this.featureFlags.getFeatureFlagPayload(t);try{return JSON.parse(s)}catch(t){return s}}isFeatureEnabled(t,s){return this.featureFlags.isFeatureEnabled(t,s)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateEarlyAccessFeatureEnrollment(t,s){this.featureFlags.updateEarlyAccessFeatureEnrollment(t,s)}getEarlyAccessFeatures(t){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.featureFlags.getEarlyAccessFeatures(t,s)}on(t,s){return this._internalEventEmitter.on(t,s)}onFeatureFlags(t){return this.featureFlags.onFeatureFlags(t)}onSessionId(t){var s,a;return null!==(s=null===(a=this.sessionManager)||void 0===a?void 0:a.onSessionId(t))&&void 0!==s?s:()=>{}}getSurveys(t){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.surveys.getSurveys(t,s)}getActiveMatchingSurveys(t){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.surveys.getActiveMatchingSurveys(t,s)}renderSurvey(t,s){this.surveys.renderSurvey(t,s)}canRenderSurvey(t){this.surveys.canRenderSurvey(t)}identify(t,s,a){if(!this.__loaded||!this.persistence)return el.uninitializedWarning("posthog.identify");if(M(t)&&(t=t.toString(),el.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),t){if(["distinct_id","distinctid"].includes(t.toLowerCase()))el.critical('The string "'.concat(t,'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.'));else if(this._requirePersonProcessing("posthog.identify")){var l=this.get_distinct_id();this.register({$user_id:t}),this.get_property("$device_id")||this.register_once({$had_persisted_distinct_id:!0,$device_id:l},""),t!==l&&t!==this.get_property(ep)&&(this.unregister(ep),this.register({distinct_id:t}));var c="anonymous"===(this.persistence.get_property(eN)||"anonymous");t!==l&&c?(this.persistence.set_property(eN,"identified"),this.setPersonPropertiesForFlags(W(W({},a||{}),s||{}),!1),this.capture("$identify",{distinct_id:t,$anon_distinct_id:l},{$set:s||{},$set_once:a||{}}),this.featureFlags.setAnonymousDistinctId(l),this._cachedIdentify=po(t,s,a)):(s||a)&&(this._cachedIdentify!==po(t,s,a)?(this.setPersonProperties(s,a),this._cachedIdentify=po(t,s,a)):el.info("A duplicate posthog.identify call was made with the same properties. It has been ignored.")),t!==l&&(this.reloadFeatureFlags(),this.unregister(eW))}}else el.error("Unique user id has not been set in posthog.identify")}setPersonProperties(t,s){(t||s)&&this._requirePersonProcessing("posthog.setPersonProperties")&&(this.setPersonPropertiesForFlags(W(W({},s||{}),t||{})),this.capture("$set",{$set:t||{},$set_once:s||{}}))}group(t,s,a){if(t&&s){if(this._requirePersonProcessing("posthog.group")){var l=this.getGroups();l[t]!==s&&this.resetGroupPropertiesForFlags(t),this.register({$groups:W(W({},l),{},{[t]:s})}),a&&(this.capture("$groupidentify",{$group_type:t,$group_key:s,$group_set:a}),this.setGroupPropertiesForFlags({[t]:a})),l[t]===s||a||this.reloadFeatureFlags()}}else el.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(t){var s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.featureFlags.setPersonPropertiesForFlags(t,s)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(t){var s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._requirePersonProcessing("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(t,s)}resetGroupPropertiesForFlags(t){this.featureFlags.resetGroupPropertiesForFlags(t)}reset(t){if(el.info("reset"),!this.__loaded)return el.uninitializedWarning("posthog.reset");var s,a,l,c,d=this.get_property("$device_id");if(this.consent.reset(),null===(s=this.persistence)||void 0===s||s.clear(),null===(a=this.sessionPersistence)||void 0===a||a.clear(),this.surveys.reset(),null===(l=this.persistence)||void 0===l||l.set_property(eN,"anonymous"),null===(c=this.sessionManager)||void 0===c||c.resetSessionId(),this._cachedIdentify=null,this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:eK,$device_id:null},"");else{var h=this.config.get_device_id(qt());this.register_once({distinct_id:h,$device_id:t?h:d},"")}this.register({$last_posthog_reset:(new Date).toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var t,s;return null!==(t=null===(s=this.sessionManager)||void 0===s?void 0:s.checkAndGetSessionAndWindowId(!0).sessionId)&&void 0!==t?t:""}get_session_replay_url(t){if(!this.sessionManager)return"";var{sessionId:s,sessionStartTimestamp:a}=this.sessionManager.checkAndGetSessionAndWindowId(!0),l=this.requestRouter.endpointFor("ui","/project/".concat(this.config.token,"/replay/").concat(s));if(null!=t&&t.withTimestamp&&a){var c,d=null!==(c=t.timestampLookBack)&&void 0!==c?c:10;if(!a)return l;var h=Math.max(Math.floor(((new Date).getTime()-a)/1e3)-d,0);l+="?t=".concat(h)}return l}alias(t,s){return t===this.get_property(e_)?(el.critical("Attempting to create alias for existing People user - aborting."),-2):this._requirePersonProcessing("posthog.alias")?(F(s)&&(s=this.get_distinct_id()),t!==s?(this._register_single(ep,t),this.capture("$create_alias",{alias:t,distinct_id:s})):(el.warn("alias matches current distinct_id - skipping api call."),this.identify(t),-1)):void 0}set_config(t){var s,a,l,c,d=W({},this.config);P(t)&&(X(this.config,Eo(t)),null===(s=this.persistence)||void 0===s||s.update_config(this.config,d),this.sessionPersistence="sessionStorage"===this.config.persistence||"memory"===this.config.persistence?this.persistence:new Ws(W(W({},this.config),{},{persistence:"sessionStorage"})),ta.is_supported()&&"true"===ta.get("ph_debug")&&(this.config.debug=!0),this.config.debug&&(B.DEBUG=!0,el.info("set_config",{config:t,oldConfig:d,newConfig:W({},this.config)})),null===(a=this.sessionRecording)||void 0===a||a.startIfEnabledOrStop(),null===(l=this.autocapture)||void 0===l||l.startIfEnabled(),null===(c=this.heatmaps)||void 0===c||c.startIfEnabled(),this.surveys.loadIfEnabled(),this._sync_opt_out_with_persistence())}startSessionRecording(t){var s,a,l,c,d,h=!0===t,_={sampling:h||!(null==t||!t.sampling),linked_flag:h||!(null==t||!t.linked_flag),url_trigger:h||!(null==t||!t.url_trigger),event_trigger:h||!(null==t||!t.event_trigger)};Object.values(_).some(Boolean)&&(null===(s=this.sessionManager)||void 0===s||s.checkAndGetSessionAndWindowId(),_.sampling&&(null===(a=this.sessionRecording)||void 0===a||a.overrideSampling()),_.linked_flag&&(null===(l=this.sessionRecording)||void 0===l||l.overrideLinkedFlag()),_.url_trigger&&(null===(c=this.sessionRecording)||void 0===c||c.overrideTrigger("url")),_.event_trigger&&(null===(d=this.sessionRecording)||void 0===d||d.overrideTrigger("event"))),this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var t;return!(null===(t=this.sessionRecording)||void 0===t||!t.started)}captureException(t,s){var a,l=Error("PostHog syntheticException"),c=I(null===(a=x.__PosthogExtensions__)||void 0===a?void 0:a.parseErrorAsProperties)?W(W({},x.__PosthogExtensions__.parseErrorAsProperties(D(t)?{error:t,event:t.message}:{event:t},{syntheticException:l})),s):W({$exception_level:"error",$exception_list:[{type:D(t)?t.name:"Error",value:D(t)?t.message:t,mechanism:{handled:!0,synthetic:!1}}]},s);this.exceptions.sendExceptionEvent(c)}loadToolbar(t){return this.toolbar.loadToolbar(t)}get_property(t){var s;return null===(s=this.persistence)||void 0===s?void 0:s.props[t]}getSessionProperty(t){var s;return null===(s=this.sessionPersistence)||void 0===s?void 0:s.props[t]}toString(){var t,s=null!==(t=this.config.name)&&void 0!==t?t:sA;return s!==sA&&(s=sA+"."+s),s}_isIdentified(){var t,s;return"identified"===(null===(t=this.persistence)||void 0===t?void 0:t.get_property(eN))||"identified"===(null===(s=this.sessionPersistence)||void 0===s?void 0:s.get_property(eN))}_hasPersonProcessing(){var t,s,a,l;return!("never"===this.config.person_profiles||"identified_only"===this.config.person_profiles&&!this._isIdentified()&&C(this.getGroups())&&(null===(t=this.persistence)||void 0===t||null===(s=t.props)||void 0===s||!s[ep])&&(null===(a=this.persistence)||void 0===a||null===(l=a.props)||void 0===l||!l[ej]))}_shouldCapturePageleave(){return!0===this.config.capture_pageleave||"if_capture_pageview"===this.config.capture_pageleave&&this.config.capture_pageview}createPersonProfile(){this._hasPersonProcessing()||this._requirePersonProcessing("posthog.createPersonProfile")&&this.setPersonProperties({},{})}_requirePersonProcessing(t){return"never"===this.config.person_profiles?(el.error(t+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this._register_single(ej,!0),!0)}_sync_opt_out_with_persistence(){var t,s,a,l,c=this.consent.isOptedOut(),d=this.config.opt_out_persistence_by_default,h=this.config.disable_persistence||c&&!!d;(null===(t=this.persistence)||void 0===t?void 0:t.disabled)!==h&&(null===(a=this.persistence)||void 0===a||a.set_disabled(h)),(null===(s=this.sessionPersistence)||void 0===s?void 0:s.disabled)!==h&&(null===(l=this.sessionPersistence)||void 0===l||l.set_disabled(h))}opt_in_capturing(t){var s;this.consent.optInOut(!0),this._sync_opt_out_with_persistence(),(F(null==t?void 0:t.captureEventName)||null!=t&&t.captureEventName)&&this.capture(null!==(s=null==t?void 0:t.captureEventName)&&void 0!==s?s:"$opt_in",null==t?void 0:t.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this._captureInitialPageview()}opt_out_capturing(){this.consent.optInOut(!1),this._sync_opt_out_with_persistence()}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}clear_opt_in_out_capturing(){this.consent.reset(),this._sync_opt_out_with_persistence()}_is_bot(){return g?_o(g,this.config.custom_blocked_useragents):void 0}_captureInitialPageview(){v&&!this._initialPageviewCaptured&&(this._initialPageviewCaptured=!0,this.capture("$pageview",{title:v.title},{send_instantly:!0}))}debug(t){!1===t?(null==c||c.console.log("You've disabled debug mode."),localStorage&&localStorage.removeItem("ph_debug"),this.set_config({debug:!1})):(null==c||c.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),localStorage&&localStorage.setItem("ph_debug","true"),this.set_config({debug:!0}))}_runBeforeSend(t){if(O(this.config.before_send))return t;var s=ea(this.config.before_send)?this.config.before_send:[this.config.before_send],a=t;for(var l of s){if(O(a=l(a))){var c="Event '".concat(t.event,"' was rejected in beforeSend function");return q(t.event)?el.warn("".concat(c,". This can cause unexpected behavior.")):el.info(c),null}a.properties&&!C(a.properties)||el.warn("Event '".concat(t.event,"' has no properties after beforeSend function, this is likely an error."))}return a}getPageViewId(){var t;return null===(t=this.pageViewManager._currentPageview)||void 0===t?void 0:t.pageViewId}captureTraceFeedback(t,s){this.capture("$ai_feedback",{$ai_trace_id:String(t),$ai_feedback_text:s})}captureTraceMetric(t,s,a){this.capture("$ai_metric",{$ai_trace_id:String(t),$ai_metric_name:s,$ai_metric_value:String(a)})}};!function(t,s){for(var a=0;a<s.length;a++)t.prototype[s[a]]=te(t.prototype[s[a]])}(Io,["identify"]);var sD,sq,sW=(sq=sM[sA]=new Io,function(){function e(){e.done||(e.done=!0,sL=!1,K(sM,function(t){t._dom_loaded()}))}null!=v&&v.addEventListener?"complete"===v.readyState?e():ae(v,"DOMContentLoaded",e,{capture:!1}):c&&el.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")}(),sq)}}]);