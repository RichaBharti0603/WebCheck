"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6171],{26171:function(e,t,r){r.d(t,{ZP:function(){return Contexts_AuthProvider},aC:function(){return useAuth}});var n=r(45610),o=r(41369),i=r(9),a=r(50044),u=r(57437),l=r(2265),c=r(74109),s=r(79582),d=r(60453),getCookie=function(e){var t=document.cookie.match(RegExp("(^| )"+e+"=([^;]+)"));return t?t[2]:null},getGclAwValue=function(){var checkForCookie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=getCookie("_gcl_aw");if(r){var n=r.split(".").slice(2).join(".");return n&&localStorage.setItem("gclAw",n),!0}return e<t&&setTimeout(function(){return checkForCookie(e+1)},2e3),!1};checkForCookie()},getReferringUrl=function(){var e=window.location.href;return e.includes("?")?e:document.referrer||e},getFbclidValue=function(){var checkForCookie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=getCookie("_fbc");return r?(localStorage.setItem("fbc",r),!0):(e<t&&setTimeout(function(){return checkForCookie(e+1)},2e3),!1)};checkForCookie()},getFbpValue=function(){var checkForCookie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=getCookie("_fbp");return r?(localStorage.setItem("fbp",r),!0):(e<t&&setTimeout(function(){return checkForCookie(e+1)},2e3),!1)};checkForCookie()},useTrackingData=function(){var e=(0,i._)((0,l.useState)({referringUrl:null,gclAw:null,ga4ClientId:null,fbc:null,fbp:null}),2),t=e[0],r=e[1];return(0,l.useEffect)(function(){if(localStorage.getItem("referringUrl")||localStorage.setItem("referringUrl",getReferringUrl()),localStorage.getItem("gclAw")||getGclAwValue(),localStorage.getItem("fbc")||getFbclidValue(),localStorage.getItem("fbp")||getFbpValue(),!localStorage.getItem("ga4ClientId")){var e;(e=(0,n._)(function(){var e;return(0,a.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,new Promise(function(e,t){window.gtag?window.gtag("get","G-9L2Y115NQ3","client_id",function(t){e(t)}):t("gtag not available")})];case 1:return(e=t.sent())&&localStorage.setItem("ga4ClientId",e),[3,3];case 2:return console.error("Error getting GA4 Client ID:",t.sent()),[3,3];case 3:return[2]}})}),function(){return e.apply(this,arguments)})()}r({referringUrl:localStorage.getItem("referringUrl"),gclAw:localStorage.getItem("gclAw"),ga4ClientId:localStorage.getItem("ga4ClientId"),fbc:localStorage.getItem("fbc"),fbp:localStorage.getItem("fbp")})},[]),t},g=r(58066),f=(0,l.createContext)(),useAuth=function(){return(0,l.useContext)(f)},Contexts_AuthProvider=function(e){var t,r,h,p,v,I=e.children,w=(0,i._)((0,l.useState)(null),2),m=w[0],b=w[1],k=(0,i._)((0,l.useState)(null),2),_=k[0],S=k[1],C=(0,i._)((0,l.useState)(!0),2),U=C[0],D=C[1],y=(0,i._)((0,l.useState)(null),2),E=y[0],A=y[1];function userInfoData(){return _userInfoData.apply(this,arguments)}function _userInfoData(){return(_userInfoData=(0,n._)(function(){var e;return(0,a.Jh)(this,function(t){switch(t.label){case 0:if(null==_)return[2];return[4,(0,s.b)({uid:_,endpoint:"get-user-data"})];case 1:return A(null==(e=t.sent())?void 0:e.data),[2]}})})).apply(this,arguments)}useTrackingData(),(0,d.ZP)("userInfoData",userInfoData),(0,l.useEffect)(function(){null!=_&&userInfoData()},[_]),(0,l.useEffect)(function(){var e,t=c.I8.onAuthStateChanged((e=(0,n._)(function(e){var t,r,n,o;return(0,a.Jh)(this,function(i){switch(i.label){case 0:if(!(null==e?void 0:e.emailVerified))return[3,6];if(b(e),!(e&&e.providerData&&e.providerData.length>0))return[3,5];if(t=e.uid,r=null,(n=e.providerData.find(function(e){return"google.com"===e.providerId}))&&(r=n.uid),o=null,!r)return[3,2];return[4,(0,s.b)({uid:r,endpoint:"get-user-data"})];case 1:(null==(o=i.sent())?void 0:o.data)&&(t=r),i.label=2;case 2:if(null==o?void 0:o.data)return[3,4];return[4,(0,s.b)({uid:t,endpoint:"get-user-data"})];case 3:o=i.sent(),i.label=4;case 4:(null==o?void 0:o.data)&&(S(t),localStorage.setItem("UxpUserID",t),g.ZP.identify(t,{distinct_id:t,email:e.email,name:e.displayName,provider:n?"google":"email",emailVerified:e.emailVerified})),i.label=5;case 5:return[3,7];case 6:g.ZP.reset(),i.label=7;case 7:return D(!1),[2]}})}),function(t){return e.apply(this,arguments)}));return function(){t()}},[]);var F=(t=(0,n._)(function(){var e;return(0,a.Jh)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,c.qj)()];case 1:if(e=t.sent()){A(e),S(e.uid),localStorage.setItem("UxpUserID",e.uid);try{trackSignUp(e.uid,"google",e.email)}catch(e){console.error("Error tracking sign in with google:",e)}}else throw Error("No user found");return[2,e];case 2:throw Error(t.sent());case 3:return[2]}})}),function(){return t.apply(this,arguments)}),x=(r=(0,n._)(function(e){var t,r;return(0,a.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,c.Gn)(e)];case 1:if(!(t=n.sent()))throw Error("No user found");return A(t),S(t.uid),localStorage.setItem("UxpUserID",t.uid),trackSignUp(t.uid,"google_one_tap",t.email),[2,t];case 2:throw console.error("Google One Tap sign in failed:",r=n.sent()),Error(r);case 3:return[2]}})}),function(e){return r.apply(this,arguments)}),V=(h=(0,n._)(function(){var e,t;return(0,a.Jh)(this,function(r){switch(r.label){case 0:if(e=c.I8.currentUser,t=window.location.origin,!e)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.sendEmailVerification({url:"".concat(t,"/b"),handleCodeInApp:!0})];case 2:return r.sent(),[3,4];case 3:return console.error("Error sending verification email:",r.sent().message),[3,4];case 4:return[3,6];case 5:console.error("No user found. Please sign in or sign up first."),r.label=6;case 6:return[2]}})}),function(){return h.apply(this,arguments)}),P=(p=(0,n._)(function(e,t,r){var n;return(0,a.Jh)(this,function(o){switch(o.label){case 0:return[4,(0,c.rd)(e,t,r)];case 1:return n=o.sent(),b(null),V(),trackSignUp(n.uid,"email_password",e),[2,n]}})}),function(e,t,r){return p.apply(this,arguments)}),G=(v=(0,n._)(function(e,t){var r,n,i,u,l,d,g,f,h,p,v;return(0,a.Jh)(this,function(a){switch(a.label){case 0:return a.trys.push([0,6,,7]),[4,(0,c.w2)(e,t)];case 1:if(!(u=a.sent())||!u.uid)throw Error("Invalid sign-in data");if(l=u.uid,d=null,(null==u?void 0:null===(r=u.user)||void 0===r?void 0:r.providerData)&&(null==u?void 0:null===(i=u.user)||void 0===i?void 0:null===(n=i.providerData)||void 0===n?void 0:n.length)>0&&(h=null==u?void 0:null===(f=u.user)||void 0===f?void 0:null===(g=f.providerData)||void 0===g?void 0:g.find(function(e){return(null==e?void 0:e.providerId)==="google.com"}))&&(d=h.uid),p=null,!d)return[3,3];return[4,(0,s.b)({uid:d,endpoint:"get-user-data"})];case 2:(null==(p=a.sent())?void 0:p.data)&&(l=d),a.label=3;case 3:if(null==p?void 0:p.data)return[3,5];return[4,(0,s.b)({uid:l,endpoint:"get-user-data"})];case 4:p=a.sent(),a.label=5;case 5:if(!(null==p?void 0:p.data))throw Error("No user data found with either UID");return S(l),localStorage.setItem("UxpUserID",l),[2,(0,o._)({},u,p.data)];case 6:throw console.error("Sign-in failed:",v=a.sent()),v;case 7:return[2]}})}),function(e,t){return v.apply(this,arguments)}),trackSignUp=function(e,t,r){window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"c_sign_up",method:t,user_id:e,email:r}),window.lintrk("track",{conversion_id:20979041})};return(0,u.jsx)(f.Provider,{value:{currentUser:m,signInWithGoogle:F,authLoading:U,googleUID:_,signUp:P,signIn:G,userInfo:E,signInWithGoogleOneTap:x},children:I})}}}]);